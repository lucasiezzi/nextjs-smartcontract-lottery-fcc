"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[877],{54877:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{PhantomInjectedProvider:function(){return PhantomInjectedProvider},SlopeInjectedProxyProvider:function(){return SlopeInjectedProxyProvider},SolanaPrivateKeyProvider:function(){return SolanaPrivateKeyProvider},SolanaWallet:function(){return SolanaWallet},SolflareInjectedProvider:function(){return SolflareInjectedProvider},SolletInjectedProvider:function(){return SolletInjectedProvider},TorusInjectedProvider:function(){return TorusInjectedProvider}});var _ref2,_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(15671),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(43144),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(60136),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(82963),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(61120),_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(15861),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(4942),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(64687),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__),_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(22782),_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(64049),_web3auth_base__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(16843),_web3auth_base_provider__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(68531),bs58__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(77191),bs58__WEBPACK_IMPORTED_MODULE_5___default=__webpack_require__.n(bs58__WEBPACK_IMPORTED_MODULE_5__),eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(79826),_solana_web3_js__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(59917),_toruslabs_tweetnacl_js__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(50108),_toruslabs_tweetnacl_js__WEBPACK_IMPORTED_MODULE_8___default=__webpack_require__.n(_toruslabs_tweetnacl_js__WEBPACK_IMPORTED_MODULE_8__),Buffer=__webpack_require__(48764).Buffer;function createConfigMiddleware(providerConfig){var chainId=providerConfig.chainId;return(0,_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.UZ)([function(req,res,next,end){return"solana_chainId"===req.method?(res.result=chainId,end()):next()},function(req,res,next,end){return"solana_provider_config"===req.method?(res.result=providerConfig,end()):next()}])}function createGenericJRPCMiddleware(targetMethod,handler){var _ref5;return(0,_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.Pk)((_ref5=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee3(request,response,next){var result;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(!(request.method!==targetMethod)){_context3.next=3;break}return _context3.abrupt("return",next());case 3:if(handler){_context3.next=5;break}throw Error("WalletMiddleware - ".concat(targetMethod," not provided"));case 5:return _context3.next=7,handler(request);case 7:return result=_context3.sent,response.result=result,_context3.abrupt("return",void 0);case 10:case"end":return _context3.stop()}},_callee3)})),function(_x7,_x8,_x9){return _ref5.apply(this,arguments)}))}function createSolanaMiddleware(providerHandlers){var _ref4,_ref2,getAccounts=providerHandlers.getAccounts,requestAccounts=providerHandlers.requestAccounts,signTransaction=providerHandlers.signTransaction,signAndSendTransaction=providerHandlers.signAndSendTransaction,signAllTransactions=providerHandlers.signAllTransactions,signMessage=providerHandlers.signMessage,getPrivateKey=providerHandlers.getPrivateKey,getSecretKey=providerHandlers.getSecretKey;return(0,_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.UZ)([(0,_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.Pk)((_ref4=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee2(request,response,next){var accounts;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(!("requestAccounts"!==request.method)){_context2.next=3;break}return _context2.abrupt("return",next());case 3:if(requestAccounts){_context2.next=5;break}throw Error("WalletMiddleware - opts.requestAccounts not provided");case 5:return _context2.next=7,requestAccounts(request);case 7:return accounts=_context2.sent,response.result=accounts,_context2.abrupt("return",void 0);case 10:case"end":return _context2.stop()}},_callee2)})),function(_x4,_x5,_x6){return _ref4.apply(this,arguments)})),(0,_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.Pk)((_ref2=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee(request,response,next){var accounts;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!("getAccounts"!==request.method)){_context.next=3;break}return _context.abrupt("return",next());case 3:if(getAccounts){_context.next=5;break}throw Error("WalletMiddleware - opts.getAccounts not provided");case 5:return _context.next=7,getAccounts(request);case 7:return accounts=_context.sent,response.result=accounts,_context.abrupt("return",void 0);case 10:case"end":return _context.stop()}},_callee)})),function(_x,_x2,_x3){return _ref2.apply(this,arguments)})),createGenericJRPCMiddleware("signTransaction",signTransaction),createGenericJRPCMiddleware("signAndSendTransaction",signAndSendTransaction),createGenericJRPCMiddleware("signAllTransactions",signAllTransactions),createGenericJRPCMiddleware("signMessage",signMessage),createGenericJRPCMiddleware("solanaPrivateKey",getPrivateKey),createGenericJRPCMiddleware("solanaSecretKey",getSecretKey)])}function ownKeys$3(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _objectSpread$3(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys$3(Object(source),!0).forEach(function(key){(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_10__.Z)(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys$3(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}var BaseInjectedProvider=function(_BaseProvider){(0,_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_13__.Z)(BaseInjectedProvider,_BaseProvider);var hasNativeReflectConstruct,_switchChain,_setupProvider,_lookupNetwork,_super=(hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var result,Super=(0,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_11__.Z)(BaseInjectedProvider);if(hasNativeReflectConstruct){var NewTarget=(0,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_11__.Z)(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return(0,_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_12__.Z)(this,result)});function BaseInjectedProvider(_ref){var config=_ref.config,state=_ref.state;return(0,_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_14__.Z)(this,BaseInjectedProvider),_super.call(this,{config:{chainConfig:_objectSpread$3(_objectSpread$3({},config.chainConfig),{},{chainNamespace:_web3auth_base__WEBPACK_IMPORTED_MODULE_3__.EN.SOLANA})},state:state})}return(0,_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_15__.Z)(BaseInjectedProvider,[{key:"switchChain",value:(_switchChain=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee(_){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",Promise.resolve());case 1:case"end":return _context.stop()}},_callee)})),function(_x){return _switchChain.apply(this,arguments)})},{key:"setupProvider",value:(_setupProvider=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee2(injectedProvider){var engine,solanaMiddleware,configMiddleware,injectedProviderProxy,provider;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return engine=new _toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.eI,solanaMiddleware=createSolanaMiddleware(this.getProviderHandlers(injectedProvider)),engine.push(solanaMiddleware),configMiddleware=createConfigMiddleware(this.config.chainConfig),engine.push(configMiddleware),(injectedProviderProxy=this.getInjectedProviderProxy(injectedProvider))&&engine.push(injectedProviderProxy),provider=(0,_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_1__.Xj)(engine),this.updateProviderEngineProxy(provider),_context2.next=12,this.lookupNetwork();case 12:case"end":return _context2.stop()}},_callee2,this)})),function(_x2){return _setupProvider.apply(this,arguments)})},{key:"lookupNetwork",value:(_lookupNetwork=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee3(){var chainConfig;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return chainConfig=this.config.chainConfig,this.update({chainId:chainConfig.chainId}),_context3.abrupt("return",chainConfig.chainId||"");case 3:case"end":return _context3.stop()}},_callee3,this)})),function(){return _lookupNetwork.apply(this,arguments)})},{key:"getInjectedProviderProxy",value:function(_){}}]),BaseInjectedProvider}(_web3auth_base_provider__WEBPACK_IMPORTED_MODULE_4__.Zk),getBaseProviderHandlers=function(injectedProvider){var _requestAccounts,_getAccounts,_getPrivateKey,_getSecretKey,_signTransaction,_signMessage,_signAllTransactions,_signAndSendTransaction;return{requestAccounts:(_requestAccounts=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee(){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",injectedProvider.publicKey?[bs58__WEBPACK_IMPORTED_MODULE_5___default().encode(injectedProvider.publicKey.toBytes())]:[]);case 1:case"end":return _context.stop()}},_callee)})),function(){return _requestAccounts.apply(this,arguments)}),getAccounts:(_getAccounts=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee2(){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.abrupt("return",injectedProvider.publicKey?[bs58__WEBPACK_IMPORTED_MODULE_5___default().encode(injectedProvider.publicKey.toBytes())]:[]);case 1:case"end":return _context2.stop()}},_callee2)})),function(){return _getAccounts.apply(this,arguments)}),getPrivateKey:(_getPrivateKey=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee3(){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.rpc.methodNotSupported();case 1:case"end":return _context3.stop()}},_callee3)})),function(){return _getPrivateKey.apply(this,arguments)}),getSecretKey:(_getSecretKey=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee4(){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.rpc.methodNotSupported();case 1:case"end":return _context4.stop()}},_callee4)})),function(){return _getSecretKey.apply(this,arguments)}),signTransaction:(_signTransaction=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee5(req){var transaction;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,injectedProvider.signTransaction(req.params.message);case 2:return transaction=_context5.sent,_context5.abrupt("return",transaction);case 4:case"end":return _context5.stop()}},_callee5)})),function(_x){return _signTransaction.apply(this,arguments)}),signMessage:(_signMessage=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee6(req){var sigData;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.next=2,injectedProvider.signMessage(req.params.message,req.params.display);case 2:return sigData=_context6.sent,_context6.abrupt("return",sigData.signature);case 4:case"end":return _context6.stop()}},_callee6)})),function(_x2){return _signMessage.apply(this,arguments)}),signAllTransactions:(_signAllTransactions=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee7(req){var _req$params,_req$params2,transaction;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:if(!(!(null!==(_req$params=req.params)&&void 0!==_req$params&&_req$params.message)||!(null!==(_req$params2=req.params)&&void 0!==_req$params2&&_req$params2.message.length))){_context7.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.rpc.invalidParams("message");case 2:return _context7.next=4,injectedProvider.signAllTransactions(req.params.message);case 4:return transaction=_context7.sent,_context7.abrupt("return",transaction);case 6:case"end":return _context7.stop()}},_callee7)})),function(_x3){return _signAllTransactions.apply(this,arguments)}),signAndSendTransaction:(_signAndSendTransaction=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee8(req){var txRes;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return _context8.next=2,injectedProvider.signAndSendTransaction(req.params.message);case 2:return txRes=_context8.sent,_context8.abrupt("return",{signature:txRes.signature});case 4:case"end":return _context8.stop()}},_callee8)})),function(_x4){return _signAndSendTransaction.apply(this,arguments)})}};function ownKeys$2(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function createInjectedProviderProxyMiddleware(provider){var _ref;return(0,_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.Pk)((_ref=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee(req,res,_next){var result;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,provider.request(function(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys$2(Object(source),!0).forEach(function(key){(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_10__.Z)(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys$2(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}({},req));case 2:result=_context.sent,res.result=result;case 4:case"end":return _context.stop()}},_callee)})),function(_x,_x2,_x3){return _ref.apply(this,arguments)}))}var PhantomInjectedProvider=function(_BaseInjectedProvider){(0,_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_13__.Z)(PhantomInjectedProvider,_BaseInjectedProvider);var hasNativeReflectConstruct,_super=(hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var result,Super=(0,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_11__.Z)(PhantomInjectedProvider);if(hasNativeReflectConstruct){var NewTarget=(0,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_11__.Z)(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return(0,_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_12__.Z)(this,result)});function PhantomInjectedProvider(){return(0,_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_14__.Z)(this,PhantomInjectedProvider),_super.apply(this,arguments)}return(0,_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_15__.Z)(PhantomInjectedProvider,[{key:"getProviderHandlers",value:function(injectedProvider){return getBaseProviderHandlers(injectedProvider)}},{key:"getInjectedProviderProxy",value:function(injectedProvider){return createInjectedProviderProxyMiddleware(injectedProvider)}}]),PhantomInjectedProvider}(BaseInjectedProvider),getSlopeHandlers=function(injectedProvider,getProviderEngineProxy){var _requestAccounts,_getAccounts,_getPrivateKey,_getSecretKey,_signTransaction,_signMessage,_signAndSendTransaction,_signAllTransactions;return{requestAccounts:(_requestAccounts=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee(){var data;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,injectedProvider.connect();case 2:return data=_context.sent.data,_context.abrupt("return",[data.publicKey]);case 5:case"end":return _context.stop()}},_callee)})),function(){return _requestAccounts.apply(this,arguments)}),getAccounts:(_getAccounts=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee2(){var data;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,injectedProvider.connect();case 2:return data=_context2.sent.data,_context2.abrupt("return",[data.publicKey]);case 5:case"end":return _context2.stop()}},_callee2)})),function(){return _getAccounts.apply(this,arguments)}),getPrivateKey:(_getPrivateKey=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee3(){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.rpc.methodNotSupported();case 1:case"end":return _context3.stop()}},_callee3)})),function(){return _getPrivateKey.apply(this,arguments)}),getSecretKey:(_getSecretKey=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee4(){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.rpc.methodNotSupported();case 1:case"end":return _context4.stop()}},_callee4)})),function(){return _getSecretKey.apply(this,arguments)}),signTransaction:(_signTransaction=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee5(req){var txMessage,data,publicKey,signature;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:if(txMessage=req.params.message){_context5.next=3;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.rpc.invalidRequest({message:"Invalid transaction message"});case 3:return _context5.next=5,injectedProvider.signTransaction(bs58__WEBPACK_IMPORTED_MODULE_5___default().encode(txMessage.serializeMessage()));case 5:if(!(!(data=_context5.sent.data).publicKey||!data.signature)){_context5.next=9;break}throw Error("Invalid signature from slope wallet");case 9:return publicKey=new _solana_web3_js__WEBPACK_IMPORTED_MODULE_7__.nh(data.publicKey),signature=bs58__WEBPACK_IMPORTED_MODULE_5___default().decode(data.signature),txMessage.addSignature(publicKey,signature),_context5.abrupt("return",txMessage);case 13:case"end":return _context5.stop()}},_callee5)})),function(_x){return _signTransaction.apply(this,arguments)}),signMessage:(_signMessage=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee6(req){var response;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.next=2,injectedProvider.signMessage(req.params.message);case 2:return response=_context6.sent,_context6.abrupt("return",bs58__WEBPACK_IMPORTED_MODULE_5___default().decode(response.data.signature));case 4:case"end":return _context6.stop()}},_callee6)})),function(_x2){return _signMessage.apply(this,arguments)}),signAndSendTransaction:(_signAndSendTransaction=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee7(req){var provider,txMessage,data,publicKey,signature,chainConfig,conn,res;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:if(provider=getProviderEngineProxy()){_context7.next=3;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 3:if(txMessage=req.params.message){_context7.next=6;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.rpc.invalidRequest({message:"Invalid transaction message"});case 6:return _context7.next=8,injectedProvider.signTransaction(bs58__WEBPACK_IMPORTED_MODULE_5___default().encode(txMessage.serializeMessage()));case 8:if(!(!(data=_context7.sent.data).publicKey||!data.signature)){_context7.next=12;break}throw Error("Invalid signature from slope wallet");case 12:return publicKey=new _solana_web3_js__WEBPACK_IMPORTED_MODULE_7__.nh(data.publicKey),signature=bs58__WEBPACK_IMPORTED_MODULE_5___default().decode(data.signature),txMessage.addSignature(publicKey,signature),_context7.next=17,provider.request({method:"solana_provider_config",params:[]});case 17:return chainConfig=_context7.sent,conn=new _solana_web3_js__WEBPACK_IMPORTED_MODULE_7__.ew(chainConfig.rpcTarget),_context7.next=21,conn.sendRawTransaction(txMessage.serialize());case 21:return res=_context7.sent,_context7.abrupt("return",{signature:res});case 23:case"end":return _context7.stop()}},_callee7)})),function(_x3){return _signAndSendTransaction.apply(this,arguments)}),signAllTransactions:(_signAllTransactions=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee8(req){var _req$params,_req$params2,_data$signatures,allTxns,length,unsignedTx,i,_yield$injectedProvid5,msg,data,publicKey,signature;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:if(!(!(null!==(_req$params=req.params)&&void 0!==_req$params&&_req$params.message)||!(null!==(_req$params2=req.params)&&void 0!==_req$params2&&_req$params2.message.length))){_context8.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.rpc.invalidParams("message");case 2:for(i=0,length=(allTxns=req.params.message).length,unsignedTx=[];i<length;i++)unsignedTx.push(bs58__WEBPACK_IMPORTED_MODULE_5___default().encode(req.params.message[i].serializeMessage()));return _context8.next=8,injectedProvider.signAllTransactions(unsignedTx);case 8:if(msg=(_yield$injectedProvid5=_context8.sent).msg,!(!(data=_yield$injectedProvid5.data).publicKey||(null===(_data$signatures=data.signatures)||void 0===_data$signatures?void 0:_data$signatures.length)!==length)){_context8.next=13;break}throw Error(msg);case 13:for(i=0,publicKey=new _solana_web3_js__WEBPACK_IMPORTED_MODULE_7__.nh(data.publicKey);i<length;i++)signature=bs58__WEBPACK_IMPORTED_MODULE_5___default().decode(data.signatures[i]),allTxns[i].addSignature(publicKey,signature);return _context8.abrupt("return",allTxns);case 16:case"end":return _context8.stop()}},_callee8)})),function(_x4){return _signAllTransactions.apply(this,arguments)})}},SlopeInjectedProxyProvider=function(_BaseInjectedProvider){(0,_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_13__.Z)(SlopeInjectedProxyProvider,_BaseInjectedProvider);var hasNativeReflectConstruct,_super=(hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var result,Super=(0,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_11__.Z)(SlopeInjectedProxyProvider);if(hasNativeReflectConstruct){var NewTarget=(0,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_11__.Z)(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return(0,_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_12__.Z)(this,result)});function SlopeInjectedProxyProvider(){return(0,_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_14__.Z)(this,SlopeInjectedProxyProvider),_super.apply(this,arguments)}return(0,_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_15__.Z)(SlopeInjectedProxyProvider,[{key:"getProviderHandlers",value:function(injectedProvider){return getSlopeHandlers(injectedProvider,this.getProviderEngineProxy.bind(this))}}]),SlopeInjectedProxyProvider}(BaseInjectedProvider),getSolflareHandlers=function(injectedProvider,getProviderEngineProxy){var _ref,solflareProviderHandlers=getBaseProviderHandlers(injectedProvider);return solflareProviderHandlers.signAndSendTransaction=(_ref=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee(req){var provider,transaction,chainConfig,conn,res;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(provider=getProviderEngineProxy()){_context.next=3;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 3:return _context.next=5,injectedProvider.signTransaction(req.params.message);case 5:return transaction=_context.sent,_context.next=8,provider.request({method:"solana_provider_config",params:[]});case 8:return chainConfig=_context.sent,conn=new _solana_web3_js__WEBPACK_IMPORTED_MODULE_7__.ew(chainConfig.rpcTarget),_context.next=12,conn.sendRawTransaction(transaction.serialize());case 12:return res=_context.sent,_context.abrupt("return",{signature:res});case 14:case"end":return _context.stop()}},_callee)})),function(_x){return _ref.apply(this,arguments)}),solflareProviderHandlers},SolflareInjectedProvider=function(_BaseInjectedProvider){(0,_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_13__.Z)(SolflareInjectedProvider,_BaseInjectedProvider);var hasNativeReflectConstruct,_super=(hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var result,Super=(0,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_11__.Z)(SolflareInjectedProvider);if(hasNativeReflectConstruct){var NewTarget=(0,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_11__.Z)(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return(0,_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_12__.Z)(this,result)});function SolflareInjectedProvider(){return(0,_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_14__.Z)(this,SolflareInjectedProvider),_super.apply(this,arguments)}return(0,_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_15__.Z)(SolflareInjectedProvider,[{key:"getProviderHandlers",value:function(injectedProvider){return getSolflareHandlers(injectedProvider,this.getProviderEngineProxy.bind(this))}}]),SolflareInjectedProvider}(BaseInjectedProvider),getSolletHandlers=function(injectedProvider,getProviderEngineProxy){var _ref,_ref2,providerHandlers=getBaseProviderHandlers(injectedProvider);return providerHandlers.signMessage=(_ref=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee(req){var signature;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,injectedProvider.sign(req.params.message,"utf8");case 2:return signature=_context.sent.signature,_context.abrupt("return",signature);case 5:case"end":return _context.stop()}},_callee)})),function(_x){return _ref.apply(this,arguments)}),providerHandlers.signAndSendTransaction=(_ref2=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee2(req){var provider,transaction,chainConfig,conn,res;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(provider=getProviderEngineProxy()){_context2.next=3;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 3:return _context2.next=5,injectedProvider.signTransaction(req.params.message);case 5:return transaction=_context2.sent,_context2.next=8,provider.request({method:"solana_provider_config",params:[]});case 8:return chainConfig=_context2.sent,conn=new _solana_web3_js__WEBPACK_IMPORTED_MODULE_7__.ew(chainConfig.rpcTarget),_context2.next=12,conn.sendRawTransaction(transaction.serialize());case 12:return res=_context2.sent,_context2.abrupt("return",{signature:res});case 14:case"end":return _context2.stop()}},_callee2)})),function(_x2){return _ref2.apply(this,arguments)}),providerHandlers},SolletInjectedProvider=function(_BaseInjectedProvider){(0,_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_13__.Z)(SolletInjectedProvider,_BaseInjectedProvider);var hasNativeReflectConstruct,_super=(hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var result,Super=(0,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_11__.Z)(SolletInjectedProvider);if(hasNativeReflectConstruct){var NewTarget=(0,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_11__.Z)(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return(0,_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_12__.Z)(this,result)});function SolletInjectedProvider(){return(0,_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_14__.Z)(this,SolletInjectedProvider),_super.apply(this,arguments)}return(0,_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_15__.Z)(SolletInjectedProvider,[{key:"getProviderHandlers",value:function(injectedProvider){return getSolletHandlers(injectedProvider,this.getProviderEngineProxy.bind(this))}}]),SolletInjectedProvider}(BaseInjectedProvider),getTorusHandlers=function(injectedProvider){var _requestAccounts,_getAccounts,_getPrivateKey,_getSecretKey,_signMessage,_signTransaction,_signAndSendTransaction,_signAllTransactions;return{requestAccounts:(_requestAccounts=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee(){var accounts;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,injectedProvider.request({method:"solana_requestAccounts",params:{}});case 2:return accounts=_context.sent,_context.abrupt("return",accounts);case 4:case"end":return _context.stop()}},_callee)})),function(){return _requestAccounts.apply(this,arguments)}),getAccounts:(_getAccounts=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee2(){var accounts;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,injectedProvider.request({method:"solana_requestAccounts",params:{}});case 2:return accounts=_context2.sent,_context2.abrupt("return",accounts);case 4:case"end":return _context2.stop()}},_callee2)})),function(){return _getAccounts.apply(this,arguments)}),getPrivateKey:(_getPrivateKey=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee3(){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.rpc.methodNotSupported();case 1:case"end":return _context3.stop()}},_callee3)})),function(){return _getPrivateKey.apply(this,arguments)}),getSecretKey:(_getSecretKey=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee4(){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.rpc.methodNotSupported();case 1:case"end":return _context4.stop()}},_callee4)})),function(){return _getSecretKey.apply(this,arguments)}),signMessage:(_signMessage=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee5(req){var _req$params,message;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:if(null!==(_req$params=req.params)&&void 0!==_req$params&&_req$params.message){_context5.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.rpc.invalidParams("message");case 2:return _context5.next=4,injectedProvider.signMessage(req.params.message);case 4:return message=_context5.sent,_context5.abrupt("return",message);case 6:case"end":return _context5.stop()}},_callee5)})),function(_x){return _signMessage.apply(this,arguments)}),signTransaction:(_signTransaction=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee6(req){var _req$params2,txMessage,response;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:if(null!==(_req$params2=req.params)&&void 0!==_req$params2&&_req$params2.message){_context6.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.rpc.invalidParams("message");case 2:return txMessage=req.params.message,_context6.next=5,injectedProvider.signTransaction(txMessage);case 5:return response=_context6.sent,_context6.abrupt("return",response);case 7:case"end":return _context6.stop()}},_callee6)})),function(_x2){return _signTransaction.apply(this,arguments)}),signAndSendTransaction:(_signAndSendTransaction=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee7(req){var _req$params3,txMessage,response;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:if(null!==(_req$params3=req.params)&&void 0!==_req$params3&&_req$params3.message){_context7.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.rpc.invalidParams("message");case 2:return txMessage=req.params.message,_context7.next=5,injectedProvider.sendTransaction(txMessage);case 5:return response=_context7.sent,_context7.abrupt("return",{signature:response});case 7:case"end":return _context7.stop()}},_callee7)})),function(_x3){return _signAndSendTransaction.apply(this,arguments)}),signAllTransactions:(_signAllTransactions=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee8(req){var _req$params4,_req$params5,transactions,response;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:if(!(!(null!==(_req$params4=req.params)&&void 0!==_req$params4&&_req$params4.message)||!(null!==(_req$params5=req.params)&&void 0!==_req$params5&&_req$params5.message.length))){_context8.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.rpc.invalidParams("message");case 2:return transactions=req.params.message,_context8.next=5,injectedProvider.signAllTransactions(transactions);case 5:return response=_context8.sent,_context8.abrupt("return",response);case 7:case"end":return _context8.stop()}},_callee8)})),function(_x4){return _signAllTransactions.apply(this,arguments)})}};function ownKeys$1(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _objectSpread$1(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys$1(Object(source),!0).forEach(function(key){(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_10__.Z)(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys$1(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}var TorusInjectedProvider=function(_BaseProvider){(0,_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_13__.Z)(TorusInjectedProvider,_BaseProvider);var hasNativeReflectConstruct,_switchChain,_setupProvider,_lookupNetwork,_setupEngine,_handleInjectedProviderUpdate,_super=(hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var result,Super=(0,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_11__.Z)(TorusInjectedProvider);if(hasNativeReflectConstruct){var NewTarget=(0,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_11__.Z)(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return(0,_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_12__.Z)(this,result)});function TorusInjectedProvider(_ref){var config=_ref.config,state=_ref.state;return(0,_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_14__.Z)(this,TorusInjectedProvider),_super.call(this,{config:{chainConfig:_objectSpread$1(_objectSpread$1({},config.chainConfig),{},{chainNamespace:_web3auth_base__WEBPACK_IMPORTED_MODULE_3__.EN.SOLANA})},state:state})}return(0,_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_15__.Z)(TorusInjectedProvider,[{key:"switchChain",value:(_switchChain=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee(_){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",Promise.resolve());case 1:case"end":return _context.stop()}},_callee)})),function(_x){return _switchChain.apply(this,arguments)})},{key:"setupProvider",value:(_setupProvider=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee2(injectedProvider){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return this.handleInjectedProviderUpdate(injectedProvider),_context2.next=3,this.setupEngine(injectedProvider);case 3:case"end":return _context2.stop()}},_callee2,this)})),function(_x2){return _setupProvider.apply(this,arguments)})},{key:"lookupNetwork",value:(_lookupNetwork=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee3(){var chainId,connectedChainId,connectedHexChainId;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(this.provider){_context3.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.provider.custom({message:"Torus solana provider is not initialized",code:4902});case 2:return chainId=this.config.chainConfig.chainId,_context3.next=5,this.provider.request({method:"solana_chainId"});case 5:if(connectedChainId=_context3.sent,!(chainId!==(connectedHexChainId=(0,_web3auth_base__WEBPACK_IMPORTED_MODULE_3__.H2)(connectedChainId.toString())?connectedChainId:"0x".concat(parseInt(connectedChainId,10).toString(16))))){_context3.next=9;break}throw _web3auth_base__WEBPACK_IMPORTED_MODULE_3__.Ty.rpcConnectionError("Invalid network, net_version is: ".concat(connectedHexChainId,", expected: ").concat(chainId));case 9:return this.update({chainId:connectedHexChainId}),this.provider.emit("connect",{chainId:this.state.chainId}),this.provider.emit("chainChanged",this.state.chainId),_context3.abrupt("return",this.state.chainId);case 13:case"end":return _context3.stop()}},_callee3,this)})),function(){return _lookupNetwork.apply(this,arguments)})},{key:"setupEngine",value:(_setupEngine=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee4(injectedProvider){var solanaMiddleware,injectedProviderProxy,engine,provider;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return solanaMiddleware=createSolanaMiddleware(getTorusHandlers(injectedProvider)),injectedProviderProxy=createInjectedProviderProxyMiddleware(injectedProvider),(engine=new _toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.eI).push(solanaMiddleware),engine.push(injectedProviderProxy),provider=(0,_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_1__.Xj)(engine),this.updateProviderEngineProxy(provider),_context4.next=10,this.lookupNetwork();case 10:case"end":return _context4.stop()}},_callee4,this)})),function(_x3){return _setupEngine.apply(this,arguments)})},{key:"handleInjectedProviderUpdate",value:(_handleInjectedProviderUpdate=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee7(injectedProvider){var _this=this;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:injectedProvider.on("accountsChanged",function(){var _ref2=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee5(accounts){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:_this.provider.emit("accountsChanged",accounts);case 1:case"end":return _context5.stop()}},_callee5)}));return function(_x5){return _ref2.apply(this,arguments)}}()),injectedProvider.on("chainChanged",function(){var _ref3=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee6(chainId){var connectedHexChainId;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return connectedHexChainId=(0,_web3auth_base__WEBPACK_IMPORTED_MODULE_3__.H2)(chainId)?chainId:"0x".concat(parseInt(chainId,10).toString(16)),_this.configure({chainConfig:_objectSpread$1(_objectSpread$1({},_this.config.chainConfig),{},{chainId:connectedHexChainId})}),_context6.next=4,_this.setupProvider(injectedProvider);case 4:case"end":return _context6.stop()}},_callee6)}));return function(_x6){return _ref3.apply(this,arguments)}}());case 2:case"end":return _context7.stop()}},_callee7)})),function(_x4){return _handleInjectedProviderUpdate.apply(this,arguments)})}]),TorusInjectedProvider}(_web3auth_base_provider__WEBPACK_IMPORTED_MODULE_4__.Zk);function _arrayLikeToArray(arr,len){(null==len||len>arr.length)&&(len=arr.length);for(var i=0,arr2=Array(len);i<len;i++)arr2[i]=arr[i];return arr2}function _getProviderHandlers(){return(_getProviderHandlers=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee9(_ref){var privKey,getProviderEngineProxy,keyPairGenerator,keyPair,providerHandlers;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:if(privKey=_ref.privKey,getProviderEngineProxy=_ref.getProviderEngineProxy,keyPairGenerator=function(){return _solana_web3_js__WEBPACK_IMPORTED_MODULE_7__.RG.fromSecretKey(Buffer.from(privKey,"hex"))},!("string"!=typeof privKey)){_context9.next=4;break}throw _web3auth_base__WEBPACK_IMPORTED_MODULE_3__.Ty.invalidParams("privKey must be a string");case 4:return keyPair=keyPairGenerator(),providerHandlers={requestAccounts:function(){var _requestAccounts=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee(){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",[keyPair.publicKey.toBase58()]);case 1:case"end":return _context.stop()}},_callee)}));return function(){return _requestAccounts.apply(this,arguments)}}(),getAccounts:function(){var _getAccounts=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee2(){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.abrupt("return",[keyPair.publicKey.toBase58()]);case 1:case"end":return _context2.stop()}},_callee2)}));return function(){return _getAccounts.apply(this,arguments)}}(),getPrivateKey:function(){var _getPrivateKey=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee3(){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.abrupt("return",privKey);case 1:case"end":return _context3.stop()}},_callee3)}));return function(){return _getPrivateKey.apply(this,arguments)}}(),getSecretKey:function(){var _getSecretKey=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee4(){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.abrupt("return",bs58__WEBPACK_IMPORTED_MODULE_5___default().encode(keyPair.secretKey));case 1:case"end":return _context4.stop()}},_callee4)}));return function(){return _getSecretKey.apply(this,arguments)}}(),signTransaction:function(){var _signTransaction=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee5(req){var _req$params,transaction;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:if(null!==(_req$params=req.params)&&void 0!==_req$params&&_req$params.message){_context5.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.rpc.invalidParams("message");case 2:return(transaction=req.params.message).partialSign(keyPair),_context5.abrupt("return",transaction);case 5:case"end":return _context5.stop()}},_callee5)}));return function(_x2){return _signTransaction.apply(this,arguments)}}(),signMessage:function(){var _signMessage=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee6(req){var _req$params2,signedMsg;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:if(null!==(_req$params2=req.params)&&void 0!==_req$params2&&_req$params2.message){_context6.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.rpc.invalidParams("message");case 2:return signedMsg=_toruslabs_tweetnacl_js__WEBPACK_IMPORTED_MODULE_8___default().sign.detached(req.params.message,keyPair.secretKey),_context6.abrupt("return",signedMsg);case 4:case"end":return _context6.stop()}},_callee6)}));return function(_x3){return _signMessage.apply(this,arguments)}}(),signAndSendTransaction:function(){var _signAndSendTransaction=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee7(req){var _req$params3,_providerEngineProxy,transaction,sig;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:if(null!==(_req$params3=req.params)&&void 0!==_req$params3&&_req$params3.message){_context7.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.rpc.invalidParams("message");case 2:if(_providerEngineProxy=getProviderEngineProxy()){_context7.next=5;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 5:return(transaction=req.params.message).sign(keyPair),_context7.next=9,_providerEngineProxy.request({method:"sendTransaction",params:[bs58__WEBPACK_IMPORTED_MODULE_5___default().encode(transaction.serialize())]});case 9:return sig=_context7.sent,_context7.abrupt("return",{signature:sig});case 11:case"end":return _context7.stop()}},_callee7)}));return function(_x4){return _signAndSendTransaction.apply(this,arguments)}}(),signAllTransactions:function(){var _signAllTransactions=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee8(req){var _req$params4,_req$params5,_req$params6,txns,_iterator,_step;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:if(!(!(null!==(_req$params4=req.params)&&void 0!==_req$params4&&_req$params4.message)||!(null!==(_req$params5=req.params)&&void 0!==_req$params5&&_req$params5.message.length))){_context8.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.rpc.invalidParams("message");case 2:_iterator=function(o,allowArrayLike){var it="undefined"!=typeof Symbol&&o[Symbol.iterator]||o["@@iterator"];if(!it){if(Array.isArray(o)||(it=function(o,minLen){if(o){if("string"==typeof o)return _arrayLikeToArray(o,minLen);var n=Object.prototype.toString.call(o).slice(8,-1);if("Object"===n&&o.constructor&&(n=o.constructor.name),"Map"===n||"Set"===n)return Array.from(o);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _arrayLikeToArray(o,minLen)}}(o))){it&&(o=it);var i=0,F=function(){};return{s:F,n:function(){return i>=o.length?{done:!0}:{done:!1,value:o[i++]}},e:function(_e){throw _e},f:F}}throw TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var err,normalCompletion=!0,didErr=!1;return{s:function(){it=it.call(o)},n:function(){var step=it.next();return normalCompletion=step.done,step},e:function(_e2){didErr=!0,err=_e2},f:function(){try{normalCompletion||null==it.return||it.return()}finally{if(didErr)throw err}}}}((txns=null===(_req$params6=req.params)||void 0===_req$params6?void 0:_req$params6.message)||[]);try{for(_iterator.s();!(_step=_iterator.n()).done;)_step.value.partialSign(keyPair)}catch(err){_iterator.e(err)}finally{_iterator.f()}return _context8.abrupt("return",txns);case 6:case"end":return _context8.stop()}},_callee8)}));return function(_x5){return _signAllTransactions.apply(this,arguments)}}()},_context9.abrupt("return",providerHandlers);case 7:case"end":return _context9.stop()}},_callee9)}))).apply(this,arguments)}function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_10__.Z)(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}var SolanaPrivateKeyProvider=function(_BaseProvider){(0,_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_13__.Z)(SolanaPrivateKeyProvider,_BaseProvider);var hasNativeReflectConstruct,_enable,_setupProvider,_updateAccount,_switchChain,_lookupNetwork,_super=(hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var result,Super=(0,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_11__.Z)(SolanaPrivateKeyProvider);if(hasNativeReflectConstruct){var NewTarget=(0,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_11__.Z)(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return(0,_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_12__.Z)(this,result)});function SolanaPrivateKeyProvider(_ref){var config=_ref.config,state=_ref.state;return(0,_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_14__.Z)(this,SolanaPrivateKeyProvider),_super.call(this,{config:{chainConfig:_objectSpread(_objectSpread({},config.chainConfig),{},{chainNamespace:_web3auth_base__WEBPACK_IMPORTED_MODULE_3__.EN.SOLANA})},state:state})}return(0,_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_15__.Z)(SolanaPrivateKeyProvider,[{key:"enable",value:(_enable=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee(){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(this.state.privateKey){_context.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.provider.custom({message:"Private key is not found in state, plz pass it in constructor state param",code:4902});case 2:return _context.next=4,this.setupProvider(this.state.privateKey);case 4:return _context.abrupt("return",this._providerEngineProxy.request({method:"eth_accounts"}));case 5:case"end":return _context.stop()}},_callee,this)})),function(){return _enable.apply(this,arguments)})},{key:"setupProvider",value:(_setupProvider=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee2(privKey){var solanaMiddleware,engine,networkMiddleware,provider;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,function(_x){return _getProviderHandlers.apply(this,arguments)}({privKey:privKey,getProviderEngineProxy:this.getProviderEngineProxy.bind(this)});case 2:return solanaMiddleware=createSolanaMiddleware(_context2.sent),engine=new _toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.eI,networkMiddleware=function(providerConfig){var rpcTarget=providerConfig.rpcTarget,fetchMiddleware=(0,_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_1__.v$)({rpcTarget:rpcTarget});return{networkMiddleware:(0,_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.UZ)([createConfigMiddleware(providerConfig),fetchMiddleware]),fetchMiddleware:fetchMiddleware}}(this.config.chainConfig).networkMiddleware,engine.push(this.getChainSwitchMiddleware()),engine.push(this.getAccountMiddleware()),engine.push(solanaMiddleware),engine.push(networkMiddleware),provider=(0,_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_1__.Xj)(engine),this.updateProviderEngineProxy(provider),_context2.next=14,this.lookupNetwork();case 14:case"end":return _context2.stop()}},_callee2,this)})),function(_x){return _setupProvider.apply(this,arguments)})},{key:"updateAccount",value:(_updateAccount=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee3(params){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(this._providerEngineProxy){_context3.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 2:return _context3.next=4,this._providerEngineProxy.request({method:"solanaPrivateKey"});case 4:if(!(_context3.sent!==params.privateKey)){_context3.next=14;break}return _context3.next=8,this.setupProvider(params.privateKey);case 8:return _context3.t0=this._providerEngineProxy,_context3.next=11,this._providerEngineProxy.request({method:"requestAccounts"});case 11:_context3.t1=_context3.sent,_context3.t2={accounts:_context3.t1},_context3.t0.emit.call(_context3.t0,"accountsChanged",_context3.t2);case 14:case"end":return _context3.stop()}},_callee3,this)})),function(_x2){return _updateAccount.apply(this,arguments)})},{key:"switchChain",value:(_switchChain=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee4(params){var chainConfig,privKey;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if(this._providerEngineProxy){_context4.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 2:return chainConfig=this.getChainConfig(params.chainId),this.update({chainId:"loading"}),this.configure({chainConfig:chainConfig}),_context4.next=7,this._providerEngineProxy.request({method:"solanaPrivateKey"});case 7:return privKey=_context4.sent,_context4.next=10,this.setupProvider(privKey);case 10:case"end":return _context4.stop()}},_callee4,this)})),function(_x3){return _switchChain.apply(this,arguments)})},{key:"lookupNetwork",value:(_lookupNetwork=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee5(){var health,chainConfig;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:if(this._providerEngineProxy){_context5.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 2:return _context5.next=4,this._providerEngineProxy.request({method:"getHealth",params:[]});case 4:if(health=_context5.sent,chainConfig=this.config.chainConfig,!("ok"!==health)){_context5.next=8;break}throw _web3auth_base__WEBPACK_IMPORTED_MODULE_3__.Ty.rpcConnectionError("Failed to lookup network for following rpc target: ".concat(chainConfig.rpcTarget));case 8:return this.update({chainId:chainConfig.chainId}),this.state.chainId!==chainConfig.chainId&&(this.provider.emit("chainChanged",this.state.chainId),this.provider.emit("connect",{chainId:this.state.chainId})),_context5.abrupt("return",this.state.chainId);case 11:case"end":return _context5.stop()}},_callee5,this)})),function(){return _lookupNetwork.apply(this,arguments)})},{key:"getChainSwitchMiddleware",value:function(){var _addNewChainConfig,_switchSolanaChain,_ref6,addNewChainConfig,switchSolanaChain,_this=this;return addNewChainConfig=(_ref6={addNewChainConfig:(_addNewChainConfig=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee6(req){var _req$params,chainId,chainName,rpcUrls,blockExplorerUrls,nativeCurrency;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:if(req.params){_context6.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.rpc.invalidParams("Missing request params");case 2:if(chainId=(_req$params=req.params).chainId,chainName=_req$params.chainName,rpcUrls=_req$params.rpcUrls,blockExplorerUrls=_req$params.blockExplorerUrls,nativeCurrency=_req$params.nativeCurrency,chainId){_context6.next=5;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.rpc.invalidParams("Missing chainId in chainParams");case 5:if(!(!rpcUrls||0===rpcUrls.length)){_context6.next=7;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.rpc.invalidParams("Missing rpcUrls in chainParams");case 7:if(nativeCurrency){_context6.next=9;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.rpc.invalidParams("Missing nativeCurrency in chainParams");case 9:_this.addChain({chainNamespace:_web3auth_base__WEBPACK_IMPORTED_MODULE_3__.EN.SOLANA,chainId:chainId,ticker:(null==nativeCurrency?void 0:nativeCurrency.symbol)||"SOL",tickerName:(null==nativeCurrency?void 0:nativeCurrency.name)||"Solana",displayName:chainName,rpcTarget:rpcUrls[0],blockExplorer:(null==blockExplorerUrls?void 0:blockExplorerUrls[0])||""});case 10:case"end":return _context6.stop()}},_callee6)})),function(_x4){return _addNewChainConfig.apply(this,arguments)}),switchSolanaChain:(_switchSolanaChain=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee7(req){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:if(req.params){_context7.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.rpc.invalidParams("Missing request params");case 2:if(req.params.chainId){_context7.next=4;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.rpc.invalidParams("Missing chainId");case 4:return _context7.next=6,_this.switchChain(req.params);case 6:case"end":return _context7.stop()}},_callee7)})),function(_x5){return _switchSolanaChain.apply(this,arguments)})}).addNewChainConfig,switchSolanaChain=_ref6.switchSolanaChain,(0,_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.UZ)([createGenericJRPCMiddleware("addSolanaChain",addNewChainConfig),createGenericJRPCMiddleware("switchSolanaChain",switchSolanaChain)])}},{key:"getAccountMiddleware",value:function(){var _updatePrivatekey,updatePrivatekey,_this2=this;return updatePrivatekey=({updatePrivatekey:(_updatePrivatekey=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee8(req){var privateKey;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:if(req.params){_context8.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.rpc.invalidParams("Missing request params");case 2:if(req.params.privateKey){_context8.next=4;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_6__.ethErrors.rpc.invalidParams("Missing privateKey");case 4:return privateKey=req.params.privateKey,_context8.next=7,_this2.updateAccount({privateKey:privateKey});case 7:case"end":return _context8.stop()}},_callee8)})),function(_x6){return _updatePrivatekey.apply(this,arguments)})}).updatePrivatekey,(0,_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.UZ)([createGenericJRPCMiddleware("updateAccount",updatePrivatekey)])}}]),SolanaPrivateKeyProvider}(_web3auth_base_provider__WEBPACK_IMPORTED_MODULE_4__.Zk);(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_10__.Z)(SolanaPrivateKeyProvider,"getProviderInstance",(_ref2=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee9(params){var providerFactory;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:return providerFactory=new SolanaPrivateKeyProvider({config:{chainConfig:params.chainConfig}}),_context9.next=3,providerFactory.setupProvider(params.privKey);case 3:return _context9.abrupt("return",providerFactory);case 4:case"end":return _context9.stop()}},_callee9)})),function(_x7){return _ref2.apply(this,arguments)}));var SolanaWallet=function(){var _requestAccounts,_signAndSendTransaction,_signTransaction,_signAllTransactions,_signMessage,_request;function SolanaWallet(provider){(0,_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_14__.Z)(this,SolanaWallet),(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_10__.Z)(this,"provider",void 0),this.provider=provider}return(0,_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_15__.Z)(SolanaWallet,[{key:"requestAccounts",value:(_requestAccounts=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee(){var accounts;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,this.provider.request({method:"requestAccounts",params:{}});case 2:return accounts=_context.sent,_context.abrupt("return",accounts);case 4:case"end":return _context.stop()}},_callee,this)})),function(){return _requestAccounts.apply(this,arguments)})},{key:"signAndSendTransaction",value:(_signAndSendTransaction=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee2(transaction){var signature;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,this.provider.request({method:"signAndSendTransaction",params:{message:transaction}});case 2:return signature=_context2.sent.signature,_context2.abrupt("return",{signature:signature});case 5:case"end":return _context2.stop()}},_callee2,this)})),function(_x){return _signAndSendTransaction.apply(this,arguments)})},{key:"signTransaction",value:(_signTransaction=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee3(transaction){var signedTransaction;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,this.provider.request({method:"signTransaction",params:{message:transaction}});case 2:return signedTransaction=_context3.sent,_context3.abrupt("return",signedTransaction);case 4:case"end":return _context3.stop()}},_callee3,this)})),function(_x2){return _signTransaction.apply(this,arguments)})},{key:"signAllTransactions",value:(_signAllTransactions=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee4(transactions){var signedTransactions;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,this.provider.request({method:"signAllTransactions",params:{message:transactions}});case 2:return signedTransactions=_context4.sent,_context4.abrupt("return",signedTransactions);case 4:case"end":return _context4.stop()}},_callee4,this)})),function(_x3){return _signAllTransactions.apply(this,arguments)})},{key:"signMessage",value:(_signMessage=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee5(data){var response;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,this.provider.request({method:"signMessage",params:{message:data}});case 2:return response=_context5.sent,_context5.abrupt("return",response);case 4:case"end":return _context5.stop()}},_callee5,this)})),function(_x4){return _signMessage.apply(this,arguments)})},{key:"request",value:(_request=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_9__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee6(args){var result;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.next=2,this.provider.request(args);case 2:return result=_context6.sent,_context6.abrupt("return",result);case 4:case"end":return _context6.stop()}},_callee6,this)})),function(_x5){return _request.apply(this,arguments)})}]),SolanaWallet}()}}]);