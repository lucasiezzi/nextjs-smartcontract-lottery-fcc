(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[961],{10961:function(__unused_webpack_module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{EthereumPrivateKeyProvider:function(){return EthereumPrivateKeyProvider},TransactionFormatter:function(){return TransactionFormatter},WalletConnectProvider:function(){return WalletConnectProvider},getProviderHandlers:function(){return getProviderHandlers}});var _ref4,_ref2,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__=__webpack_require__(15861),_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_19__=__webpack_require__(15671),_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_21__=__webpack_require__(43144),_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_20__=__webpack_require__(97326),_babel_runtime_helpers_get__WEBPACK_IMPORTED_MODULE_22__=__webpack_require__(73237),_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_18__=__webpack_require__(60136),_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_17__=__webpack_require__(82963),_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_16__=__webpack_require__(61120),_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_14__=__webpack_require__(4942),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(64687),_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0__),_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(22782),_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(64049),_web3auth_base__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__(16843),_web3auth_base_provider__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__(68531),eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__(79826),_ethereumjs_tx__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__(66052),_metamask_eth_sig_util__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__(51091),ethereumjs_util__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__(53934),_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_23__=__webpack_require__(71002),_toruslabs_http_helpers__WEBPACK_IMPORTED_MODULE_9__=__webpack_require__(20917),assert__WEBPACK_IMPORTED_MODULE_10__=__webpack_require__(69282),assert__WEBPACK_IMPORTED_MODULE_10___default=__webpack_require__.n(assert__WEBPACK_IMPORTED_MODULE_10__),jsonschema__WEBPACK_IMPORTED_MODULE_11__=__webpack_require__(40660),bignumber_js__WEBPACK_IMPORTED_MODULE_12__=__webpack_require__(70794),_ethereumjs_common__WEBPACK_IMPORTED_MODULE_13__=__webpack_require__(2832),_ethereumjs_common__WEBPACK_IMPORTED_MODULE_13___default=__webpack_require__.n(_ethereumjs_common__WEBPACK_IMPORTED_MODULE_13__),Buffer=__webpack_require__(48764).Buffer;function ownKeys$5(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _objectSpread$5(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys$5(Object(source),!0).forEach(function(key){(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_14__.Z)(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys$5(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}function resemblesAddress(str){return 42===str.length}function createEthMiddleware(providerHandlers){var getAccounts=providerHandlers.getAccounts,getPrivateKey=providerHandlers.getPrivateKey,processTransaction=providerHandlers.processTransaction,processSignTransaction=providerHandlers.processSignTransaction,processEthSignMessage=providerHandlers.processEthSignMessage,processTypedMessage=providerHandlers.processTypedMessage,processTypedMessageV3=providerHandlers.processTypedMessageV3,processTypedMessageV4=providerHandlers.processTypedMessageV4,processPersonalMessage=providerHandlers.processPersonalMessage,processEncryptionPublicKey=providerHandlers.processEncryptionPublicKey,processDecryptMessage=providerHandlers.processDecryptMessage;return(0,_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.UZ)([(0,_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.v0)({eth_syncing:!1}),function(_ref){var getAccounts=_ref.getAccounts,getPrivateKey=_ref.getPrivateKey,processDecryptMessage=_ref.processDecryptMessage,processEncryptionPublicKey=_ref.processEncryptionPublicKey,processEthSignMessage=_ref.processEthSignMessage,processPersonalMessage=_ref.processPersonalMessage,processTransaction=_ref.processTransaction,processSignTransaction=_ref.processSignTransaction,processTypedMessage=_ref.processTypedMessage,processTypedMessageV3=_ref.processTypedMessageV3,processTypedMessageV4=_ref.processTypedMessageV4;if(!getAccounts)throw Error("opts.getAccounts is required");function validateAndNormalizeKeyholder(_x,_x2){return _validateAndNormalizeKeyholder.apply(this,arguments)}function _validateAndNormalizeKeyholder(){return(_validateAndNormalizeKeyholder=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee(address,req){var normalizedAccounts,normalizedAddress;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!("string"==typeof address&&address.length>0)){_context.next=8;break}return _context.next=3,getAccounts(req);case 3:if(normalizedAccounts=_context.sent.map(function(_address){return _address.toLowerCase()}),normalizedAddress=address.toLowerCase(),!normalizedAccounts.includes(normalizedAddress)){_context.next=8;break}return _context.abrupt("return",normalizedAddress);case 8:throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.rpc.invalidParams({message:"Invalid parameters: must provide an Ethereum address."});case 9:case"end":return _context.stop()}},_callee)}))).apply(this,arguments)}function _lookupAccounts(){return(_lookupAccounts=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee2(req,res){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,getAccounts(req);case 2:res.result=_context2.sent;case 3:case"end":return _context2.stop()}},_callee2)}))).apply(this,arguments)}function _lookupDefaultAccount(){return(_lookupDefaultAccount=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee3(req,res){var accounts;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,getAccounts(req);case 2:accounts=_context3.sent,res.result=accounts[0]||null;case 4:case"end":return _context3.stop()}},_callee3)}))).apply(this,arguments)}function _sendTransaction(){return(_sendTransaction=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee4(req,res){var txParams;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if(processTransaction){_context4.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.rpc.methodNotSupported();case 2:return txParams=req.params[0]||{from:""},_context4.next=5,validateAndNormalizeKeyholder(txParams.from,req);case 5:return txParams.from=_context4.sent,_context4.next=8,processTransaction(txParams,req);case 8:res.result=_context4.sent;case 9:case"end":return _context4.stop()}},_callee4)}))).apply(this,arguments)}function _signTransaction(){return(_signTransaction=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee5(req,res){var txParams;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:if(processSignTransaction){_context5.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.rpc.methodNotSupported();case 2:return txParams=req.params[0]||{from:""},_context5.next=5,validateAndNormalizeKeyholder(txParams.from,req);case 5:return txParams.from=_context5.sent,_context5.next=8,processSignTransaction(txParams,req);case 8:res.result=_context5.sent;case 9:case"end":return _context5.stop()}},_callee5)}))).apply(this,arguments)}function _ethSign(){return(_ethSign=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee6(req,res){var address,message,msgParams;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:if(processEthSignMessage){_context6.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.rpc.methodNotSupported();case 2:return _context6.next=4,validateAndNormalizeKeyholder(req.params[0],req);case 4:return address=_context6.sent,message=req.params[1],msgParams=_objectSpread$5(_objectSpread$5({},req.params[2]||{}),{},{from:address,data:message}),_context6.next=10,processEthSignMessage(msgParams,req);case 10:res.result=_context6.sent;case 11:case"end":return _context6.stop()}},_callee6)}))).apply(this,arguments)}function _signTypedData(){return(_signTypedData=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee7(req,res){var message,address,msgParams;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:if(processTypedMessage){_context7.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.rpc.methodNotSupported();case 2:return message=req.params[0],_context7.next=5,validateAndNormalizeKeyholder(req.params[1],req);case 5:return address=_context7.sent,msgParams=_objectSpread$5(_objectSpread$5({},req.params[2]||{}),{},{from:address,data:message}),_context7.next=11,processTypedMessage(msgParams,req,"V1");case 11:res.result=_context7.sent;case 12:case"end":return _context7.stop()}},_callee7)}))).apply(this,arguments)}function _signTypedDataV(){return(_signTypedDataV=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee8(req,res){var address,msgParams;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:if(processTypedMessageV3){_context8.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.rpc.methodNotSupported();case 2:return _context8.next=4,validateAndNormalizeKeyholder(req.params[0],req);case 4:return address=_context8.sent,msgParams={data:req.params[1],from:address,version:"V3"},_context8.next=10,processTypedMessageV3(msgParams,req,"V3");case 10:res.result=_context8.sent;case 11:case"end":return _context8.stop()}},_callee8)}))).apply(this,arguments)}function _signTypedDataV2(){return(_signTypedDataV2=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee9(req,res){var address,msgParams;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:if(processTypedMessageV4){_context9.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.rpc.methodNotSupported();case 2:return _context9.next=4,validateAndNormalizeKeyholder(req.params[0],req);case 4:return address=_context9.sent,msgParams={data:req.params[1],from:address,version:"V4"},_context9.next=10,processTypedMessageV4(msgParams,req,"V4");case 10:res.result=_context9.sent;case 11:case"end":return _context9.stop()}},_callee9)}))).apply(this,arguments)}function _personalSign(){return(_personalSign=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee10(req,res){var firstParam,secondParam,extraParams,address,message,msgParams;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context10){for(;;)switch(_context10.prev=_context10.next){case 0:if(processPersonalMessage){_context10.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.rpc.methodNotSupported();case 2:return firstParam=req.params[0],secondParam=req.params[1],extraParams=req.params[2]||{},resemblesAddress(firstParam)&&!resemblesAddress(secondParam)?(res.warning="The eth_personalSign method requires params ordered [message, address]. This was previously handled incorrectly, and has been corrected automatically. Please switch this param order for smooth behavior in the future.",address=firstParam,message=secondParam):(message=firstParam,address=secondParam),_context10.next=8,validateAndNormalizeKeyholder(address,req);case 8:return address=_context10.sent,msgParams=_objectSpread$5(_objectSpread$5({},extraParams),{},{from:address,data:message}),_context10.next=12,processPersonalMessage(msgParams,req);case 12:res.result=_context10.sent;case 13:case"end":return _context10.stop()}},_callee10)}))).apply(this,arguments)}function _encryptionPublicKey(){return(_encryptionPublicKey=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee11(req,res){var address;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context11){for(;;)switch(_context11.prev=_context11.next){case 0:if(processEncryptionPublicKey){_context11.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.rpc.methodNotSupported();case 2:return _context11.next=4,validateAndNormalizeKeyholder(req.params[0],req);case 4:return address=_context11.sent,_context11.next=7,processEncryptionPublicKey(address,req);case 7:res.result=_context11.sent;case 8:case"end":return _context11.stop()}},_callee11)}))).apply(this,arguments)}function _decryptMessage(){return(_decryptMessage=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee12(req,res){var ciphertext,address,msgParams;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context12){for(;;)switch(_context12.prev=_context12.next){case 0:if(processDecryptMessage){_context12.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.rpc.methodNotSupported();case 2:return ciphertext=req.params[0],_context12.next=5,validateAndNormalizeKeyholder(req.params[1],req);case 5:address=_context12.sent,msgParams=_objectSpread$5(_objectSpread$5({},req.params[2]||{}),{},{from:address,data:ciphertext}),res.result=processDecryptMessage(msgParams,req);case 9:case"end":return _context12.stop()}},_callee12)}))).apply(this,arguments)}function _fetchPrivateKey(){return(_fetchPrivateKey=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee13(req,res){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context13){for(;;)switch(_context13.prev=_context13.next){case 0:if(getPrivateKey){_context13.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.rpc.methodNotSupported();case 2:res.result=getPrivateKey(req);case 3:case"end":return _context13.stop()}},_callee13)}))).apply(this,arguments)}return(0,_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.v0)({eth_accounts:(0,_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.Pk)(function(_x3,_x4){return _lookupAccounts.apply(this,arguments)}),eth_private_key:(0,_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.Pk)(function(_x25,_x26){return _fetchPrivateKey.apply(this,arguments)}),eth_coinbase:(0,_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.Pk)(function(_x5,_x6){return _lookupDefaultAccount.apply(this,arguments)}),eth_sendTransaction:(0,_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.Pk)(function(_x7,_x8){return _sendTransaction.apply(this,arguments)}),eth_signTransaction:(0,_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.Pk)(function(_x9,_x10){return _signTransaction.apply(this,arguments)}),eth_sign:(0,_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.Pk)(function(_x11,_x12){return _ethSign.apply(this,arguments)}),eth_signTypedData:(0,_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.Pk)(function(_x13,_x14){return _signTypedData.apply(this,arguments)}),eth_signTypedData_v3:(0,_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.Pk)(function(_x15,_x16){return _signTypedDataV.apply(this,arguments)}),eth_signTypedData_v4:(0,_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.Pk)(function(_x17,_x18){return _signTypedDataV2.apply(this,arguments)}),personal_sign:(0,_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.Pk)(function(_x19,_x20){return _personalSign.apply(this,arguments)}),eth_getEncryptionPublicKey:(0,_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.Pk)(function(_x21,_x22){return _encryptionPublicKey.apply(this,arguments)}),eth_decrypt:(0,_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.Pk)(function(_x23,_x24){return _decryptMessage.apply(this,arguments)})})}({getAccounts:getAccounts,getPrivateKey:getPrivateKey,processTransaction:processTransaction,processEthSignMessage:processEthSignMessage,processSignTransaction:processSignTransaction,processTypedMessage:processTypedMessage,processTypedMessageV3:processTypedMessageV3,processTypedMessageV4:processTypedMessageV4,processPersonalMessage:processPersonalMessage,processEncryptionPublicKey:processEncryptionPublicKey,processDecryptMessage:processDecryptMessage})])}function createJsonRpcClient(providerConfig){var chainId=providerConfig.chainId,rpcTarget=providerConfig.rpcTarget,fetchMiddleware=(0,_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_1__.v$)({rpcTarget:rpcTarget});return{networkMiddleware:(0,_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.UZ)([function(req,res,next,end){return"eth_chainId"===req.method?(res.result=chainId,end()):next()},function(req,res,next,end){return"eth_provider_config"===req.method?(res.result=providerConfig,end()):next()},fetchMiddleware]),fetchMiddleware:fetchMiddleware}}function ownKeys$4(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _objectSpread$4(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys$4(Object(source),!0).forEach(function(key){(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_14__.Z)(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys$4(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}var WalletConnectProvider=function(_BaseProvider){(0,_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_18__.Z)(WalletConnectProvider,_BaseProvider);var hasNativeReflectConstruct,_enable,_setupProvider,_switchChain,_addChain,_lookupNetwork,_setupEngine,_onConnectorStateUpdate,_super=(hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var result,Super=(0,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_16__.Z)(WalletConnectProvider);if(hasNativeReflectConstruct){var NewTarget=(0,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_16__.Z)(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return(0,_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_17__.Z)(this,result)});function WalletConnectProvider(_ref){var _this,config=_ref.config,state=_ref.state,connector=_ref.connector;return(0,_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_19__.Z)(this,WalletConnectProvider),_this=_super.call(this,{config:{chainConfig:_objectSpread$4(_objectSpread$4({},config.chainConfig),{},{chainNamespace:_web3auth_base__WEBPACK_IMPORTED_MODULE_3__.EN.EIP155}),skipLookupNetwork:!!config.skipLookupNetwork},state:_objectSpread$4(_objectSpread$4({},state||{}),{},{chainId:"loading",accounts:[]})}),(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_14__.Z)((0,_babel_runtime_helpers_assertThisInitialized__WEBPACK_IMPORTED_MODULE_20__.Z)(_this),"connector",null),_this.connector=connector||null,_this}return(0,_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_21__.Z)(WalletConnectProvider,[{key:"enable",value:(_enable=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee(){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(this.connector){_context.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.provider.custom({message:"Connector is not initialized, pass wallet connect connector in constructor",code:4902});case 2:return _context.next=4,this.setupProvider(this.connector);case 4:return _context.abrupt("return",this._providerEngineProxy.request({method:"eth_accounts"}));case 5:case"end":return _context.stop()}},_callee,this)})),function(){return _enable.apply(this,arguments)})},{key:"setupProvider",value:(_setupProvider=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee2(connector){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return this.onConnectorStateUpdate(connector),_context2.next=3,this.setupEngine(connector);case 3:case"end":return _context2.stop()}},_callee2,this)})),function(_x){return _setupProvider.apply(this,arguments)})},{key:"switchChain",value:(_switchChain=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee3(_ref2){var chainId,_ref2$addChain,addChain,_ref2$lookup,lookup,currentChainConfig,rpcTarget,displayName;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(chainId=_ref2.chainId,addChain=void 0===(_ref2$addChain=_ref2.addChain)||_ref2$addChain,lookup=void 0===(_ref2$lookup=_ref2.lookup)||_ref2$lookup,this.connector){_context3.next=3;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.provider.custom({message:"Connector is not initialized, pass wallet connect connector in constructor",code:4902});case 3:if(currentChainConfig=this.getChainConfig(chainId),this.update({chainId:"loading"}),rpcTarget=currentChainConfig.rpcTarget,displayName=currentChainConfig.displayName,!addChain){_context3.next=15;break}return _context3.prev=7,_context3.next=10,this.connector.sendCustomRequest({method:"wallet_addEthereumChain",params:[{chainId:chainId,chainName:displayName,rpcUrls:[rpcTarget]}]});case 10:_context3.next=15;break;case 12:_context3.prev=12,_context3.t0=_context3.catch(7),_web3auth_base__WEBPACK_IMPORTED_MODULE_3__.cM.error(_context3.t0);case 15:return _context3.prev=15,_context3.next=18,this.connector.sendCustomRequest({method:"wallet_switchEthereumChain",params:[{chainId:chainId}]});case 18:_context3.next=25;break;case 20:if(_context3.prev=20,_context3.t1=_context3.catch(15),_web3auth_base__WEBPACK_IMPORTED_MODULE_3__.cM.error(_context3.t1),!("JSON RPC response format is invalid"!==_context3.t1.message)){_context3.next=25;break}throw _context3.t1;case 25:if(this.configure({chainConfig:currentChainConfig}),!lookup){_context3.next=29;break}return _context3.next=29,this.lookupNetwork(this.connector);case 29:case"end":return _context3.stop()}},_callee3,this,[[7,12],[15,20]])})),function(_x2){return _switchChain.apply(this,arguments)})},{key:"addChain",value:(_addChain=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee4(chainConfig){var rpcTarget,displayName;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if(this.connector){_context4.next=2;break}throw _web3auth_base__WEBPACK_IMPORTED_MODULE_3__.Ty.notReady("Wallet adapter is not ready yet");case 2:return rpcTarget=chainConfig.rpcTarget,displayName=chainConfig.displayName,_context4.prev=3,_context4.next=6,this.connector.sendCustomRequest({method:"wallet_addEthereumChain",params:[{chainId:chainConfig.chainId,chainName:displayName,rpcUrls:[rpcTarget]}]});case 6:(0,_babel_runtime_helpers_get__WEBPACK_IMPORTED_MODULE_22__.Z)((0,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_16__.Z)(WalletConnectProvider.prototype),"addChain",this).call(this,chainConfig),_context4.next=13;break;case 9:throw _context4.prev=9,_context4.t0=_context4.catch(3),_web3auth_base__WEBPACK_IMPORTED_MODULE_3__.cM.error(_context4.t0),_context4.t0;case 13:case"end":return _context4.stop()}},_callee4,this,[[3,9]])})),function(_x3){return _addChain.apply(this,arguments)})},{key:"lookupNetwork",value:(_lookupNetwork=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee5(connector){var chainId,connectedHexChainId;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:if(connector.connected){_context5.next=2;break}throw _web3auth_base__WEBPACK_IMPORTED_MODULE_3__.RM.notConnectedError("Wallet connect connector is not connected");case 2:if(this.provider){_context5.next=4;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 4:if(!((chainId=this.config.chainConfig.chainId)!==(connectedHexChainId=(0,_web3auth_base__WEBPACK_IMPORTED_MODULE_3__.H2)(connector.chainId.toString())?connector.chainId:"0x".concat(connector.chainId.toString(16))))){_context5.next=8;break}throw _web3auth_base__WEBPACK_IMPORTED_MODULE_3__.Ty.rpcConnectionError("Invalid network, net_version is: ".concat(connectedHexChainId,", expected: ").concat(chainId));case 8:return this.provider.emit("connect",{chainId:chainId}),this.provider.emit("chainChanged",this.state.chainId),_context5.abrupt("return",connectedHexChainId);case 11:case"end":return _context5.stop()}},_callee5,this)})),function(_x4){return _lookupNetwork.apply(this,arguments)})},{key:"setupEngine",value:(_setupEngine=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee6(connector){var providerHandlers,ethMiddleware,engine,networkMiddleware,provider;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:if(providerHandlers=function(_ref){var _getPrivateKey,_getAccounts,_processTransaction,_processSignTransaction,_processEthSignMessage,_processPersonalMessage,_processTypedMessage,_processTypedMessageV,_processTypedMessageV2,_processEncryptionPublicKey,connector=_ref.connector;return{getPrivateKey:(_getPrivateKey=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee(){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.rpc.methodNotSupported();case 1:case"end":return _context.stop()}},_callee)})),function(){return _getPrivateKey.apply(this,arguments)}),getAccounts:(_getAccounts=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee2(_){var accounts;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(!((accounts=connector.accounts)&&accounts.length)){_context2.next=3;break}return _context2.abrupt("return",accounts);case 3:throw Error("Failed to get accounts");case 4:case"end":return _context2.stop()}},_callee2)})),function(_x){return _getAccounts.apply(this,arguments)}),processTransaction:(_processTransaction=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee3(txParams,_){var result;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,connector.sendTransaction(txParams);case 2:return result=_context3.sent,_context3.abrupt("return",result);case 4:case"end":return _context3.stop()}},_callee3)})),function(_x2,_x3){return _processTransaction.apply(this,arguments)}),processSignTransaction:(_processSignTransaction=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee4(txParams,_){var result;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,connector.signTransaction(txParams);case 2:return result=_context4.sent,_context4.abrupt("return",result);case 4:case"end":return _context4.stop()}},_callee4)})),function(_x4,_x5){return _processSignTransaction.apply(this,arguments)}),processEthSignMessage:(_processEthSignMessage=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee5(msgParams,_){var result;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,connector.signMessage([msgParams.from,msgParams.data]);case 2:return result=_context5.sent,_context5.abrupt("return",result);case 4:case"end":return _context5.stop()}},_callee5)})),function(_x6,_x7){return _processEthSignMessage.apply(this,arguments)}),processPersonalMessage:(_processPersonalMessage=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee6(msgParams,_){var result;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return _context6.next=2,connector.signPersonalMessage([msgParams.data,msgParams.from]);case 2:return result=_context6.sent,_context6.abrupt("return",result);case 4:case"end":return _context6.stop()}},_callee6)})),function(_x8,_x9){return _processPersonalMessage.apply(this,arguments)}),processTypedMessage:(_processTypedMessage=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee7(msgParams,_){var result;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return _context7.next=2,connector.signTypedData([msgParams.from,msgParams.data]);case 2:return result=_context7.sent,_context7.abrupt("return",result);case 4:case"end":return _context7.stop()}},_callee7)})),function(_x10,_x11){return _processTypedMessage.apply(this,arguments)}),processTypedMessageV3:(_processTypedMessageV=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee8(msgParams){var result;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return _context8.next=2,connector.signTypedData([msgParams.from,msgParams.data]);case 2:return result=_context8.sent,_context8.abrupt("return",result);case 4:case"end":return _context8.stop()}},_callee8)})),function(_x12){return _processTypedMessageV.apply(this,arguments)}),processTypedMessageV4:(_processTypedMessageV2=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee9(msgParams){var result;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:return _context9.next=2,connector.signTypedData([msgParams.from,msgParams.data]);case 2:return result=_context9.sent,_context9.abrupt("return",result);case 4:case"end":return _context9.stop()}},_callee9)})),function(_x13){return _processTypedMessageV2.apply(this,arguments)}),processEncryptionPublicKey:(_processEncryptionPublicKey=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee10(_){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context10){for(;;)switch(_context10.prev=_context10.next){case 0:throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.rpc.methodNotSupported();case 1:case"end":return _context10.stop()}},_callee10)})),function(_x14){return _processEncryptionPublicKey.apply(this,arguments)}),processDecryptMessage:function(_){throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.rpc.methodNotSupported()}}}({connector:connector}),this.update({accounts:connector.accounts||[]}),ethMiddleware=createEthMiddleware(providerHandlers),engine=new _toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.eI,networkMiddleware=createJsonRpcClient(this.config.chainConfig).networkMiddleware,engine.push(ethMiddleware),engine.push(networkMiddleware),provider=(0,_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_1__.Xj)(engine),this.updateProviderEngineProxy(provider),this.config.skipLookupNetwork){_context6.next=12;break}return _context6.next=12,this.lookupNetwork(connector);case 12:case"end":return _context6.stop()}},_callee6,this)})),function(_x5){return _setupEngine.apply(this,arguments)})},{key:"onConnectorStateUpdate",value:(_onConnectorStateUpdate=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee8(connector){var _this2=this;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:connector.on("session_update",function(){var _ref3=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee7(error,payload){var _payload$params$,accounts,connectedChainId,rpcUrl,connectedHexChainId,maybeConfig;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:if(_this2.provider){_context7.next=2;break}throw _web3auth_base__WEBPACK_IMPORTED_MODULE_3__.RM.notConnectedError("Wallet connect connector is not connected");case 2:if(!error){_context7.next=5;break}return _this2.provider.emit("error",error),_context7.abrupt("return");case 5:if(accounts=(_payload$params$=payload.params[0]).accounts,connectedChainId=_payload$params$.chainId,rpcUrl=_payload$params$.rpcUrl,null!=accounts&&accounts.length&&_this2.state.accounts[0]!==accounts[0]&&(_this2.update({accounts:accounts}),_this2.provider.emit("accountsChanged",accounts)),connectedHexChainId="0x".concat(connectedChainId.toString(16)),!(connectedChainId&&_this2.state.chainId!==connectedHexChainId)){_context7.next=13;break}return maybeConfig=(0,_web3auth_base__WEBPACK_IMPORTED_MODULE_3__.h2)(_web3auth_base__WEBPACK_IMPORTED_MODULE_3__.EN.EIP155,connectedChainId)||{},_this2.configure({chainConfig:_objectSpread$4(_objectSpread$4({},maybeConfig),{},{chainId:connectedHexChainId,rpcTarget:rpcUrl,chainNamespace:_web3auth_base__WEBPACK_IMPORTED_MODULE_3__.EN.EIP155})}),_context7.next=13,_this2.setupEngine(connector);case 13:case"end":return _context7.stop()}},_callee7)}));return function(_x7,_x8){return _ref3.apply(this,arguments)}}());case 1:case"end":return _context8.stop()}},_callee8)})),function(_x6){return _onConnectorStateUpdate.apply(this,arguments)})}]),WalletConnectProvider}(_web3auth_base_provider__WEBPACK_IMPORTED_MODULE_4__.Zk);(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_14__.Z)(WalletConnectProvider,"getProviderInstance",(_ref4=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee9(params){var providerFactory;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:return providerFactory=new WalletConnectProvider({config:{chainConfig:params.chainConfig,skipLookupNetwork:params.skipLookupNetwork}}),_context9.next=3,providerFactory.setupProvider(params.connector);case 3:return _context9.abrupt("return",providerFactory);case 4:case"end":return _context9.stop()}},_callee9)})),function(_x9){return _ref4.apply(this,arguments)}));var BIG_NUMBER_WEI_MULTIPLIER=new bignumber_js__WEBPACK_IMPORTED_MODULE_12__.Z("1e18"),BIG_NUMBER_GWEI_MULTIPLIER=new bignumber_js__WEBPACK_IMPORTED_MODULE_12__.Z("1e9"),BIG_NUMBER_ETH_MULTIPLIER=new bignumber_js__WEBPACK_IMPORTED_MODULE_12__.Z("1"),toBigNumber={hex:function(n){return"string"==typeof n?new bignumber_js__WEBPACK_IMPORTED_MODULE_12__.Z((0,ethereumjs_util__WEBPACK_IMPORTED_MODULE_8__.stripHexPrefix)(n),16):new bignumber_js__WEBPACK_IMPORTED_MODULE_12__.Z(n,16)},dec:function(n){return new bignumber_js__WEBPACK_IMPORTED_MODULE_12__.Z(n,10)}},toNormalizedDenomination={WEI:function(bigNumber){return bigNumber.div(BIG_NUMBER_WEI_MULTIPLIER)},GWEI:function(bigNumber){return bigNumber.div(BIG_NUMBER_GWEI_MULTIPLIER)},ETH:function(bigNumber){return bigNumber.div(BIG_NUMBER_ETH_MULTIPLIER)}},toSpecifiedDenomination={WEI:function(bigNumber){return bigNumber.times(BIG_NUMBER_WEI_MULTIPLIER).dp(0,bignumber_js__WEBPACK_IMPORTED_MODULE_12__.Z.ROUND_HALF_UP)},GWEI:function(bigNumber){return bigNumber.times(BIG_NUMBER_GWEI_MULTIPLIER).dp(9,bignumber_js__WEBPACK_IMPORTED_MODULE_12__.Z.ROUND_HALF_UP)},ETH:function(bigNumber){return bigNumber.times(BIG_NUMBER_ETH_MULTIPLIER).dp(9,bignumber_js__WEBPACK_IMPORTED_MODULE_12__.Z.ROUND_HALF_UP)}},baseChange={hex:function(n){return n.toString(16)},dec:function(n){return new bignumber_js__WEBPACK_IMPORTED_MODULE_12__.Z(n).toString(10)}},converter=function(params){var value=params.value,fromNumericBase=params.fromNumericBase,fromDenomination=params.fromDenomination,toNumericBase=params.toNumericBase,toDenomination=params.toDenomination,numberOfDecimals=params.numberOfDecimals,convertedValue=toBigNumber[fromNumericBase](value);return fromDenomination&&(convertedValue=toNormalizedDenomination[fromDenomination](convertedValue)),toDenomination&&(convertedValue=toSpecifiedDenomination[toDenomination](convertedValue)),numberOfDecimals&&(convertedValue=convertedValue.dp(numberOfDecimals,bignumber_js__WEBPACK_IMPORTED_MODULE_12__.Z.ROUND_HALF_DOWN)),toNumericBase&&(convertedValue=baseChange[toNumericBase](convertedValue)),convertedValue},conversionUtil=function(value,_ref){var _ref$fromNumericBase=_ref.fromNumericBase;return converter({fromNumericBase:void 0===_ref$fromNumericBase?"hex":_ref$fromNumericBase,toNumericBase:_ref.toNumericBase,fromDenomination:_ref.fromDenomination,toDenomination:_ref.toDenomination,numberOfDecimals:_ref.numberOfDecimals,value:value||"0"})};function decGWEIToHexWEI(decGWEI){return conversionUtil(decGWEI,{fromNumericBase:"dec",toNumericBase:"hex",fromDenomination:"GWEI",toDenomination:"WEI"})}function hexWEIToDecGWEI(decGWEI){return conversionUtil(decGWEI,{fromNumericBase:"hex",toNumericBase:"dec",fromDenomination:"WEI",toDenomination:"GWEI"})}function ownKeys$3(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _objectSpread$3(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys$3(Object(source),!0).forEach(function(key){(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_14__.Z)(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys$3(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}function normalizeGWEIDecimalNumbers(n){return hexWEIToDecGWEI(decGWEIToHexWEI(n))}function _fetchEip1159GasEstimates(){return(_fetchEip1159GasEstimates=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee(url){var estimates,normalizedEstimates;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,(0,_toruslabs_http_helpers__WEBPACK_IMPORTED_MODULE_9__.U2)(url);case 2:return normalizedEstimates=_objectSpread$3(_objectSpread$3({},estimates=_context.sent),{},{estimatedBaseFee:normalizeGWEIDecimalNumbers(estimates.estimatedBaseFee),low:_objectSpread$3(_objectSpread$3({},estimates.low),{},{suggestedMaxPriorityFeePerGas:normalizeGWEIDecimalNumbers(estimates.low.suggestedMaxPriorityFeePerGas),suggestedMaxFeePerGas:normalizeGWEIDecimalNumbers(estimates.low.suggestedMaxFeePerGas)}),medium:_objectSpread$3(_objectSpread$3({},estimates.medium),{},{suggestedMaxPriorityFeePerGas:normalizeGWEIDecimalNumbers(estimates.medium.suggestedMaxPriorityFeePerGas),suggestedMaxFeePerGas:normalizeGWEIDecimalNumbers(estimates.medium.suggestedMaxFeePerGas)}),high:_objectSpread$3(_objectSpread$3({},estimates.high),{},{suggestedMaxPriorityFeePerGas:normalizeGWEIDecimalNumbers(estimates.high.suggestedMaxPriorityFeePerGas),suggestedMaxFeePerGas:normalizeGWEIDecimalNumbers(estimates.high.suggestedMaxFeePerGas)})}),_context.abrupt("return",normalizedEstimates);case 5:case"end":return _context.stop()}},_callee)}))).apply(this,arguments)}function _fetchLegacyGasPriceEstimates(){return(_fetchLegacyGasPriceEstimates=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee2(url){var result;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.next=2,(0,_toruslabs_http_helpers__WEBPACK_IMPORTED_MODULE_9__.U2)(url,{referrer:url,referrerPolicy:"no-referrer-when-downgrade",method:"GET",mode:"cors"});case 2:return result=_context2.sent,_context2.abrupt("return",{low:result.SafeGasPrice,medium:result.ProposeGasPrice,high:result.FastGasPrice});case 4:case"end":return _context2.stop()}},_callee2)}))).apply(this,arguments)}var validateTypedMessageParams=function(parameters,activeChainId){var _data$domain;try{assert__WEBPACK_IMPORTED_MODULE_10___default().ok(parameters&&"object"===(0,_babel_runtime_helpers_typeof__WEBPACK_IMPORTED_MODULE_23__.Z)(parameters),"Params must be an object."),assert__WEBPACK_IMPORTED_MODULE_10___default().ok("data"in parameters,'Params must include a "data" field.'),assert__WEBPACK_IMPORTED_MODULE_10___default().ok("from"in parameters,'Params must include a "from" field.'),assert__WEBPACK_IMPORTED_MODULE_10___default().ok("string"==typeof parameters.from&&(0,ethereumjs_util__WEBPACK_IMPORTED_MODULE_8__.isValidAddress)(parameters.from),'"from" field must be a valid, lowercase, hexadecimal Ethereum address string.');var data=null,chainId=null;switch(parameters.version){case _metamask_eth_sig_util__WEBPACK_IMPORTED_MODULE_7__.SignTypedDataVersion.V1:"string"==typeof parameters.data?assert__WEBPACK_IMPORTED_MODULE_10___default().doesNotThrow(function(){data=JSON.parse(parameters.data)},'"data" must be a valid JSON string.'):data=parameters.data,assert__WEBPACK_IMPORTED_MODULE_10___default().ok(Array.isArray(data),"params.data must be an array."),assert__WEBPACK_IMPORTED_MODULE_10___default().doesNotThrow(function(){(0,_metamask_eth_sig_util__WEBPACK_IMPORTED_MODULE_7__.typedSignatureHash)(data)},"Signing data must be valid EIP-712 typed data.");break;case _metamask_eth_sig_util__WEBPACK_IMPORTED_MODULE_7__.SignTypedDataVersion.V3:case _metamask_eth_sig_util__WEBPACK_IMPORTED_MODULE_7__.SignTypedDataVersion.V4:"string"==typeof parameters.data?assert__WEBPACK_IMPORTED_MODULE_10___default().doesNotThrow(function(){data=JSON.parse(parameters.data)},'"data" must be a valid JSON string.'):data=parameters.data,assert__WEBPACK_IMPORTED_MODULE_10___default().ok(data.primaryType in data.types,'Primary type of "'.concat(data.primaryType,'" has no type definition.'));var validation=jsonschema__WEBPACK_IMPORTED_MODULE_11__.validate(data,_metamask_eth_sig_util__WEBPACK_IMPORTED_MODULE_7__.TYPED_MESSAGE_SCHEMA.properties);assert__WEBPACK_IMPORTED_MODULE_10___default().strictEqual(validation.errors.length,0,"Signing data must conform to EIP-712 schema. See https://git.io/fNtcx."),(chainId=null===(_data$domain=data.domain)||void 0===_data$domain?void 0:_data$domain.chainId)&&(assert__WEBPACK_IMPORTED_MODULE_10___default().ok(!Number.isNaN(activeChainId),'Cannot sign messages for chainId "'.concat(chainId,'", because Web3Auth is switching networks.')),"string"==typeof chainId&&(chainId=Number.parseInt(chainId,(0,_web3auth_base__WEBPACK_IMPORTED_MODULE_3__.H2)(chainId)?16:10)),assert__WEBPACK_IMPORTED_MODULE_10___default().strictEqual(chainId,activeChainId,'Provided chainId "'.concat(chainId,'" must match the active chainId "').concat(activeChainId,'"')));break;default:assert__WEBPACK_IMPORTED_MODULE_10___default().fail('Unknown typed data version "'.concat(parameters.version,'"'))}}catch(error){throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.rpc.invalidInput({message:null==error?void 0:error.message})}};function ownKeys$2(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _objectSpread$2(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys$2(Object(source),!0).forEach(function(key){(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_14__.Z)(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys$2(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}function signTx(_x,_x2,_x3){return _signTx.apply(this,arguments)}function _signTx(){return(_signTx=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee11(txParams,privKey,txFormatter){var finalTxParams,common,signedTx;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context11){for(;;)switch(_context11.prev=_context11.next){case 0:return _context11.next=2,txFormatter.formatTransaction(txParams);case 2:return finalTxParams=_context11.sent,_context11.next=5,txFormatter.getCommonConfiguration();case 5:return common=_context11.sent,signedTx=_ethereumjs_tx__WEBPACK_IMPORTED_MODULE_6__.TransactionFactory.fromTxData(finalTxParams,{common:common}).sign(Buffer.from(privKey,"hex")).serialize(),_context11.abrupt("return",signedTx);case 9:case"end":return _context11.stop()}},_callee11)}))).apply(this,arguments)}function getProviderHandlers(_ref){var _getAccounts,_getPrivateKey,_processTransaction,_processSignTransaction,_processEthSignMessage,_processPersonalMessage,_processTypedMessage,_processTypedMessageV,_processTypedMessageV2,_processEncryptionPublicKey,txFormatter=_ref.txFormatter,privKey=_ref.privKey,getProviderEngineProxy=_ref.getProviderEngineProxy;return{getAccounts:(_getAccounts=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee(_){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.abrupt("return",["0x".concat((0,ethereumjs_util__WEBPACK_IMPORTED_MODULE_8__.privateToAddress)(Buffer.from(privKey,"hex")).toString("hex"))]);case 1:case"end":return _context.stop()}},_callee)})),function(_x4){return _getAccounts.apply(this,arguments)}),getPrivateKey:(_getPrivateKey=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee2(_){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return _context2.abrupt("return",privKey);case 1:case"end":return _context2.stop()}},_callee2)})),function(_x5){return _getPrivateKey.apply(this,arguments)}),processTransaction:(_processTransaction=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee3(txParams,_){var providerEngineProxy,signedTx,txHash;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(providerEngineProxy=getProviderEngineProxy()){_context3.next=3;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 3:return _context3.next=5,signTx(txParams,privKey,txFormatter);case 5:return signedTx=_context3.sent,_context3.next=8,providerEngineProxy.request({method:"eth_sendRawTransaction",params:["0x".concat(signedTx.toString("hex"))]});case 8:return txHash=_context3.sent,_context3.abrupt("return",txHash);case 10:case"end":return _context3.stop()}},_callee3)})),function(_x6,_x7){return _processTransaction.apply(this,arguments)}),processSignTransaction:(_processSignTransaction=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee4(txParams,_){var signedTx;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if(getProviderEngineProxy()){_context4.next=3;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 3:return _context4.next=5,signTx(txParams,privKey,txFormatter);case 5:return signedTx=_context4.sent,_context4.abrupt("return","0x".concat(signedTx.toString("hex")));case 7:case"end":return _context4.stop()}},_callee4)})),function(_x8,_x9){return _processSignTransaction.apply(this,arguments)}),processEthSignMessage:(_processEthSignMessage=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee5(msgParams,_){var rawMessageSig;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return rawMessageSig=(0,_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_1__.l)(privKey,msgParams.data),_context5.abrupt("return",rawMessageSig);case 2:case"end":return _context5.stop()}},_callee5)})),function(_x10,_x11){return _processEthSignMessage.apply(this,arguments)}),processPersonalMessage:(_processPersonalMessage=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee6(msgParams,_){var privKeyBuffer,sig;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:return privKeyBuffer=Buffer.from(privKey,"hex"),sig=(0,_metamask_eth_sig_util__WEBPACK_IMPORTED_MODULE_7__.personalSign)({privateKey:privKeyBuffer,data:msgParams.data}),_context6.abrupt("return",sig);case 3:case"end":return _context6.stop()}},_callee6)})),function(_x12,_x13){return _processPersonalMessage.apply(this,arguments)}),processTypedMessage:(_processTypedMessage=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee7(msgParams,_){var privKeyBuffer,providerEngineProxy,chainId,finalChainId,params,data,sig;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:if(_web3auth_base__WEBPACK_IMPORTED_MODULE_3__.cM.debug("processTypedMessage",msgParams),privKeyBuffer=Buffer.from(privKey,"hex"),providerEngineProxy=getProviderEngineProxy()){_context7.next=5;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 5:return _context7.next=7,providerEngineProxy.request({method:"eth_chainId"});case 7:return finalChainId=Number.parseInt(chainId=_context7.sent,(0,_web3auth_base__WEBPACK_IMPORTED_MODULE_3__.H2)(chainId)?16:10),validateTypedMessageParams(params=_objectSpread$2(_objectSpread$2({},msgParams),{},{version:_metamask_eth_sig_util__WEBPACK_IMPORTED_MODULE_7__.SignTypedDataVersion.V1}),finalChainId),data="string"==typeof params.data?JSON.parse(params.data):params.data,sig=(0,_metamask_eth_sig_util__WEBPACK_IMPORTED_MODULE_7__.signTypedData)({privateKey:privKeyBuffer,data:data,version:_metamask_eth_sig_util__WEBPACK_IMPORTED_MODULE_7__.SignTypedDataVersion.V1}),_context7.abrupt("return",sig);case 14:case"end":return _context7.stop()}},_callee7)})),function(_x14,_x15){return _processTypedMessage.apply(this,arguments)}),processTypedMessageV3:(_processTypedMessageV=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee8(msgParams,_){var privKeyBuffer,providerEngineProxy,chainId,data,sig;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:if(_web3auth_base__WEBPACK_IMPORTED_MODULE_3__.cM.debug("processTypedMessageV3",msgParams),privKeyBuffer=Buffer.from(privKey,"hex"),providerEngineProxy=getProviderEngineProxy()){_context8.next=5;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 5:return _context8.next=7,providerEngineProxy.request({method:"eth_chainId"});case 7:return validateTypedMessageParams(msgParams,Number.parseInt(chainId=_context8.sent,(0,_web3auth_base__WEBPACK_IMPORTED_MODULE_3__.H2)(chainId)?16:10)),data="string"==typeof msgParams.data?JSON.parse(msgParams.data):msgParams.data,sig=(0,_metamask_eth_sig_util__WEBPACK_IMPORTED_MODULE_7__.signTypedData)({privateKey:privKeyBuffer,data:data,version:_metamask_eth_sig_util__WEBPACK_IMPORTED_MODULE_7__.SignTypedDataVersion.V3}),_context8.abrupt("return",sig);case 13:case"end":return _context8.stop()}},_callee8)})),function(_x16,_x17){return _processTypedMessageV.apply(this,arguments)}),processTypedMessageV4:(_processTypedMessageV2=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee9(msgParams,_){var privKeyBuffer,providerEngineProxy,chainId,data,sig;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:if(_web3auth_base__WEBPACK_IMPORTED_MODULE_3__.cM.debug("processTypedMessageV4",msgParams),privKeyBuffer=Buffer.from(privKey,"hex"),providerEngineProxy=getProviderEngineProxy()){_context9.next=5;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 5:return _context9.next=7,providerEngineProxy.request({method:"eth_chainId"});case 7:return validateTypedMessageParams(msgParams,Number.parseInt(chainId=_context9.sent,(0,_web3auth_base__WEBPACK_IMPORTED_MODULE_3__.H2)(chainId)?16:10)),data="string"==typeof msgParams.data?JSON.parse(msgParams.data):msgParams.data,sig=(0,_metamask_eth_sig_util__WEBPACK_IMPORTED_MODULE_7__.signTypedData)({privateKey:privKeyBuffer,data:data,version:_metamask_eth_sig_util__WEBPACK_IMPORTED_MODULE_7__.SignTypedDataVersion.V4}),_context9.abrupt("return",sig);case 13:case"end":return _context9.stop()}},_callee9)})),function(_x18,_x19){return _processTypedMessageV2.apply(this,arguments)}),processEncryptionPublicKey:(_processEncryptionPublicKey=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee10(address,_){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context10){for(;;)switch(_context10.prev=_context10.next){case 0:return _web3auth_base__WEBPACK_IMPORTED_MODULE_3__.cM.info("processEncryptionPublicKey",address),_context10.abrupt("return",(0,_metamask_eth_sig_util__WEBPACK_IMPORTED_MODULE_7__.getEncryptionPublicKey)(privKey));case 2:case"end":return _context10.stop()}},_callee10)})),function(_x20,_x21){return _processEncryptionPublicKey.apply(this,arguments)}),processDecryptMessage:function(msgParams,_){_web3auth_base__WEBPACK_IMPORTED_MODULE_3__.cM.info("processDecryptMessage",msgParams);var stripped=(0,ethereumjs_util__WEBPACK_IMPORTED_MODULE_8__.stripHexPrefix)(msgParams.data),buff=Buffer.from(stripped,"hex");return(0,_metamask_eth_sig_util__WEBPACK_IMPORTED_MODULE_7__.decrypt)({encryptedData:JSON.parse(buff.toString("utf8")),privateKey:privKey})}}}function bnToHex(inputBn){return(0,ethereumjs_util__WEBPACK_IMPORTED_MODULE_8__.addHexPrefix)(inputBn.toString(16))}function hexToBn(inputHex){return ethereumjs_util__WEBPACK_IMPORTED_MODULE_8__.BN.isBN(inputHex)?inputHex:new ethereumjs_util__WEBPACK_IMPORTED_MODULE_8__.BN((0,ethereumjs_util__WEBPACK_IMPORTED_MODULE_8__.stripHexPrefix)(inputHex),16)}var TRANSACTION_ENVELOPE_TYPES={LEGACY:"0x0",ACCESS_LIST:"0x1",FEE_MARKET:"0x2"},TRANSACTION_TYPES={SENT_ETHER:"sentEther",CONTRACT_INTERACTION:"contractInteraction",DEPLOY_CONTRACT:"contractDeployment",STANDARD_TRANSACTION:"transaction"},GAS_ESTIMATE_TYPES={FEE_MARKET:"fee-market",LEGACY:"legacy",ETH_GASPRICE:"eth_gasPrice",NONE:"none"};function ownKeys$1(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _objectSpread$1(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys$1(Object(source),!0).forEach(function(key){(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_14__.Z)(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys$1(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}var TransactionFormatter=function(){var _init,_getCommonConfiguration,_formatTransaction,_fetchEthGasPriceEstimate,_getEIP1559Compatibility,_fetchGasFeeEstimateData,_getDefaultGasFees,_estimateTxGas,_analyzeGasUsage,_determineTransactionCategory,_getDefaultGasLimit;function TransactionFormatter(_ref){var getProviderEngineProxy=_ref.getProviderEngineProxy;(0,_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_19__.Z)(this,TransactionFormatter),(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_14__.Z)(this,"chainConfig",null),(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_14__.Z)(this,"getProviderEngineProxy",void 0),(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_14__.Z)(this,"isEIP1559Compatible",!1),this.getProviderEngineProxy=getProviderEngineProxy}return(0,_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_21__.Z)(TransactionFormatter,[{key:"providerProxy",get:function(){return this.getProviderEngineProxy()}},{key:"init",value:(_init=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee(){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:return _context.next=2,this.providerProxy.request({method:"eth_provider_config",params:[]});case 2:return this.chainConfig=_context.sent,_context.next=5,this.getEIP1559Compatibility();case 5:this.isEIP1559Compatible=_context.sent;case 6:case"end":return _context.stop()}},_callee,this)})),function(){return _init.apply(this,arguments)})},{key:"getCommonConfiguration",value:(_getCommonConfiguration=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee2(){var _this$chainConfig,name,chainId,hardfork,customChainParams;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(this.chainConfig){_context2.next=2;break}throw Error("Chain config not initialized");case 2:return name=(_this$chainConfig=this.chainConfig).displayName,chainId=_this$chainConfig.chainId,hardfork=this.isEIP1559Compatible?_ethereumjs_common__WEBPACK_IMPORTED_MODULE_13__.Hardfork.London:_ethereumjs_common__WEBPACK_IMPORTED_MODULE_13__.Hardfork.Berlin,customChainParams={name:name,chainId:"loading"===chainId?0:Number.parseInt(chainId,16),networkId:"loading"===chainId?0:Number.parseInt(chainId,16),defaultHardfork:hardfork},_context2.abrupt("return",_ethereumjs_common__WEBPACK_IMPORTED_MODULE_13___default().custom(customChainParams));case 6:case"end":return _context2.stop()}},_callee2,this)})),function(){return _getCommonConfiguration.apply(this,arguments)})},{key:"formatTransaction",value:(_formatTransaction=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee3(txParams){var clonedTxParams,defaultGasLimit,_defaultGasLimit,_yield$this$getDefaul,defaultGasPrice,defaultMaxFeePerGas,defaultMaxPriorityFeePerGas;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(this.chainConfig){_context3.next=2;break}throw Error("Chain config not initialized");case 2:if(void 0!==(clonedTxParams=_objectSpread$1({},txParams)).nonce){_context3.next=7;break}return _context3.next=6,this.providerProxy.request({method:"eth_getTransactionCount",params:[txParams.from,"latest"]});case 6:clonedTxParams.nonce=_context3.sent;case 7:if(!(!this.isEIP1559Compatible&&clonedTxParams.gasPrice)){_context3.next=19;break}if(clonedTxParams.maxFeePerGas&&delete clonedTxParams.maxFeePerGas,clonedTxParams.maxPriorityFeePerGas&&delete clonedTxParams.maxPriorityFeePerGas,clonedTxParams.gas){_context3.next=17;break}return _context3.next=13,this.getDefaultGasLimit(clonedTxParams);case 13:(defaultGasLimit=_context3.sent)&&(clonedTxParams.gasLimit=defaultGasLimit),_context3.next=18;break;case 17:clonedTxParams.gasLimit=clonedTxParams.gas;case 18:return _context3.abrupt("return",clonedTxParams);case 19:if(clonedTxParams.gas){_context3.next=26;break}return _context3.next=22,this.getDefaultGasLimit(clonedTxParams);case 22:(_defaultGasLimit=_context3.sent)&&(clonedTxParams.gasLimit=_defaultGasLimit),_context3.next=27;break;case 26:clonedTxParams.gasLimit=clonedTxParams.gas;case 27:return _context3.next=29,this.getDefaultGasFees(clonedTxParams);case 29:if(defaultGasPrice=(_yield$this$getDefaul=_context3.sent).gasPrice,defaultMaxFeePerGas=_yield$this$getDefaul.maxFeePerGas,defaultMaxPriorityFeePerGas=_yield$this$getDefaul.maxPriorityFeePerGas,this.isEIP1559Compatible){if(!clonedTxParams.gasPrice||clonedTxParams.maxFeePerGas||clonedTxParams.maxPriorityFeePerGas)defaultMaxFeePerGas&&!clonedTxParams.maxFeePerGas&&(clonedTxParams.maxFeePerGas=defaultMaxFeePerGas),defaultMaxPriorityFeePerGas&&!clonedTxParams.maxPriorityFeePerGas&&(clonedTxParams.maxPriorityFeePerGas=defaultMaxPriorityFeePerGas),defaultGasPrice&&!clonedTxParams.maxFeePerGas&&(clonedTxParams.maxFeePerGas=defaultGasPrice),clonedTxParams.maxFeePerGas&&!clonedTxParams.maxPriorityFeePerGas&&(clonedTxParams.maxPriorityFeePerGas=clonedTxParams.maxFeePerGas);else{var a,b;clonedTxParams.maxFeePerGas=clonedTxParams.gasPrice,a="string"==typeof defaultMaxPriorityFeePerGas?(0,ethereumjs_util__WEBPACK_IMPORTED_MODULE_8__.stripHexPrefix)(defaultMaxPriorityFeePerGas):defaultMaxPriorityFeePerGas,b="string"==typeof clonedTxParams.gasPrice?(0,ethereumjs_util__WEBPACK_IMPORTED_MODULE_8__.stripHexPrefix)(clonedTxParams.gasPrice):clonedTxParams.gasPrice,clonedTxParams.maxPriorityFeePerGas=(null==a||null==b?null:new bignumber_js__WEBPACK_IMPORTED_MODULE_12__.O(a,10).lt(b,10))?defaultMaxPriorityFeePerGas:clonedTxParams.gasPrice}delete clonedTxParams.gasPrice}else delete clonedTxParams.maxPriorityFeePerGas,delete clonedTxParams.maxFeePerGas;return!defaultGasPrice||clonedTxParams.gasPrice||clonedTxParams.maxPriorityFeePerGas||clonedTxParams.maxFeePerGas||(clonedTxParams.gasPrice=defaultGasPrice),clonedTxParams.type=this.isEIP1559Compatible?TRANSACTION_ENVELOPE_TYPES.FEE_MARKET:TRANSACTION_ENVELOPE_TYPES.LEGACY,clonedTxParams.chainId=this.chainConfig.chainId,_context3.abrupt("return",clonedTxParams);case 38:case"end":return _context3.stop()}},_callee3,this)})),function(_x){return _formatTransaction.apply(this,arguments)})},{key:"fetchEthGasPriceEstimate",value:(_fetchEthGasPriceEstimate=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee4(){var gasPrice;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:return _context4.next=2,this.providerProxy.request({method:"eth_gasPrice",params:[]});case 2:return gasPrice=_context4.sent,_context4.abrupt("return",{gasPrice:hexWEIToDecGWEI(gasPrice).toString()});case 4:case"end":return _context4.stop()}},_callee4,this)})),function(){return _fetchEthGasPriceEstimate.apply(this,arguments)})},{key:"getEIP1559Compatibility",value:(_getEIP1559Compatibility=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee5(){var latestBlock,supportsEIP1559;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:return _context5.next=2,this.providerProxy.request({method:"eth_getBlockByNumber",params:["latest",!1]});case 2:return supportsEIP1559=(latestBlock=_context5.sent)&&void 0!==latestBlock.baseFeePerGas,_context5.abrupt("return",!!supportsEIP1559);case 5:case"end":return _context5.stop()}},_callee5,this)})),function(){return _getEIP1559Compatibility.apply(this,arguments)})},{key:"fetchGasFeeEstimateData",value:(_fetchGasFeeEstimateData=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee6(){var isLegacyGasAPICompatible,chainId,gasData;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:if(this.chainConfig){_context6.next=2;break}throw Error("Chain config not initialized");case 2:if(isLegacyGasAPICompatible="0x1"===this.chainConfig.chainId,chainId=Number.parseInt(this.chainConfig.chainId,16),_context6.prev=4,!this.isEIP1559Compatible){_context6.next=12;break}return _context6.next=8,function(_x){return _fetchEip1159GasEstimates.apply(this,arguments)}("https://gas-api.metaswap.codefi.network/networks/<chain_id>/suggestedGasFees".replace("<chain_id>","".concat(chainId)));case 8:gasData={gasFeeEstimates:_context6.sent,gasEstimateType:GAS_ESTIMATE_TYPES.FEE_MARKET},_context6.next=20;break;case 12:if(!isLegacyGasAPICompatible){_context6.next=19;break}return _context6.next=15,function(_x2){return _fetchLegacyGasPriceEstimates.apply(this,arguments)}("https://gas-api.metaswap.codefi.network/networks/<chain_id>/gasPrices".replace("<chain_id>","".concat(chainId)));case 15:gasData={gasFeeEstimates:_context6.sent,gasEstimateType:GAS_ESTIMATE_TYPES.LEGACY},_context6.next=20;break;case 19:throw Error("Main gas fee/price estimation failed. Use fallback");case 20:_context6.next=34;break;case 22:return _context6.prev=22,_context6.t0=_context6.catch(4),_context6.prev=24,_context6.next=27,this.fetchEthGasPriceEstimate();case 27:gasData={gasFeeEstimates:_context6.sent,gasEstimateType:GAS_ESTIMATE_TYPES.ETH_GASPRICE},_context6.next=34;break;case 31:throw _context6.prev=31,_context6.t1=_context6.catch(24),Error("Gas fee/price estimation failed. Message: ".concat(_context6.t1.message));case 34:return _context6.abrupt("return",gasData);case 35:case"end":return _context6.stop()}},_callee6,this,[[4,22],[24,31]])})),function(){return _fetchGasFeeEstimateData.apply(this,arguments)})},{key:"getDefaultGasFees",value:(_getDefaultGasFees=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee7(txParams){var _yield$this$fetchGasF,gasFeeEstimates,gasEstimateType,_gasFeeEstimates$medi,suggestedMaxPriorityFeePerGas,suggestedMaxFeePerGas,gasPrice;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:if(!(!this.isEIP1559Compatible&&txParams.gasPrice||this.isEIP1559Compatible&&txParams.maxFeePerGas&&txParams.maxPriorityFeePerGas)){_context7.next=2;break}return _context7.abrupt("return",{});case 2:return _context7.prev=2,_context7.next=5,this.fetchGasFeeEstimateData();case 5:if(gasFeeEstimates=(_yield$this$fetchGasF=_context7.sent).gasFeeEstimates,gasEstimateType=_yield$this$fetchGasF.gasEstimateType,!(this.isEIP1559Compatible&&gasEstimateType===GAS_ESTIMATE_TYPES.FEE_MARKET)){_context7.next=16;break}if(suggestedMaxPriorityFeePerGas=(_gasFeeEstimates$medi=void 0===(_gasFeeEstimates$medi=gasFeeEstimates.medium)?{}:_gasFeeEstimates$medi).suggestedMaxPriorityFeePerGas,suggestedMaxFeePerGas=_gasFeeEstimates$medi.suggestedMaxFeePerGas,!(suggestedMaxPriorityFeePerGas&&suggestedMaxFeePerGas)){_context7.next=14;break}return _context7.abrupt("return",{maxFeePerGas:(0,ethereumjs_util__WEBPACK_IMPORTED_MODULE_8__.addHexPrefix)(decGWEIToHexWEI(suggestedMaxFeePerGas)),maxPriorityFeePerGas:(0,ethereumjs_util__WEBPACK_IMPORTED_MODULE_8__.addHexPrefix)(decGWEIToHexWEI(suggestedMaxPriorityFeePerGas))});case 14:_context7.next=22;break;case 16:if(gasEstimateType!==GAS_ESTIMATE_TYPES.LEGACY){_context7.next=20;break}return _context7.abrupt("return",{gasPrice:(0,ethereumjs_util__WEBPACK_IMPORTED_MODULE_8__.addHexPrefix)(decGWEIToHexWEI(gasFeeEstimates.medium))});case 20:if(gasEstimateType!==GAS_ESTIMATE_TYPES.ETH_GASPRICE){_context7.next=22;break}return _context7.abrupt("return",{gasPrice:(0,ethereumjs_util__WEBPACK_IMPORTED_MODULE_8__.addHexPrefix)(decGWEIToHexWEI(gasFeeEstimates.gasPrice))});case 22:_context7.next=27;break;case 24:_context7.prev=24,_context7.t0=_context7.catch(2),_web3auth_base__WEBPACK_IMPORTED_MODULE_3__.cM.error(_context7.t0);case 27:return _context7.next=29,this.fetchEthGasPriceEstimate();case 29:return gasPrice=_context7.sent.gasPrice,_context7.abrupt("return",{gasPrice:(0,ethereumjs_util__WEBPACK_IMPORTED_MODULE_8__.addHexPrefix)(decGWEIToHexWEI(gasPrice))});case 32:case"end":return _context7.stop()}},_callee7,this,[[2,24]])})),function(_x2){return _getDefaultGasFees.apply(this,arguments)})},{key:"estimateTxGas",value:(_estimateTxGas=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee8(txMeta){var txParams,gas;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return delete(txParams=_objectSpread$1({},txMeta)).gasPrice,delete txParams.maxFeePerGas,delete txParams.maxPriorityFeePerGas,_context8.next=6,this.providerProxy.request({method:"eth_estimateGas",params:[txParams]});case 6:return gas=_context8.sent,_context8.abrupt("return",gas);case 8:case"end":return _context8.stop()}},_callee8,this)})),function(_x3){return _estimateTxGas.apply(this,arguments)})},{key:"analyzeGasUsage",value:(_analyzeGasUsage=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee9(txMeta){var block,estimatedGasHex;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:return _context9.next=2,this.providerProxy.request({method:"eth_getBlockByNumber",params:["latest",!1]});case 2:return estimatedGasHex=bnToHex(function(targetBN,numerator,denominator){var numberBN=new ethereumjs_util__WEBPACK_IMPORTED_MODULE_8__.BN(19),denomBN=new ethereumjs_util__WEBPACK_IMPORTED_MODULE_8__.BN(20);return targetBN.mul(numberBN).div(denomBN)}(hexToBn((block=_context9.sent).gasLimit),0,0)),_context9.prev=6,_context9.next=9,this.estimateTxGas(txMeta);case 9:estimatedGasHex=_context9.sent,_context9.next=15;break;case 12:_context9.prev=12,_context9.t0=_context9.catch(6),_web3auth_base__WEBPACK_IMPORTED_MODULE_3__.cM.warn(_context9.t0);case 15:return _context9.abrupt("return",{blockGasLimit:block.gasLimit,estimatedGasHex:estimatedGasHex});case 16:case"end":return _context9.stop()}},_callee9,this,[[6,12]])})),function(_x4){return _analyzeGasUsage.apply(this,arguments)})},{key:"addGasBuffer",value:function(initialGasLimitHex,blockGasLimitHex){var multiplier=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1.5,initialGasLimitBn=hexToBn(initialGasLimitHex),upperGasLimitBn=hexToBn(blockGasLimitHex).muln(.9),bufferedGasLimitBn=initialGasLimitBn.muln(multiplier);return initialGasLimitBn.gt(upperGasLimitBn)?bnToHex(initialGasLimitBn):bufferedGasLimitBn.lt(upperGasLimitBn)?bnToHex(bufferedGasLimitBn):bnToHex(upperGasLimitBn)}},{key:"determineTransactionCategory",value:(_determineTransactionCategory=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee10(txParameters){var data,to,code,txCategory;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context10){for(;;)switch(_context10.prev=_context10.next){case 0:if(data=txParameters.data,to=txParameters.to,code="",!(data&&!to)){_context10.next=6;break}txCategory=TRANSACTION_TYPES.DEPLOY_CONTRACT,_context10.next=17;break;case 6:return _context10.prev=6,_context10.next=9,this.providerProxy.request({method:"eth_getCode",params:[to,"latest"]});case 9:code=_context10.sent,_context10.next=15;break;case 12:_context10.prev=12,_context10.t0=_context10.catch(6),_web3auth_base__WEBPACK_IMPORTED_MODULE_3__.cM.warn(_context10.t0);case 15:txCategory=code&&"0x"!==code&&"0x0"!==code?TRANSACTION_TYPES.CONTRACT_INTERACTION:TRANSACTION_TYPES.SENT_ETHER;case 17:return _context10.abrupt("return",{transactionCategory:txCategory,code:code});case 18:case"end":return _context10.stop()}},_callee10,this,[[6,12]])})),function(_x5){return _determineTransactionCategory.apply(this,arguments)})},{key:"getDefaultGasLimit",value:(_getDefaultGasLimit=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee11(txParams){var transactionCategory,_yield$this$analyzeGa,blockGasLimit,estimatedGasHex,gasLimit;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context11){for(;;)switch(_context11.prev=_context11.next){case 0:return _context11.next=2,this.determineTransactionCategory(_objectSpread$1({},txParams));case 2:if(transactionCategory=_context11.sent.transactionCategory,!txParams.gas){_context11.next=6;break}return _context11.abrupt("return",txParams.gas);case 6:if(!(txParams.to&&transactionCategory===TRANSACTION_TYPES.SENT_ETHER)){_context11.next=11;break}if(!txParams.data){_context11.next=9;break}throw Error("TxGasUtil - Trying to call a function on a non-contract address");case 9:return _context11.abrupt("return",(0,ethereumjs_util__WEBPACK_IMPORTED_MODULE_8__.addHexPrefix)("5208"));case 11:return _context11.next=13,this.analyzeGasUsage(txParams);case 13:return blockGasLimit=(_yield$this$analyzeGa=_context11.sent).blockGasLimit,estimatedGasHex=_yield$this$analyzeGa.estimatedGasHex,gasLimit=this.addGasBuffer((0,ethereumjs_util__WEBPACK_IMPORTED_MODULE_8__.addHexPrefix)(estimatedGasHex),blockGasLimit),_context11.abrupt("return",gasLimit);case 18:case"end":return _context11.stop()}},_callee11,this)})),function(_x6){return _getDefaultGasLimit.apply(this,arguments)})}]),TransactionFormatter}();function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable})),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_14__.Z)(target,key,source[key])}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))})}return target}var EthereumPrivateKeyProvider=function(_BaseProvider){(0,_babel_runtime_helpers_inherits__WEBPACK_IMPORTED_MODULE_18__.Z)(EthereumPrivateKeyProvider,_BaseProvider);var hasNativeReflectConstruct,_enable,_setupProvider,_updateAccount,_switchChain,_lookupNetwork,_super=(hasNativeReflectConstruct=function(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}(),function(){var result,Super=(0,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_16__.Z)(EthereumPrivateKeyProvider);if(hasNativeReflectConstruct){var NewTarget=(0,_babel_runtime_helpers_getPrototypeOf__WEBPACK_IMPORTED_MODULE_16__.Z)(this).constructor;result=Reflect.construct(Super,arguments,NewTarget)}else result=Super.apply(this,arguments);return(0,_babel_runtime_helpers_possibleConstructorReturn__WEBPACK_IMPORTED_MODULE_17__.Z)(this,result)});function EthereumPrivateKeyProvider(_ref){var config=_ref.config,state=_ref.state;return(0,_babel_runtime_helpers_classCallCheck__WEBPACK_IMPORTED_MODULE_19__.Z)(this,EthereumPrivateKeyProvider),_super.call(this,{config:{chainConfig:_objectSpread(_objectSpread({},config.chainConfig),{},{chainNamespace:_web3auth_base__WEBPACK_IMPORTED_MODULE_3__.EN.EIP155})},state:state})}return(0,_babel_runtime_helpers_createClass__WEBPACK_IMPORTED_MODULE_21__.Z)(EthereumPrivateKeyProvider,[{key:"enable",value:(_enable=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee(){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(this.state.privateKey){_context.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.provider.custom({message:"Private key is not found in state, plz pass it in constructor state param",code:4902});case 2:return _context.next=4,this.setupProvider(this.state.privateKey);case 4:return _context.abrupt("return",this._providerEngineProxy.request({method:"eth_accounts"}));case 5:case"end":return _context.stop()}},_callee,this)})),function(){return _enable.apply(this,arguments)})},{key:"setupProvider",value:(_setupProvider=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee2(privKey){var txFormatter,ethMiddleware,chainSwitchMiddleware,engine,networkMiddleware,provider;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:return ethMiddleware=createEthMiddleware(getProviderHandlers({txFormatter:txFormatter=new TransactionFormatter({getProviderEngineProxy:this.getProviderEngineProxy.bind(this)}),privKey:privKey,getProviderEngineProxy:this.getProviderEngineProxy.bind(this)})),chainSwitchMiddleware=this.getChainSwitchMiddleware(),engine=new _toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.eI,networkMiddleware=createJsonRpcClient(this.config.chainConfig).networkMiddleware,engine.push(ethMiddleware),engine.push(chainSwitchMiddleware),engine.push(this.getAccountMiddleware()),engine.push(networkMiddleware),provider=(0,_toruslabs_base_controllers__WEBPACK_IMPORTED_MODULE_1__.Xj)(engine),this.updateProviderEngineProxy(provider),_context2.next=14,txFormatter.init();case 14:return _context2.next=16,this.lookupNetwork();case 16:case"end":return _context2.stop()}},_callee2,this)})),function(_x){return _setupProvider.apply(this,arguments)})},{key:"updateAccount",value:(_updateAccount=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee3(params){return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(this._providerEngineProxy){_context3.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 2:return _context3.next=4,this._providerEngineProxy.request({method:"eth_private_key"});case 4:if(!(_context3.sent!==params.privateKey)){_context3.next=14;break}return _context3.next=8,this.setupProvider(params.privateKey);case 8:return _context3.t0=this._providerEngineProxy,_context3.next=11,this._providerEngineProxy.request({method:"eth_accounts"});case 11:_context3.t1=_context3.sent,_context3.t2={accounts:_context3.t1},_context3.t0.emit.call(_context3.t0,"accountsChanged",_context3.t2);case 14:case"end":return _context3.stop()}},_callee3,this)})),function(_x2){return _updateAccount.apply(this,arguments)})},{key:"switchChain",value:(_switchChain=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee4(params){var chainConfig,privKey;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if(this._providerEngineProxy){_context4.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 2:return chainConfig=this.getChainConfig(params.chainId),this.update({chainId:"loading"}),this.configure({chainConfig:chainConfig}),_context4.next=7,this._providerEngineProxy.request({method:"eth_private_key"});case 7:return privKey=_context4.sent,_context4.next=10,this.setupProvider(privKey);case 10:case"end":return _context4.stop()}},_callee4,this)})),function(_x3){return _switchChain.apply(this,arguments)})},{key:"lookupNetwork",value:(_lookupNetwork=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee5(){var chainId,network;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context5){for(;;)switch(_context5.prev=_context5.next){case 0:if(this._providerEngineProxy){_context5.next=2;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.provider.custom({message:"Provider is not initialized",code:4902});case 2:if(chainId=this.config.chainConfig.chainId){_context5.next=5;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.rpc.invalidParams("chainId is required while lookupNetwork");case 5:return _context5.next=7,this._providerEngineProxy.request({method:"net_version",params:[]});case 7:if(network=_context5.sent,!(parseInt(chainId,16)!==parseInt(network,10))){_context5.next=10;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.provider.chainDisconnected("Invalid network, net_version is: ".concat(network));case 10:return this.state.chainId!==chainId&&(this._providerEngineProxy.emit("chainChanged",chainId),this._providerEngineProxy.emit("connect",{chainId:chainId})),this.update({chainId:chainId}),_context5.abrupt("return",network);case 13:case"end":return _context5.stop()}},_callee5,this)})),function(){return _lookupNetwork.apply(this,arguments)})},{key:"getChainSwitchMiddleware",value:function(){var _addChain,_switchChain2,_this=this;return function(_ref){var addChain=_ref.addChain,switchChain=_ref.switchChain;function _addNewChain(){return(_addNewChain=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee(req,res){var _req$params,chainParams;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:if(chainParams=null!==(_req$params=req.params)&&void 0!==_req$params&&_req$params.length?req.params[0]:void 0){_context.next=3;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.rpc.invalidParams("Missing chain params");case 3:if(chainParams.chainId){_context.next=5;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.rpc.invalidParams("Missing chainId in chainParams");case 5:if(!(!chainParams.rpcUrls||0===chainParams.rpcUrls.length)){_context.next=7;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.rpc.invalidParams("Missing rpcUrls in chainParams");case 7:if(chainParams.nativeCurrency){_context.next=9;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.rpc.invalidParams("Missing nativeCurrency in chainParams");case 9:return _context.next=11,addChain(chainParams);case 11:res.result=_context.sent;case 12:case"end":return _context.stop()}},_callee)}))).apply(this,arguments)}function _updateChain(){return(_updateChain=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee2(req,res){var _req$params2,chainParams;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(chainParams=null!==(_req$params2=req.params)&&void 0!==_req$params2&&_req$params2.length?req.params[0]:void 0){_context2.next=3;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.rpc.invalidParams("Missing chainId");case 3:return _context2.next=5,switchChain(chainParams);case 5:res.result=_context2.sent;case 6:case"end":return _context2.stop()}},_callee2)}))).apply(this,arguments)}return(0,_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.v0)({wallet_addEthereumChain:(0,_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.Pk)(function(_x,_x2){return _addNewChain.apply(this,arguments)}),wallet_switchEthereumChain:(0,_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.Pk)(function(_x3,_x4){return _updateChain.apply(this,arguments)})})}({addChain:(_addChain=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee6(params){var chainId,chainName,rpcUrls,blockExplorerUrls,nativeCurrency;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context6){for(;;)switch(_context6.prev=_context6.next){case 0:chainId=params.chainId,chainName=params.chainName,rpcUrls=params.rpcUrls,blockExplorerUrls=params.blockExplorerUrls,nativeCurrency=params.nativeCurrency,_this.addChain({chainNamespace:"eip155",chainId:chainId,ticker:(null==nativeCurrency?void 0:nativeCurrency.symbol)||"ETH",tickerName:(null==nativeCurrency?void 0:nativeCurrency.name)||"Ether",displayName:chainName,rpcTarget:rpcUrls[0],blockExplorer:(null==blockExplorerUrls?void 0:blockExplorerUrls[0])||""});case 2:case"end":return _context6.stop()}},_callee6)})),function(_x4){return _addChain.apply(this,arguments)}),switchChain:(_switchChain2=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee7(params){var chainId;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context7){for(;;)switch(_context7.prev=_context7.next){case 0:return chainId=params.chainId,_context7.next=3,_this.switchChain({chainId:chainId});case 3:case"end":return _context7.stop()}},_callee7)})),function(_x5){return _switchChain2.apply(this,arguments)})})}},{key:"getAccountMiddleware",value:function(){var _updatePrivatekey,_this2=this;return function(_ref2){var updatePrivatekey=_ref2.updatePrivatekey;function _updateAccount(){return(_updateAccount=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee3(req,res){var _req$params3,accountParams;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(null!=(accountParams=null!==(_req$params3=req.params)&&void 0!==_req$params3&&_req$params3.length?req.params[0]:void 0)&&accountParams.privateKey){_context3.next=3;break}throw eth_rpc_errors__WEBPACK_IMPORTED_MODULE_5__.ethErrors.rpc.invalidParams("Missing privateKey");case 3:return _context3.next=5,updatePrivatekey(accountParams);case 5:res.result=_context3.sent;case 6:case"end":return _context3.stop()}},_callee3)}))).apply(this,arguments)}return(0,_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.v0)({wallet_updateAccount:(0,_toruslabs_openlogin_jrpc__WEBPACK_IMPORTED_MODULE_2__.Pk)(function(_x5,_x6){return _updateAccount.apply(this,arguments)})})}({updatePrivatekey:(_updatePrivatekey=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee8(params){var privateKey;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context8){for(;;)switch(_context8.prev=_context8.next){case 0:return privateKey=params.privateKey,_context8.next=3,_this2.updateAccount({privateKey:privateKey});case 3:case"end":return _context8.stop()}},_callee8)})),function(_x6){return _updatePrivatekey.apply(this,arguments)})})}}]),EthereumPrivateKeyProvider}(_web3auth_base_provider__WEBPACK_IMPORTED_MODULE_4__.Zk);(0,_babel_runtime_helpers_defineProperty__WEBPACK_IMPORTED_MODULE_14__.Z)(EthereumPrivateKeyProvider,"getProviderInstance",(_ref2=(0,_babel_runtime_helpers_asyncToGenerator__WEBPACK_IMPORTED_MODULE_15__.Z)(_babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().mark(function _callee9(params){var providerFactory;return _babel_runtime_regenerator__WEBPACK_IMPORTED_MODULE_0___default().wrap(function(_context9){for(;;)switch(_context9.prev=_context9.next){case 0:return providerFactory=new EthereumPrivateKeyProvider({config:{chainConfig:params.chainConfig}}),_context9.next=3,providerFactory.setupProvider(params.privKey);case 3:return _context9.abrupt("return",providerFactory);case 4:case"end":return _context9.stop()}},_callee9)})),function(_x7){return _ref2.apply(this,arguments)}))},14518:function(module,__unused_webpack_exports,__webpack_require__){!function(module,exports){"use strict";function assert(val,msg){if(!val)throw Error(msg||"Assertion failed")}function inherits(ctor,superCtor){ctor.super_=superCtor;var TempCtor=function(){};TempCtor.prototype=superCtor.prototype,ctor.prototype=new TempCtor,ctor.prototype.constructor=ctor}function BN(number,base,endian){if(BN.isBN(number))return number;this.negative=0,this.words=null,this.length=0,this.red=null,null!==number&&(("le"===base||"be"===base)&&(endian=base,base=10),this._init(number||0,base||10,endian||"be"))}"object"==typeof module?module.exports=BN:exports.BN=BN,BN.BN=BN,BN.wordSize=26;try{Buffer="undefined"!=typeof window&&void 0!==window.Buffer?window.Buffer:__webpack_require__(11355).Buffer}catch(e){}function parseHex4Bits(string,index){var c=string.charCodeAt(index);return c>=48&&c<=57?c-48:c>=65&&c<=70?c-55:c>=97&&c<=102?c-87:void assert(!1,"Invalid character in "+string)}function parseHexByte(string,lowerBound,index){var r=parseHex4Bits(string,index);return index-1>=lowerBound&&(r|=parseHex4Bits(string,index-1)<<4),r}function parseBase(str,start,end,mul){for(var r=0,b=0,len=Math.min(str.length,end),i=start;i<len;i++){var c=str.charCodeAt(i)-48;r*=mul,b=c>=49?c-49+10:c>=17?c-17+10:c,assert(c>=0&&b<mul,"Invalid character"),r+=b}return r}function move(dest,src){dest.words=src.words,dest.length=src.length,dest.negative=src.negative,dest.red=src.red}if(BN.isBN=function(num){return num instanceof BN||null!==num&&"object"==typeof num&&num.constructor.wordSize===BN.wordSize&&Array.isArray(num.words)},BN.max=function(left,right){return left.cmp(right)>0?left:right},BN.min=function(left,right){return 0>left.cmp(right)?left:right},BN.prototype._init=function(number,base,endian){if("number"==typeof number)return this._initNumber(number,base,endian);if("object"==typeof number)return this._initArray(number,base,endian);"hex"===base&&(base=16),assert(base===(0|base)&&base>=2&&base<=36);var start=0;"-"===(number=number.toString().replace(/\s+/g,""))[0]&&(start++,this.negative=1),start<number.length&&(16===base?this._parseHex(number,start,endian):(this._parseBase(number,base,start),"le"===endian&&this._initArray(this.toArray(),base,endian)))},BN.prototype._initNumber=function(number,base,endian){number<0&&(this.negative=1,number=-number),number<67108864?(this.words=[67108863&number],this.length=1):number<4503599627370496?(this.words=[67108863&number,number/67108864&67108863],this.length=2):(assert(number<9007199254740992),this.words=[67108863&number,number/67108864&67108863,1],this.length=3),"le"===endian&&this._initArray(this.toArray(),base,endian)},BN.prototype._initArray=function(number,base,endian){if(assert("number"==typeof number.length),number.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(number.length/3),this.words=Array(this.length);for(var j,w,i=0;i<this.length;i++)this.words[i]=0;var off=0;if("be"===endian)for(i=number.length-1,j=0;i>=0;i-=3)w=number[i]|number[i-1]<<8|number[i-2]<<16,this.words[j]|=w<<off&67108863,this.words[j+1]=w>>>26-off&67108863,(off+=24)>=26&&(off-=26,j++);else if("le"===endian)for(i=0,j=0;i<number.length;i+=3)w=number[i]|number[i+1]<<8|number[i+2]<<16,this.words[j]|=w<<off&67108863,this.words[j+1]=w>>>26-off&67108863,(off+=24)>=26&&(off-=26,j++);return this._strip()},BN.prototype._parseHex=function(number,start,endian){this.length=Math.ceil((number.length-start)/6),this.words=Array(this.length);for(var w,i=0;i<this.length;i++)this.words[i]=0;var off=0,j=0;if("be"===endian)for(i=number.length-1;i>=start;i-=2)w=parseHexByte(number,start,i)<<off,this.words[j]|=67108863&w,off>=18?(off-=18,j+=1,this.words[j]|=w>>>26):off+=8;else for(i=(number.length-start)%2==0?start+1:start;i<number.length;i+=2)w=parseHexByte(number,start,i)<<off,this.words[j]|=67108863&w,off>=18?(off-=18,j+=1,this.words[j]|=w>>>26):off+=8;this._strip()},BN.prototype._parseBase=function(number,base,start){this.words=[0],this.length=1;for(var limbLen=0,limbPow=1;limbPow<=67108863;limbPow*=base)limbLen++;limbLen--,limbPow=limbPow/base|0;for(var total=number.length-start,mod=total%limbLen,end=Math.min(total,total-mod)+start,word=0,i=start;i<end;i+=limbLen)word=parseBase(number,i,i+limbLen,base),this.imuln(limbPow),this.words[0]+word<67108864?this.words[0]+=word:this._iaddn(word);if(0!==mod){var pow=1;for(word=parseBase(number,i,number.length,base),i=0;i<mod;i++)pow*=base;this.imuln(pow),this.words[0]+word<67108864?this.words[0]+=word:this._iaddn(word)}this._strip()},BN.prototype.copy=function(dest){dest.words=Array(this.length);for(var i=0;i<this.length;i++)dest.words[i]=this.words[i];dest.length=this.length,dest.negative=this.negative,dest.red=this.red},BN.prototype._move=function(dest){move(dest,this)},BN.prototype.clone=function(){var r=new BN(null);return this.copy(r),r},BN.prototype._expand=function(size){for(;this.length<size;)this.words[this.length++]=0;return this},BN.prototype._strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},BN.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},"undefined"!=typeof Symbol&&"function"==typeof Symbol.for)try{BN.prototype[Symbol.for("nodejs.util.inspect.custom")]=inspect}catch(e1){BN.prototype.inspect=inspect}else BN.prototype.inspect=inspect;function inspect(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var Buffer,zeros=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],groupSizes=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],groupBases=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];function smallMulTo(self1,num,out){out.negative=num.negative^self1.negative;var len=self1.length+num.length|0;out.length=len,len=len-1|0;var a=0|self1.words[0],b=0|num.words[0],r=a*b,lo=67108863&r,carry=r/67108864|0;out.words[0]=lo;for(var k=1;k<len;k++){for(var ncarry=carry>>>26,rword=67108863&carry,maxJ=Math.min(k,num.length-1),j=Math.max(0,k-self1.length+1);j<=maxJ;j++){var i=k-j|0;ncarry+=(r=(a=0|self1.words[i])*(b=0|num.words[j])+rword)/67108864|0,rword=67108863&r}out.words[k]=0|rword,carry=0|ncarry}return 0!==carry?out.words[k]=0|carry:out.length--,out._strip()}BN.prototype.toString=function(base,padding){if(padding=0|padding||1,16===(base=base||10)||"hex"===base){out="";for(var out,off=0,carry=0,i=0;i<this.length;i++){var w=this.words[i],word=((w<<off|carry)&16777215).toString(16);carry=w>>>24-off&16777215,(off+=2)>=26&&(off-=26,i--),out=0!==carry||i!==this.length-1?zeros[6-word.length]+word+out:word+out}for(0!==carry&&(out=carry.toString(16)+out);out.length%padding!=0;)out="0"+out;return 0!==this.negative&&(out="-"+out),out}if(base===(0|base)&&base>=2&&base<=36){var groupSize=groupSizes[base],groupBase=groupBases[base];out="";var c=this.clone();for(c.negative=0;!c.isZero();){var r=c.modrn(groupBase).toString(base);out=(c=c.idivn(groupBase)).isZero()?r+out:zeros[groupSize-r.length]+r+out}for(this.isZero()&&(out="0"+out);out.length%padding!=0;)out="0"+out;return 0!==this.negative&&(out="-"+out),out}assert(!1,"Base should be between 2 and 36")},BN.prototype.toNumber=function(){var ret=this.words[0];return 2===this.length?ret+=67108864*this.words[1]:3===this.length&&1===this.words[2]?ret+=4503599627370496+67108864*this.words[1]:this.length>2&&assert(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-ret:ret},BN.prototype.toJSON=function(){return this.toString(16,2)},Buffer&&(BN.prototype.toBuffer=function(endian,length){return this.toArrayLike(Buffer,endian,length)}),BN.prototype.toArray=function(endian,length){return this.toArrayLike(Array,endian,length)},BN.prototype.toArrayLike=function(ArrayType,endian,length){this._strip();var byteLength=this.byteLength(),reqLength=length||Math.max(1,byteLength);assert(byteLength<=reqLength,"byte array longer than desired length"),assert(reqLength>0,"Requested array length <= 0");var res=ArrayType.allocUnsafe?ArrayType.allocUnsafe(reqLength):new ArrayType(reqLength);return this["_toArrayLike"+("le"===endian?"LE":"BE")](res,byteLength),res},BN.prototype._toArrayLikeLE=function(res,byteLength){for(var position=0,carry=0,i=0,shift=0;i<this.length;i++){var word=this.words[i]<<shift|carry;res[position++]=255&word,position<res.length&&(res[position++]=word>>8&255),position<res.length&&(res[position++]=word>>16&255),6===shift?(position<res.length&&(res[position++]=word>>24&255),carry=0,shift=0):(carry=word>>>24,shift+=2)}if(position<res.length)for(res[position++]=carry;position<res.length;)res[position++]=0},BN.prototype._toArrayLikeBE=function(res,byteLength){for(var position=res.length-1,carry=0,i=0,shift=0;i<this.length;i++){var word=this.words[i]<<shift|carry;res[position--]=255&word,position>=0&&(res[position--]=word>>8&255),position>=0&&(res[position--]=word>>16&255),6===shift?(position>=0&&(res[position--]=word>>24&255),carry=0,shift=0):(carry=word>>>24,shift+=2)}if(position>=0)for(res[position--]=carry;position>=0;)res[position--]=0},Math.clz32?BN.prototype._countBits=function(w){return 32-Math.clz32(w)}:BN.prototype._countBits=function(w){var t=w,r=0;return t>=4096&&(r+=13,t>>>=13),t>=64&&(r+=7,t>>>=7),t>=8&&(r+=4,t>>>=4),t>=2&&(r+=2,t>>>=2),r+t},BN.prototype._zeroBits=function(w){if(0===w)return 26;var t=w,r=0;return(8191&t)==0&&(r+=13,t>>>=13),(127&t)==0&&(r+=7,t>>>=7),(15&t)==0&&(r+=4,t>>>=4),(3&t)==0&&(r+=2,t>>>=2),(1&t)==0&&r++,r},BN.prototype.bitLength=function(){var w=this.words[this.length-1],hi=this._countBits(w);return(this.length-1)*26+hi},BN.prototype.zeroBits=function(){if(this.isZero())return 0;for(var r=0,i=0;i<this.length;i++){var b=this._zeroBits(this.words[i]);if(r+=b,26!==b)break}return r},BN.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},BN.prototype.toTwos=function(width){return 0!==this.negative?this.abs().inotn(width).iaddn(1):this.clone()},BN.prototype.fromTwos=function(width){return this.testn(width-1)?this.notn(width).iaddn(1).ineg():this.clone()},BN.prototype.isNeg=function(){return 0!==this.negative},BN.prototype.neg=function(){return this.clone().ineg()},BN.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},BN.prototype.iuor=function(num){for(;this.length<num.length;)this.words[this.length++]=0;for(var i=0;i<num.length;i++)this.words[i]=this.words[i]|num.words[i];return this._strip()},BN.prototype.ior=function(num){return assert((this.negative|num.negative)==0),this.iuor(num)},BN.prototype.or=function(num){return this.length>num.length?this.clone().ior(num):num.clone().ior(this)},BN.prototype.uor=function(num){return this.length>num.length?this.clone().iuor(num):num.clone().iuor(this)},BN.prototype.iuand=function(num){var b;b=this.length>num.length?num:this;for(var i=0;i<b.length;i++)this.words[i]=this.words[i]&num.words[i];return this.length=b.length,this._strip()},BN.prototype.iand=function(num){return assert((this.negative|num.negative)==0),this.iuand(num)},BN.prototype.and=function(num){return this.length>num.length?this.clone().iand(num):num.clone().iand(this)},BN.prototype.uand=function(num){return this.length>num.length?this.clone().iuand(num):num.clone().iuand(this)},BN.prototype.iuxor=function(num){this.length>num.length?(a=this,b=num):(a=num,b=this);for(var a,b,i=0;i<b.length;i++)this.words[i]=a.words[i]^b.words[i];if(this!==a)for(;i<a.length;i++)this.words[i]=a.words[i];return this.length=a.length,this._strip()},BN.prototype.ixor=function(num){return assert((this.negative|num.negative)==0),this.iuxor(num)},BN.prototype.xor=function(num){return this.length>num.length?this.clone().ixor(num):num.clone().ixor(this)},BN.prototype.uxor=function(num){return this.length>num.length?this.clone().iuxor(num):num.clone().iuxor(this)},BN.prototype.inotn=function(width){assert("number"==typeof width&&width>=0);var bytesNeeded=0|Math.ceil(width/26),bitsLeft=width%26;this._expand(bytesNeeded),bitsLeft>0&&bytesNeeded--;for(var i=0;i<bytesNeeded;i++)this.words[i]=67108863&~this.words[i];return bitsLeft>0&&(this.words[i]=~this.words[i]&67108863>>26-bitsLeft),this._strip()},BN.prototype.notn=function(width){return this.clone().inotn(width)},BN.prototype.setn=function(bit,val){assert("number"==typeof bit&&bit>=0);var off=bit/26|0,wbit=bit%26;return this._expand(off+1),val?this.words[off]=this.words[off]|1<<wbit:this.words[off]=this.words[off]&~(1<<wbit),this._strip()},BN.prototype.iadd=function(num){if(0!==this.negative&&0===num.negative)return this.negative=0,r=this.isub(num),this.negative^=1,this._normSign();if(0===this.negative&&0!==num.negative)return num.negative=0,r=this.isub(num),num.negative=1,r._normSign();this.length>num.length?(a=this,b=num):(a=num,b=this);for(var r,a,b,carry=0,i=0;i<b.length;i++)r=(0|a.words[i])+(0|b.words[i])+carry,this.words[i]=67108863&r,carry=r>>>26;for(;0!==carry&&i<a.length;i++)r=(0|a.words[i])+carry,this.words[i]=67108863&r,carry=r>>>26;if(this.length=a.length,0!==carry)this.words[this.length]=carry,this.length++;else if(a!==this)for(;i<a.length;i++)this.words[i]=a.words[i];return this},BN.prototype.add=function(num){var res;return 0!==num.negative&&0===this.negative?(num.negative=0,res=this.sub(num),num.negative^=1,res):0===num.negative&&0!==this.negative?(this.negative=0,res=num.sub(this),this.negative=1,res):this.length>num.length?this.clone().iadd(num):num.clone().iadd(this)},BN.prototype.isub=function(num){if(0!==num.negative){num.negative=0;var a,b,r=this.iadd(num);return num.negative=1,r._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(num),this.negative=1,this._normSign();var cmp=this.cmp(num);if(0===cmp)return this.negative=0,this.length=1,this.words[0]=0,this;cmp>0?(a=this,b=num):(a=num,b=this);for(var carry=0,i=0;i<b.length;i++)carry=(r=(0|a.words[i])-(0|b.words[i])+carry)>>26,this.words[i]=67108863&r;for(;0!==carry&&i<a.length;i++)carry=(r=(0|a.words[i])+carry)>>26,this.words[i]=67108863&r;if(0===carry&&i<a.length&&a!==this)for(;i<a.length;i++)this.words[i]=a.words[i];return this.length=Math.max(this.length,i),a!==this&&(this.negative=1),this._strip()},BN.prototype.sub=function(num){return this.clone().isub(num)};var comb10MulTo=function(self1,num,out){var lo,mid,hi,a=self1.words,b=num.words,o=out.words,c=0,a0=0|a[0],al0=8191&a0,ah0=a0>>>13,a1=0|a[1],al1=8191&a1,ah1=a1>>>13,a2=0|a[2],al2=8191&a2,ah2=a2>>>13,a3=0|a[3],al3=8191&a3,ah3=a3>>>13,a4=0|a[4],al4=8191&a4,ah4=a4>>>13,a5=0|a[5],al5=8191&a5,ah5=a5>>>13,a6=0|a[6],al6=8191&a6,ah6=a6>>>13,a7=0|a[7],al7=8191&a7,ah7=a7>>>13,a8=0|a[8],al8=8191&a8,ah8=a8>>>13,a9=0|a[9],al9=8191&a9,ah9=a9>>>13,b0=0|b[0],bl0=8191&b0,bh0=b0>>>13,b1=0|b[1],bl1=8191&b1,bh1=b1>>>13,b2=0|b[2],bl2=8191&b2,bh2=b2>>>13,b3=0|b[3],bl3=8191&b3,bh3=b3>>>13,b4=0|b[4],bl4=8191&b4,bh4=b4>>>13,b5=0|b[5],bl5=8191&b5,bh5=b5>>>13,b6=0|b[6],bl6=8191&b6,bh6=b6>>>13,b7=0|b[7],bl7=8191&b7,bh7=b7>>>13,b8=0|b[8],bl8=8191&b8,bh8=b8>>>13,b9=0|b[9],bl9=8191&b9,bh9=b9>>>13;out.negative=self1.negative^num.negative,out.length=19;var w0=(c+(lo=Math.imul(al0,bl0))|0)+((8191&(mid=(mid=Math.imul(al0,bh0))+Math.imul(ah0,bl0)|0))<<13)|0;c=((hi=Math.imul(ah0,bh0))+(mid>>>13)|0)+(w0>>>26)|0,w0&=67108863,lo=Math.imul(al1,bl0),mid=(mid=Math.imul(al1,bh0))+Math.imul(ah1,bl0)|0,hi=Math.imul(ah1,bh0);var w1=(c+(lo=lo+Math.imul(al0,bl1)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al0,bh1)|0)+Math.imul(ah0,bl1)|0))<<13)|0;c=((hi=hi+Math.imul(ah0,bh1)|0)+(mid>>>13)|0)+(w1>>>26)|0,w1&=67108863,lo=Math.imul(al2,bl0),mid=(mid=Math.imul(al2,bh0))+Math.imul(ah2,bl0)|0,hi=Math.imul(ah2,bh0),lo=lo+Math.imul(al1,bl1)|0,mid=(mid=mid+Math.imul(al1,bh1)|0)+Math.imul(ah1,bl1)|0,hi=hi+Math.imul(ah1,bh1)|0;var w2=(c+(lo=lo+Math.imul(al0,bl2)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al0,bh2)|0)+Math.imul(ah0,bl2)|0))<<13)|0;c=((hi=hi+Math.imul(ah0,bh2)|0)+(mid>>>13)|0)+(w2>>>26)|0,w2&=67108863,lo=Math.imul(al3,bl0),mid=(mid=Math.imul(al3,bh0))+Math.imul(ah3,bl0)|0,hi=Math.imul(ah3,bh0),lo=lo+Math.imul(al2,bl1)|0,mid=(mid=mid+Math.imul(al2,bh1)|0)+Math.imul(ah2,bl1)|0,hi=hi+Math.imul(ah2,bh1)|0,lo=lo+Math.imul(al1,bl2)|0,mid=(mid=mid+Math.imul(al1,bh2)|0)+Math.imul(ah1,bl2)|0,hi=hi+Math.imul(ah1,bh2)|0;var w3=(c+(lo=lo+Math.imul(al0,bl3)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al0,bh3)|0)+Math.imul(ah0,bl3)|0))<<13)|0;c=((hi=hi+Math.imul(ah0,bh3)|0)+(mid>>>13)|0)+(w3>>>26)|0,w3&=67108863,lo=Math.imul(al4,bl0),mid=(mid=Math.imul(al4,bh0))+Math.imul(ah4,bl0)|0,hi=Math.imul(ah4,bh0),lo=lo+Math.imul(al3,bl1)|0,mid=(mid=mid+Math.imul(al3,bh1)|0)+Math.imul(ah3,bl1)|0,hi=hi+Math.imul(ah3,bh1)|0,lo=lo+Math.imul(al2,bl2)|0,mid=(mid=mid+Math.imul(al2,bh2)|0)+Math.imul(ah2,bl2)|0,hi=hi+Math.imul(ah2,bh2)|0,lo=lo+Math.imul(al1,bl3)|0,mid=(mid=mid+Math.imul(al1,bh3)|0)+Math.imul(ah1,bl3)|0,hi=hi+Math.imul(ah1,bh3)|0;var w4=(c+(lo=lo+Math.imul(al0,bl4)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al0,bh4)|0)+Math.imul(ah0,bl4)|0))<<13)|0;c=((hi=hi+Math.imul(ah0,bh4)|0)+(mid>>>13)|0)+(w4>>>26)|0,w4&=67108863,lo=Math.imul(al5,bl0),mid=(mid=Math.imul(al5,bh0))+Math.imul(ah5,bl0)|0,hi=Math.imul(ah5,bh0),lo=lo+Math.imul(al4,bl1)|0,mid=(mid=mid+Math.imul(al4,bh1)|0)+Math.imul(ah4,bl1)|0,hi=hi+Math.imul(ah4,bh1)|0,lo=lo+Math.imul(al3,bl2)|0,mid=(mid=mid+Math.imul(al3,bh2)|0)+Math.imul(ah3,bl2)|0,hi=hi+Math.imul(ah3,bh2)|0,lo=lo+Math.imul(al2,bl3)|0,mid=(mid=mid+Math.imul(al2,bh3)|0)+Math.imul(ah2,bl3)|0,hi=hi+Math.imul(ah2,bh3)|0,lo=lo+Math.imul(al1,bl4)|0,mid=(mid=mid+Math.imul(al1,bh4)|0)+Math.imul(ah1,bl4)|0,hi=hi+Math.imul(ah1,bh4)|0;var w5=(c+(lo=lo+Math.imul(al0,bl5)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al0,bh5)|0)+Math.imul(ah0,bl5)|0))<<13)|0;c=((hi=hi+Math.imul(ah0,bh5)|0)+(mid>>>13)|0)+(w5>>>26)|0,w5&=67108863,lo=Math.imul(al6,bl0),mid=(mid=Math.imul(al6,bh0))+Math.imul(ah6,bl0)|0,hi=Math.imul(ah6,bh0),lo=lo+Math.imul(al5,bl1)|0,mid=(mid=mid+Math.imul(al5,bh1)|0)+Math.imul(ah5,bl1)|0,hi=hi+Math.imul(ah5,bh1)|0,lo=lo+Math.imul(al4,bl2)|0,mid=(mid=mid+Math.imul(al4,bh2)|0)+Math.imul(ah4,bl2)|0,hi=hi+Math.imul(ah4,bh2)|0,lo=lo+Math.imul(al3,bl3)|0,mid=(mid=mid+Math.imul(al3,bh3)|0)+Math.imul(ah3,bl3)|0,hi=hi+Math.imul(ah3,bh3)|0,lo=lo+Math.imul(al2,bl4)|0,mid=(mid=mid+Math.imul(al2,bh4)|0)+Math.imul(ah2,bl4)|0,hi=hi+Math.imul(ah2,bh4)|0,lo=lo+Math.imul(al1,bl5)|0,mid=(mid=mid+Math.imul(al1,bh5)|0)+Math.imul(ah1,bl5)|0,hi=hi+Math.imul(ah1,bh5)|0;var w6=(c+(lo=lo+Math.imul(al0,bl6)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al0,bh6)|0)+Math.imul(ah0,bl6)|0))<<13)|0;c=((hi=hi+Math.imul(ah0,bh6)|0)+(mid>>>13)|0)+(w6>>>26)|0,w6&=67108863,lo=Math.imul(al7,bl0),mid=(mid=Math.imul(al7,bh0))+Math.imul(ah7,bl0)|0,hi=Math.imul(ah7,bh0),lo=lo+Math.imul(al6,bl1)|0,mid=(mid=mid+Math.imul(al6,bh1)|0)+Math.imul(ah6,bl1)|0,hi=hi+Math.imul(ah6,bh1)|0,lo=lo+Math.imul(al5,bl2)|0,mid=(mid=mid+Math.imul(al5,bh2)|0)+Math.imul(ah5,bl2)|0,hi=hi+Math.imul(ah5,bh2)|0,lo=lo+Math.imul(al4,bl3)|0,mid=(mid=mid+Math.imul(al4,bh3)|0)+Math.imul(ah4,bl3)|0,hi=hi+Math.imul(ah4,bh3)|0,lo=lo+Math.imul(al3,bl4)|0,mid=(mid=mid+Math.imul(al3,bh4)|0)+Math.imul(ah3,bl4)|0,hi=hi+Math.imul(ah3,bh4)|0,lo=lo+Math.imul(al2,bl5)|0,mid=(mid=mid+Math.imul(al2,bh5)|0)+Math.imul(ah2,bl5)|0,hi=hi+Math.imul(ah2,bh5)|0,lo=lo+Math.imul(al1,bl6)|0,mid=(mid=mid+Math.imul(al1,bh6)|0)+Math.imul(ah1,bl6)|0,hi=hi+Math.imul(ah1,bh6)|0;var w7=(c+(lo=lo+Math.imul(al0,bl7)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al0,bh7)|0)+Math.imul(ah0,bl7)|0))<<13)|0;c=((hi=hi+Math.imul(ah0,bh7)|0)+(mid>>>13)|0)+(w7>>>26)|0,w7&=67108863,lo=Math.imul(al8,bl0),mid=(mid=Math.imul(al8,bh0))+Math.imul(ah8,bl0)|0,hi=Math.imul(ah8,bh0),lo=lo+Math.imul(al7,bl1)|0,mid=(mid=mid+Math.imul(al7,bh1)|0)+Math.imul(ah7,bl1)|0,hi=hi+Math.imul(ah7,bh1)|0,lo=lo+Math.imul(al6,bl2)|0,mid=(mid=mid+Math.imul(al6,bh2)|0)+Math.imul(ah6,bl2)|0,hi=hi+Math.imul(ah6,bh2)|0,lo=lo+Math.imul(al5,bl3)|0,mid=(mid=mid+Math.imul(al5,bh3)|0)+Math.imul(ah5,bl3)|0,hi=hi+Math.imul(ah5,bh3)|0,lo=lo+Math.imul(al4,bl4)|0,mid=(mid=mid+Math.imul(al4,bh4)|0)+Math.imul(ah4,bl4)|0,hi=hi+Math.imul(ah4,bh4)|0,lo=lo+Math.imul(al3,bl5)|0,mid=(mid=mid+Math.imul(al3,bh5)|0)+Math.imul(ah3,bl5)|0,hi=hi+Math.imul(ah3,bh5)|0,lo=lo+Math.imul(al2,bl6)|0,mid=(mid=mid+Math.imul(al2,bh6)|0)+Math.imul(ah2,bl6)|0,hi=hi+Math.imul(ah2,bh6)|0,lo=lo+Math.imul(al1,bl7)|0,mid=(mid=mid+Math.imul(al1,bh7)|0)+Math.imul(ah1,bl7)|0,hi=hi+Math.imul(ah1,bh7)|0;var w8=(c+(lo=lo+Math.imul(al0,bl8)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al0,bh8)|0)+Math.imul(ah0,bl8)|0))<<13)|0;c=((hi=hi+Math.imul(ah0,bh8)|0)+(mid>>>13)|0)+(w8>>>26)|0,w8&=67108863,lo=Math.imul(al9,bl0),mid=(mid=Math.imul(al9,bh0))+Math.imul(ah9,bl0)|0,hi=Math.imul(ah9,bh0),lo=lo+Math.imul(al8,bl1)|0,mid=(mid=mid+Math.imul(al8,bh1)|0)+Math.imul(ah8,bl1)|0,hi=hi+Math.imul(ah8,bh1)|0,lo=lo+Math.imul(al7,bl2)|0,mid=(mid=mid+Math.imul(al7,bh2)|0)+Math.imul(ah7,bl2)|0,hi=hi+Math.imul(ah7,bh2)|0,lo=lo+Math.imul(al6,bl3)|0,mid=(mid=mid+Math.imul(al6,bh3)|0)+Math.imul(ah6,bl3)|0,hi=hi+Math.imul(ah6,bh3)|0,lo=lo+Math.imul(al5,bl4)|0,mid=(mid=mid+Math.imul(al5,bh4)|0)+Math.imul(ah5,bl4)|0,hi=hi+Math.imul(ah5,bh4)|0,lo=lo+Math.imul(al4,bl5)|0,mid=(mid=mid+Math.imul(al4,bh5)|0)+Math.imul(ah4,bl5)|0,hi=hi+Math.imul(ah4,bh5)|0,lo=lo+Math.imul(al3,bl6)|0,mid=(mid=mid+Math.imul(al3,bh6)|0)+Math.imul(ah3,bl6)|0,hi=hi+Math.imul(ah3,bh6)|0,lo=lo+Math.imul(al2,bl7)|0,mid=(mid=mid+Math.imul(al2,bh7)|0)+Math.imul(ah2,bl7)|0,hi=hi+Math.imul(ah2,bh7)|0,lo=lo+Math.imul(al1,bl8)|0,mid=(mid=mid+Math.imul(al1,bh8)|0)+Math.imul(ah1,bl8)|0,hi=hi+Math.imul(ah1,bh8)|0;var w9=(c+(lo=lo+Math.imul(al0,bl9)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al0,bh9)|0)+Math.imul(ah0,bl9)|0))<<13)|0;c=((hi=hi+Math.imul(ah0,bh9)|0)+(mid>>>13)|0)+(w9>>>26)|0,w9&=67108863,lo=Math.imul(al9,bl1),mid=(mid=Math.imul(al9,bh1))+Math.imul(ah9,bl1)|0,hi=Math.imul(ah9,bh1),lo=lo+Math.imul(al8,bl2)|0,mid=(mid=mid+Math.imul(al8,bh2)|0)+Math.imul(ah8,bl2)|0,hi=hi+Math.imul(ah8,bh2)|0,lo=lo+Math.imul(al7,bl3)|0,mid=(mid=mid+Math.imul(al7,bh3)|0)+Math.imul(ah7,bl3)|0,hi=hi+Math.imul(ah7,bh3)|0,lo=lo+Math.imul(al6,bl4)|0,mid=(mid=mid+Math.imul(al6,bh4)|0)+Math.imul(ah6,bl4)|0,hi=hi+Math.imul(ah6,bh4)|0,lo=lo+Math.imul(al5,bl5)|0,mid=(mid=mid+Math.imul(al5,bh5)|0)+Math.imul(ah5,bl5)|0,hi=hi+Math.imul(ah5,bh5)|0,lo=lo+Math.imul(al4,bl6)|0,mid=(mid=mid+Math.imul(al4,bh6)|0)+Math.imul(ah4,bl6)|0,hi=hi+Math.imul(ah4,bh6)|0,lo=lo+Math.imul(al3,bl7)|0,mid=(mid=mid+Math.imul(al3,bh7)|0)+Math.imul(ah3,bl7)|0,hi=hi+Math.imul(ah3,bh7)|0,lo=lo+Math.imul(al2,bl8)|0,mid=(mid=mid+Math.imul(al2,bh8)|0)+Math.imul(ah2,bl8)|0,hi=hi+Math.imul(ah2,bh8)|0;var w10=(c+(lo=lo+Math.imul(al1,bl9)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al1,bh9)|0)+Math.imul(ah1,bl9)|0))<<13)|0;c=((hi=hi+Math.imul(ah1,bh9)|0)+(mid>>>13)|0)+(w10>>>26)|0,w10&=67108863,lo=Math.imul(al9,bl2),mid=(mid=Math.imul(al9,bh2))+Math.imul(ah9,bl2)|0,hi=Math.imul(ah9,bh2),lo=lo+Math.imul(al8,bl3)|0,mid=(mid=mid+Math.imul(al8,bh3)|0)+Math.imul(ah8,bl3)|0,hi=hi+Math.imul(ah8,bh3)|0,lo=lo+Math.imul(al7,bl4)|0,mid=(mid=mid+Math.imul(al7,bh4)|0)+Math.imul(ah7,bl4)|0,hi=hi+Math.imul(ah7,bh4)|0,lo=lo+Math.imul(al6,bl5)|0,mid=(mid=mid+Math.imul(al6,bh5)|0)+Math.imul(ah6,bl5)|0,hi=hi+Math.imul(ah6,bh5)|0,lo=lo+Math.imul(al5,bl6)|0,mid=(mid=mid+Math.imul(al5,bh6)|0)+Math.imul(ah5,bl6)|0,hi=hi+Math.imul(ah5,bh6)|0,lo=lo+Math.imul(al4,bl7)|0,mid=(mid=mid+Math.imul(al4,bh7)|0)+Math.imul(ah4,bl7)|0,hi=hi+Math.imul(ah4,bh7)|0,lo=lo+Math.imul(al3,bl8)|0,mid=(mid=mid+Math.imul(al3,bh8)|0)+Math.imul(ah3,bl8)|0,hi=hi+Math.imul(ah3,bh8)|0;var w11=(c+(lo=lo+Math.imul(al2,bl9)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al2,bh9)|0)+Math.imul(ah2,bl9)|0))<<13)|0;c=((hi=hi+Math.imul(ah2,bh9)|0)+(mid>>>13)|0)+(w11>>>26)|0,w11&=67108863,lo=Math.imul(al9,bl3),mid=(mid=Math.imul(al9,bh3))+Math.imul(ah9,bl3)|0,hi=Math.imul(ah9,bh3),lo=lo+Math.imul(al8,bl4)|0,mid=(mid=mid+Math.imul(al8,bh4)|0)+Math.imul(ah8,bl4)|0,hi=hi+Math.imul(ah8,bh4)|0,lo=lo+Math.imul(al7,bl5)|0,mid=(mid=mid+Math.imul(al7,bh5)|0)+Math.imul(ah7,bl5)|0,hi=hi+Math.imul(ah7,bh5)|0,lo=lo+Math.imul(al6,bl6)|0,mid=(mid=mid+Math.imul(al6,bh6)|0)+Math.imul(ah6,bl6)|0,hi=hi+Math.imul(ah6,bh6)|0,lo=lo+Math.imul(al5,bl7)|0,mid=(mid=mid+Math.imul(al5,bh7)|0)+Math.imul(ah5,bl7)|0,hi=hi+Math.imul(ah5,bh7)|0,lo=lo+Math.imul(al4,bl8)|0,mid=(mid=mid+Math.imul(al4,bh8)|0)+Math.imul(ah4,bl8)|0,hi=hi+Math.imul(ah4,bh8)|0;var w12=(c+(lo=lo+Math.imul(al3,bl9)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al3,bh9)|0)+Math.imul(ah3,bl9)|0))<<13)|0;c=((hi=hi+Math.imul(ah3,bh9)|0)+(mid>>>13)|0)+(w12>>>26)|0,w12&=67108863,lo=Math.imul(al9,bl4),mid=(mid=Math.imul(al9,bh4))+Math.imul(ah9,bl4)|0,hi=Math.imul(ah9,bh4),lo=lo+Math.imul(al8,bl5)|0,mid=(mid=mid+Math.imul(al8,bh5)|0)+Math.imul(ah8,bl5)|0,hi=hi+Math.imul(ah8,bh5)|0,lo=lo+Math.imul(al7,bl6)|0,mid=(mid=mid+Math.imul(al7,bh6)|0)+Math.imul(ah7,bl6)|0,hi=hi+Math.imul(ah7,bh6)|0,lo=lo+Math.imul(al6,bl7)|0,mid=(mid=mid+Math.imul(al6,bh7)|0)+Math.imul(ah6,bl7)|0,hi=hi+Math.imul(ah6,bh7)|0,lo=lo+Math.imul(al5,bl8)|0,mid=(mid=mid+Math.imul(al5,bh8)|0)+Math.imul(ah5,bl8)|0,hi=hi+Math.imul(ah5,bh8)|0;var w13=(c+(lo=lo+Math.imul(al4,bl9)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al4,bh9)|0)+Math.imul(ah4,bl9)|0))<<13)|0;c=((hi=hi+Math.imul(ah4,bh9)|0)+(mid>>>13)|0)+(w13>>>26)|0,w13&=67108863,lo=Math.imul(al9,bl5),mid=(mid=Math.imul(al9,bh5))+Math.imul(ah9,bl5)|0,hi=Math.imul(ah9,bh5),lo=lo+Math.imul(al8,bl6)|0,mid=(mid=mid+Math.imul(al8,bh6)|0)+Math.imul(ah8,bl6)|0,hi=hi+Math.imul(ah8,bh6)|0,lo=lo+Math.imul(al7,bl7)|0,mid=(mid=mid+Math.imul(al7,bh7)|0)+Math.imul(ah7,bl7)|0,hi=hi+Math.imul(ah7,bh7)|0,lo=lo+Math.imul(al6,bl8)|0,mid=(mid=mid+Math.imul(al6,bh8)|0)+Math.imul(ah6,bl8)|0,hi=hi+Math.imul(ah6,bh8)|0;var w14=(c+(lo=lo+Math.imul(al5,bl9)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al5,bh9)|0)+Math.imul(ah5,bl9)|0))<<13)|0;c=((hi=hi+Math.imul(ah5,bh9)|0)+(mid>>>13)|0)+(w14>>>26)|0,w14&=67108863,lo=Math.imul(al9,bl6),mid=(mid=Math.imul(al9,bh6))+Math.imul(ah9,bl6)|0,hi=Math.imul(ah9,bh6),lo=lo+Math.imul(al8,bl7)|0,mid=(mid=mid+Math.imul(al8,bh7)|0)+Math.imul(ah8,bl7)|0,hi=hi+Math.imul(ah8,bh7)|0,lo=lo+Math.imul(al7,bl8)|0,mid=(mid=mid+Math.imul(al7,bh8)|0)+Math.imul(ah7,bl8)|0,hi=hi+Math.imul(ah7,bh8)|0;var w15=(c+(lo=lo+Math.imul(al6,bl9)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al6,bh9)|0)+Math.imul(ah6,bl9)|0))<<13)|0;c=((hi=hi+Math.imul(ah6,bh9)|0)+(mid>>>13)|0)+(w15>>>26)|0,w15&=67108863,lo=Math.imul(al9,bl7),mid=(mid=Math.imul(al9,bh7))+Math.imul(ah9,bl7)|0,hi=Math.imul(ah9,bh7),lo=lo+Math.imul(al8,bl8)|0,mid=(mid=mid+Math.imul(al8,bh8)|0)+Math.imul(ah8,bl8)|0,hi=hi+Math.imul(ah8,bh8)|0;var w16=(c+(lo=lo+Math.imul(al7,bl9)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al7,bh9)|0)+Math.imul(ah7,bl9)|0))<<13)|0;c=((hi=hi+Math.imul(ah7,bh9)|0)+(mid>>>13)|0)+(w16>>>26)|0,w16&=67108863,lo=Math.imul(al9,bl8),mid=(mid=Math.imul(al9,bh8))+Math.imul(ah9,bl8)|0,hi=Math.imul(ah9,bh8);var w17=(c+(lo=lo+Math.imul(al8,bl9)|0)|0)+((8191&(mid=(mid=mid+Math.imul(al8,bh9)|0)+Math.imul(ah8,bl9)|0))<<13)|0;c=((hi=hi+Math.imul(ah8,bh9)|0)+(mid>>>13)|0)+(w17>>>26)|0,w17&=67108863;var w18=(c+(lo=Math.imul(al9,bl9))|0)+((8191&(mid=(mid=Math.imul(al9,bh9))+Math.imul(ah9,bl9)|0))<<13)|0;return c=((hi=Math.imul(ah9,bh9))+(mid>>>13)|0)+(w18>>>26)|0,w18&=67108863,o[0]=w0,o[1]=w1,o[2]=w2,o[3]=w3,o[4]=w4,o[5]=w5,o[6]=w6,o[7]=w7,o[8]=w8,o[9]=w9,o[10]=w10,o[11]=w11,o[12]=w12,o[13]=w13,o[14]=w14,o[15]=w15,o[16]=w16,o[17]=w17,o[18]=w18,0!==c&&(o[19]=c,out.length++),out};function bigMulTo(self1,num,out){out.negative=num.negative^self1.negative,out.length=self1.length+num.length;for(var carry=0,hncarry=0,k=0;k<out.length-1;k++){var ncarry=hncarry;hncarry=0;for(var rword=67108863&carry,maxJ=Math.min(k,num.length-1),j=Math.max(0,k-self1.length+1);j<=maxJ;j++){var i=k-j,r=(0|self1.words[i])*(0|num.words[j]),lo=67108863&r;ncarry=ncarry+(r/67108864|0)|0,rword=67108863&(lo=lo+rword|0),hncarry+=(ncarry=ncarry+(lo>>>26)|0)>>>26,ncarry&=67108863}out.words[k]=rword,carry=ncarry,ncarry=hncarry}return 0!==carry?out.words[k]=carry:out.length--,out._strip()}function FFTM(x,y){this.x=x,this.y=y}Math.imul||(comb10MulTo=smallMulTo),BN.prototype.mulTo=function(num,out){var res,len=this.length+num.length;return 10===this.length&&10===num.length?comb10MulTo(this,num,out):len<63?smallMulTo(this,num,out):bigMulTo(this,num,out)},FFTM.prototype.makeRBT=function(N){for(var t=Array(N),l=BN.prototype._countBits(N)-1,i=0;i<N;i++)t[i]=this.revBin(i,l,N);return t},FFTM.prototype.revBin=function(x,l,N){if(0===x||x===N-1)return x;for(var rb=0,i=0;i<l;i++)rb|=(1&x)<<l-i-1,x>>=1;return rb},FFTM.prototype.permute=function(rbt,rws,iws,rtws,itws,N){for(var i=0;i<N;i++)rtws[i]=rws[rbt[i]],itws[i]=iws[rbt[i]]},FFTM.prototype.transform=function(rws,iws,rtws,itws,N,rbt){this.permute(rbt,rws,iws,rtws,itws,N);for(var s=1;s<N;s<<=1)for(var l=s<<1,rtwdf=Math.cos(2*Math.PI/l),itwdf=Math.sin(2*Math.PI/l),p=0;p<N;p+=l)for(var rtwdf_=rtwdf,itwdf_=itwdf,j=0;j<s;j++){var re=rtws[p+j],ie=itws[p+j],ro=rtws[p+j+s],io=itws[p+j+s],rx=rtwdf_*ro-itwdf_*io;io=rtwdf_*io+itwdf_*ro,ro=rx,rtws[p+j]=re+ro,itws[p+j]=ie+io,rtws[p+j+s]=re-ro,itws[p+j+s]=ie-io,j!==l&&(rx=rtwdf*rtwdf_-itwdf*itwdf_,itwdf_=rtwdf*itwdf_+itwdf*rtwdf_,rtwdf_=rx)}},FFTM.prototype.guessLen13b=function(n,m){var N=1|Math.max(m,n),odd=1&N,i=0;for(N=N/2|0;N;N>>>=1)i++;return 1<<i+1+odd},FFTM.prototype.conjugate=function(rws,iws,N){if(!(N<=1))for(var i=0;i<N/2;i++){var t=rws[i];rws[i]=rws[N-i-1],rws[N-i-1]=t,t=iws[i],iws[i]=-iws[N-i-1],iws[N-i-1]=-t}},FFTM.prototype.normalize13b=function(ws,N){for(var carry=0,i=0;i<N/2;i++){var w=8192*Math.round(ws[2*i+1]/N)+Math.round(ws[2*i]/N)+carry;ws[i]=67108863&w,carry=w<67108864?0:w/67108864|0}return ws},FFTM.prototype.convert13b=function(ws,len,rws,N){for(var carry=0,i=0;i<len;i++)carry+=0|ws[i],rws[2*i]=8191&carry,carry>>>=13,rws[2*i+1]=8191&carry,carry>>>=13;for(i=2*len;i<N;++i)rws[i]=0;assert(0===carry),assert((-8192&carry)==0)},FFTM.prototype.stub=function(N){for(var ph=Array(N),i=0;i<N;i++)ph[i]=0;return ph},FFTM.prototype.mulp=function(x,y,out){var N=2*this.guessLen13b(x.length,y.length),rbt=this.makeRBT(N),_=this.stub(N),rws=Array(N),rwst=Array(N),iwst=Array(N),nrws=Array(N),nrwst=Array(N),niwst=Array(N),rmws=out.words;rmws.length=N,this.convert13b(x.words,x.length,rws,N),this.convert13b(y.words,y.length,nrws,N),this.transform(rws,_,rwst,iwst,N,rbt),this.transform(nrws,_,nrwst,niwst,N,rbt);for(var i=0;i<N;i++){var rx=rwst[i]*nrwst[i]-iwst[i]*niwst[i];iwst[i]=rwst[i]*niwst[i]+iwst[i]*nrwst[i],rwst[i]=rx}return this.conjugate(rwst,iwst,N),this.transform(rwst,iwst,rmws,_,N,rbt),this.conjugate(rmws,_,N),this.normalize13b(rmws,N),out.negative=x.negative^y.negative,out.length=x.length+y.length,out._strip()},BN.prototype.mul=function(num){var out=new BN(null);return out.words=Array(this.length+num.length),this.mulTo(num,out)},BN.prototype.mulf=function(num){var out=new BN(null);return out.words=Array(this.length+num.length),bigMulTo(this,num,out)},BN.prototype.imul=function(num){return this.clone().mulTo(num,this)},BN.prototype.imuln=function(num){var isNegNum=num<0;isNegNum&&(num=-num),assert("number"==typeof num),assert(num<67108864);for(var carry=0,i=0;i<this.length;i++){var w=(0|this.words[i])*num,lo=(67108863&w)+(67108863&carry);carry>>=26,carry=(w/67108864|0)+(lo>>>26),this.words[i]=67108863&lo}return 0!==carry&&(this.words[i]=carry,this.length++),isNegNum?this.ineg():this},BN.prototype.muln=function(num){return this.clone().imuln(num)},BN.prototype.sqr=function(){return this.mul(this)},BN.prototype.isqr=function(){return this.imul(this.clone())},BN.prototype.pow=function(num){var w=function(num){for(var w=Array(num.bitLength()),bit=0;bit<w.length;bit++){var off=bit/26|0,wbit=bit%26;w[bit]=num.words[off]>>>wbit&1}return w}(num);if(0===w.length)return new BN(1);for(var res=this,i=0;i<w.length&&0===w[i];i++,res=res.sqr());if(++i<w.length)for(var q=res.sqr();i<w.length;i++,q=q.sqr())0!==w[i]&&(res=res.mul(q));return res},BN.prototype.iushln=function(bits){assert("number"==typeof bits&&bits>=0);var i,r=bits%26,s=(bits-r)/26,carryMask=67108863>>>26-r<<26-r;if(0!==r){var carry=0;for(i=0;i<this.length;i++){var newCarry=this.words[i]&carryMask,c=(0|this.words[i])-newCarry<<r;this.words[i]=c|carry,carry=newCarry>>>26-r}carry&&(this.words[i]=carry,this.length++)}if(0!==s){for(i=this.length-1;i>=0;i--)this.words[i+s]=this.words[i];for(i=0;i<s;i++)this.words[i]=0;this.length+=s}return this._strip()},BN.prototype.ishln=function(bits){return assert(0===this.negative),this.iushln(bits)},BN.prototype.iushrn=function(bits,hint,extended){assert("number"==typeof bits&&bits>=0),h=hint?(hint-hint%26)/26:0;var h,r=bits%26,s=Math.min((bits-r)/26,this.length),mask=67108863^67108863>>>r<<r,maskedWords=extended;if(h-=s,h=Math.max(0,h),maskedWords){for(var i=0;i<s;i++)maskedWords.words[i]=this.words[i];maskedWords.length=s}if(0===s);else if(this.length>s)for(this.length-=s,i=0;i<this.length;i++)this.words[i]=this.words[i+s];else this.words[0]=0,this.length=1;var carry=0;for(i=this.length-1;i>=0&&(0!==carry||i>=h);i--){var word=0|this.words[i];this.words[i]=carry<<26-r|word>>>r,carry=word&mask}return maskedWords&&0!==carry&&(maskedWords.words[maskedWords.length++]=carry),0===this.length&&(this.words[0]=0,this.length=1),this._strip()},BN.prototype.ishrn=function(bits,hint,extended){return assert(0===this.negative),this.iushrn(bits,hint,extended)},BN.prototype.shln=function(bits){return this.clone().ishln(bits)},BN.prototype.ushln=function(bits){return this.clone().iushln(bits)},BN.prototype.shrn=function(bits){return this.clone().ishrn(bits)},BN.prototype.ushrn=function(bits){return this.clone().iushrn(bits)},BN.prototype.testn=function(bit){assert("number"==typeof bit&&bit>=0);var r=bit%26,s=(bit-r)/26;return!(this.length<=s)&&!!(this.words[s]&1<<r)},BN.prototype.imaskn=function(bits){assert("number"==typeof bits&&bits>=0);var r=bits%26,s=(bits-r)/26;return(assert(0===this.negative,"imaskn works only with positive numbers"),this.length<=s)?this:(0!==r&&s++,this.length=Math.min(s,this.length),0!==r&&(this.words[this.length-1]&=67108863^67108863>>>r<<r),this._strip())},BN.prototype.maskn=function(bits){return this.clone().imaskn(bits)},BN.prototype.iaddn=function(num){return(assert("number"==typeof num),assert(num<67108864),num<0)?this.isubn(-num):0!==this.negative?1===this.length&&(0|this.words[0])<=num?(this.words[0]=num-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(num),this.negative=1,this):this._iaddn(num)},BN.prototype._iaddn=function(num){this.words[0]+=num;for(var i=0;i<this.length&&this.words[i]>=67108864;i++)this.words[i]-=67108864,i===this.length-1?this.words[i+1]=1:this.words[i+1]++;return this.length=Math.max(this.length,i+1),this},BN.prototype.isubn=function(num){if(assert("number"==typeof num),assert(num<67108864),num<0)return this.iaddn(-num);if(0!==this.negative)return this.negative=0,this.iaddn(num),this.negative=1,this;if(this.words[0]-=num,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var i=0;i<this.length&&this.words[i]<0;i++)this.words[i]+=67108864,this.words[i+1]-=1;return this._strip()},BN.prototype.addn=function(num){return this.clone().iaddn(num)},BN.prototype.subn=function(num){return this.clone().isubn(num)},BN.prototype.iabs=function(){return this.negative=0,this},BN.prototype.abs=function(){return this.clone().iabs()},BN.prototype._ishlnsubmul=function(num,mul,shift){var i,w,len=num.length+shift;this._expand(len);var carry=0;for(i=0;i<num.length;i++){w=(0|this.words[i+shift])+carry;var right=(0|num.words[i])*mul;w-=67108863&right,carry=(w>>26)-(right/67108864|0),this.words[i+shift]=67108863&w}for(;i<this.length-shift;i++)carry=(w=(0|this.words[i+shift])+carry)>>26,this.words[i+shift]=67108863&w;if(0===carry)return this._strip();for(assert(-1===carry),carry=0,i=0;i<this.length;i++)carry=(w=-(0|this.words[i])+carry)>>26,this.words[i]=67108863&w;return this.negative=1,this._strip()},BN.prototype._wordDiv=function(num,mode){var q,shift=this.length-num.length,a=this.clone(),b=num,bhi=0|b.words[b.length-1];0!=(shift=26-this._countBits(bhi))&&(b=b.ushln(shift),a.iushln(shift),bhi=0|b.words[b.length-1]);var m=a.length-b.length;if("mod"!==mode){(q=new BN(null)).length=m+1,q.words=Array(q.length);for(var i=0;i<q.length;i++)q.words[i]=0}var diff=a.clone()._ishlnsubmul(b,1,m);0===diff.negative&&(a=diff,q&&(q.words[m]=1));for(var j=m-1;j>=0;j--){var qj=(0|a.words[b.length+j])*67108864+(0|a.words[b.length+j-1]);for(qj=Math.min(qj/bhi|0,67108863),a._ishlnsubmul(b,qj,j);0!==a.negative;)qj--,a.negative=0,a._ishlnsubmul(b,1,j),a.isZero()||(a.negative^=1);q&&(q.words[j]=qj)}return q&&q._strip(),a._strip(),"div"!==mode&&0!==shift&&a.iushrn(shift),{div:q||null,mod:a}},BN.prototype.divmod=function(num,mode,positive){var div,mod,res;return(assert(!num.isZero()),this.isZero())?{div:new BN(0),mod:new BN(0)}:0!==this.negative&&0===num.negative?(res=this.neg().divmod(num,mode),"mod"!==mode&&(div=res.div.neg()),"div"!==mode&&(mod=res.mod.neg(),positive&&0!==mod.negative&&mod.iadd(num)),{div:div,mod:mod}):0===this.negative&&0!==num.negative?(res=this.divmod(num.neg(),mode),"mod"!==mode&&(div=res.div.neg()),{div:div,mod:res.mod}):(this.negative&num.negative)!=0?(res=this.neg().divmod(num.neg(),mode),"div"!==mode&&(mod=res.mod.neg(),positive&&0!==mod.negative&&mod.isub(num)),{div:res.div,mod:mod}):num.length>this.length||0>this.cmp(num)?{div:new BN(0),mod:this}:1===num.length?"div"===mode?{div:this.divn(num.words[0]),mod:null}:"mod"===mode?{div:null,mod:new BN(this.modrn(num.words[0]))}:{div:this.divn(num.words[0]),mod:new BN(this.modrn(num.words[0]))}:this._wordDiv(num,mode)},BN.prototype.div=function(num){return this.divmod(num,"div",!1).div},BN.prototype.mod=function(num){return this.divmod(num,"mod",!1).mod},BN.prototype.umod=function(num){return this.divmod(num,"mod",!0).mod},BN.prototype.divRound=function(num){var dm=this.divmod(num);if(dm.mod.isZero())return dm.div;var mod=0!==dm.div.negative?dm.mod.isub(num):dm.mod,half=num.ushrn(1),r2=num.andln(1),cmp=mod.cmp(half);return cmp<0||1===r2&&0===cmp?dm.div:0!==dm.div.negative?dm.div.isubn(1):dm.div.iaddn(1)},BN.prototype.modrn=function(num){var isNegNum=num<0;isNegNum&&(num=-num),assert(num<=67108863);for(var p=67108864%num,acc=0,i=this.length-1;i>=0;i--)acc=(p*acc+(0|this.words[i]))%num;return isNegNum?-acc:acc},BN.prototype.modn=function(num){return this.modrn(num)},BN.prototype.idivn=function(num){var isNegNum=num<0;isNegNum&&(num=-num),assert(num<=67108863);for(var carry=0,i=this.length-1;i>=0;i--){var w=(0|this.words[i])+67108864*carry;this.words[i]=w/num|0,carry=w%num}return this._strip(),isNegNum?this.ineg():this},BN.prototype.divn=function(num){return this.clone().idivn(num)},BN.prototype.egcd=function(p){assert(0===p.negative),assert(!p.isZero());var x=this,y=p.clone();x=0!==x.negative?x.umod(p):x.clone();for(var A=new BN(1),B=new BN(0),C=new BN(0),D=new BN(1),g=0;x.isEven()&&y.isEven();)x.iushrn(1),y.iushrn(1),++g;for(var yp=y.clone(),xp=x.clone();!x.isZero();){for(var i=0,im=1;(x.words[0]&im)==0&&i<26;++i,im<<=1);if(i>0)for(x.iushrn(i);i-- >0;)(A.isOdd()||B.isOdd())&&(A.iadd(yp),B.isub(xp)),A.iushrn(1),B.iushrn(1);for(var j=0,jm=1;(y.words[0]&jm)==0&&j<26;++j,jm<<=1);if(j>0)for(y.iushrn(j);j-- >0;)(C.isOdd()||D.isOdd())&&(C.iadd(yp),D.isub(xp)),C.iushrn(1),D.iushrn(1);x.cmp(y)>=0?(x.isub(y),A.isub(C),B.isub(D)):(y.isub(x),C.isub(A),D.isub(B))}return{a:C,b:D,gcd:y.iushln(g)}},BN.prototype._invmp=function(p){assert(0===p.negative),assert(!p.isZero());var res,a=this,b=p.clone();a=0!==a.negative?a.umod(p):a.clone();for(var x1=new BN(1),x2=new BN(0),delta=b.clone();a.cmpn(1)>0&&b.cmpn(1)>0;){for(var i=0,im=1;(a.words[0]&im)==0&&i<26;++i,im<<=1);if(i>0)for(a.iushrn(i);i-- >0;)x1.isOdd()&&x1.iadd(delta),x1.iushrn(1);for(var j=0,jm=1;(b.words[0]&jm)==0&&j<26;++j,jm<<=1);if(j>0)for(b.iushrn(j);j-- >0;)x2.isOdd()&&x2.iadd(delta),x2.iushrn(1);a.cmp(b)>=0?(a.isub(b),x1.isub(x2)):(b.isub(a),x2.isub(x1))}return 0>(res=0===a.cmpn(1)?x1:x2).cmpn(0)&&res.iadd(p),res},BN.prototype.gcd=function(num){if(this.isZero())return num.abs();if(num.isZero())return this.abs();var a=this.clone(),b=num.clone();a.negative=0,b.negative=0;for(var shift=0;a.isEven()&&b.isEven();shift++)a.iushrn(1),b.iushrn(1);for(;;){for(;a.isEven();)a.iushrn(1);for(;b.isEven();)b.iushrn(1);var r=a.cmp(b);if(r<0){var t=a;a=b,b=t}else if(0===r||0===b.cmpn(1))break;a.isub(b)}return b.iushln(shift)},BN.prototype.invm=function(num){return this.egcd(num).a.umod(num)},BN.prototype.isEven=function(){return(1&this.words[0])==0},BN.prototype.isOdd=function(){return(1&this.words[0])==1},BN.prototype.andln=function(num){return this.words[0]&num},BN.prototype.bincn=function(bit){assert("number"==typeof bit);var r=bit%26,s=(bit-r)/26,q=1<<r;if(this.length<=s)return this._expand(s+1),this.words[s]|=q,this;for(var carry=q,i=s;0!==carry&&i<this.length;i++){var w=0|this.words[i];w+=carry,carry=w>>>26,w&=67108863,this.words[i]=w}return 0!==carry&&(this.words[i]=carry,this.length++),this},BN.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},BN.prototype.cmpn=function(num){var res,negative=num<0;if(0!==this.negative&&!negative)return -1;if(0===this.negative&&negative)return 1;if(this._strip(),this.length>1)res=1;else{negative&&(num=-num),assert(num<=67108863,"Number is too big");var w=0|this.words[0];res=w===num?0:w<num?-1:1}return 0!==this.negative?0|-res:res},BN.prototype.cmp=function(num){if(0!==this.negative&&0===num.negative)return -1;if(0===this.negative&&0!==num.negative)return 1;var res=this.ucmp(num);return 0!==this.negative?0|-res:res},BN.prototype.ucmp=function(num){if(this.length>num.length)return 1;if(this.length<num.length)return -1;for(var res=0,i=this.length-1;i>=0;i--){var a=0|this.words[i],b=0|num.words[i];if(a!==b){a<b?res=-1:a>b&&(res=1);break}}return res},BN.prototype.gtn=function(num){return 1===this.cmpn(num)},BN.prototype.gt=function(num){return 1===this.cmp(num)},BN.prototype.gten=function(num){return this.cmpn(num)>=0},BN.prototype.gte=function(num){return this.cmp(num)>=0},BN.prototype.ltn=function(num){return -1===this.cmpn(num)},BN.prototype.lt=function(num){return -1===this.cmp(num)},BN.prototype.lten=function(num){return 0>=this.cmpn(num)},BN.prototype.lte=function(num){return 0>=this.cmp(num)},BN.prototype.eqn=function(num){return 0===this.cmpn(num)},BN.prototype.eq=function(num){return 0===this.cmp(num)},BN.red=function(num){return new Red(num)},BN.prototype.toRed=function(ctx){return assert(!this.red,"Already a number in reduction context"),assert(0===this.negative,"red works only with positives"),ctx.convertTo(this)._forceRed(ctx)},BN.prototype.fromRed=function(){return assert(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},BN.prototype._forceRed=function(ctx){return this.red=ctx,this},BN.prototype.forceRed=function(ctx){return assert(!this.red,"Already a number in reduction context"),this._forceRed(ctx)},BN.prototype.redAdd=function(num){return assert(this.red,"redAdd works only with red numbers"),this.red.add(this,num)},BN.prototype.redIAdd=function(num){return assert(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,num)},BN.prototype.redSub=function(num){return assert(this.red,"redSub works only with red numbers"),this.red.sub(this,num)},BN.prototype.redISub=function(num){return assert(this.red,"redISub works only with red numbers"),this.red.isub(this,num)},BN.prototype.redShl=function(num){return assert(this.red,"redShl works only with red numbers"),this.red.shl(this,num)},BN.prototype.redMul=function(num){return assert(this.red,"redMul works only with red numbers"),this.red._verify2(this,num),this.red.mul(this,num)},BN.prototype.redIMul=function(num){return assert(this.red,"redMul works only with red numbers"),this.red._verify2(this,num),this.red.imul(this,num)},BN.prototype.redSqr=function(){return assert(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},BN.prototype.redISqr=function(){return assert(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},BN.prototype.redSqrt=function(){return assert(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},BN.prototype.redInvm=function(){return assert(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},BN.prototype.redNeg=function(){return assert(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},BN.prototype.redPow=function(num){return assert(this.red&&!num.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,num)};var primes={k256:null,p224:null,p192:null,p25519:null};function MPrime(name,p){this.name=name,this.p=new BN(p,16),this.n=this.p.bitLength(),this.k=new BN(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function K256(){MPrime.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function P224(){MPrime.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function P192(){MPrime.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function P25519(){MPrime.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function Red(m){if("string"==typeof m){var prime=BN._prime(m);this.m=prime.p,this.prime=prime}else assert(m.gtn(1),"modulus must be greater than 1"),this.m=m,this.prime=null}function Mont(m){Red.call(this,m),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new BN(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}MPrime.prototype._tmp=function(){var tmp=new BN(null);return tmp.words=Array(Math.ceil(this.n/13)),tmp},MPrime.prototype.ireduce=function(num){var rlen,r=num;do this.split(r,this.tmp),rlen=(r=(r=this.imulK(r)).iadd(this.tmp)).bitLength();while(rlen>this.n);var cmp=rlen<this.n?-1:r.ucmp(this.p);return 0===cmp?(r.words[0]=0,r.length=1):cmp>0?r.isub(this.p):void 0!==r.strip?r.strip():r._strip(),r},MPrime.prototype.split=function(input,out){input.iushrn(this.n,0,out)},MPrime.prototype.imulK=function(num){return num.imul(this.k)},inherits(K256,MPrime),K256.prototype.split=function(input,output){for(var outLen=Math.min(input.length,9),i=0;i<outLen;i++)output.words[i]=input.words[i];if(output.length=outLen,input.length<=9){input.words[0]=0,input.length=1;return}var prev=input.words[9];for(i=10,output.words[output.length++]=4194303&prev;i<input.length;i++){var next=0|input.words[i];input.words[i-10]=(4194303&next)<<4|prev>>>22,prev=next}prev>>>=22,input.words[i-10]=prev,0===prev&&input.length>10?input.length-=10:input.length-=9},K256.prototype.imulK=function(num){num.words[num.length]=0,num.words[num.length+1]=0,num.length+=2;for(var lo=0,i=0;i<num.length;i++){var w=0|num.words[i];lo+=977*w,num.words[i]=67108863&lo,lo=64*w+(lo/67108864|0)}return 0===num.words[num.length-1]&&(num.length--,0===num.words[num.length-1]&&num.length--),num},inherits(P224,MPrime),inherits(P192,MPrime),inherits(P25519,MPrime),P25519.prototype.imulK=function(num){for(var carry=0,i=0;i<num.length;i++){var hi=(0|num.words[i])*19+carry,lo=67108863&hi;hi>>>=26,num.words[i]=lo,carry=hi}return 0!==carry&&(num.words[num.length++]=carry),num},BN._prime=function(name){var prime;if(primes[name])return primes[name];if("k256"===name)prime=new K256;else if("p224"===name)prime=new P224;else if("p192"===name)prime=new P192;else if("p25519"===name)prime=new P25519;else throw Error("Unknown prime "+name);return primes[name]=prime,prime},Red.prototype._verify1=function(a){assert(0===a.negative,"red works only with positives"),assert(a.red,"red works only with red numbers")},Red.prototype._verify2=function(a,b){assert((a.negative|b.negative)==0,"red works only with positives"),assert(a.red&&a.red===b.red,"red works only with red numbers")},Red.prototype.imod=function(a){return this.prime?this.prime.ireduce(a)._forceRed(this):(move(a,a.umod(this.m)._forceRed(this)),a)},Red.prototype.neg=function(a){return a.isZero()?a.clone():this.m.sub(a)._forceRed(this)},Red.prototype.add=function(a,b){this._verify2(a,b);var res=a.add(b);return res.cmp(this.m)>=0&&res.isub(this.m),res._forceRed(this)},Red.prototype.iadd=function(a,b){this._verify2(a,b);var res=a.iadd(b);return res.cmp(this.m)>=0&&res.isub(this.m),res},Red.prototype.sub=function(a,b){this._verify2(a,b);var res=a.sub(b);return 0>res.cmpn(0)&&res.iadd(this.m),res._forceRed(this)},Red.prototype.isub=function(a,b){this._verify2(a,b);var res=a.isub(b);return 0>res.cmpn(0)&&res.iadd(this.m),res},Red.prototype.shl=function(a,num){return this._verify1(a),this.imod(a.ushln(num))},Red.prototype.imul=function(a,b){return this._verify2(a,b),this.imod(a.imul(b))},Red.prototype.mul=function(a,b){return this._verify2(a,b),this.imod(a.mul(b))},Red.prototype.isqr=function(a){return this.imul(a,a.clone())},Red.prototype.sqr=function(a){return this.mul(a,a)},Red.prototype.sqrt=function(a){if(a.isZero())return a.clone();var mod3=this.m.andln(3);if(assert(mod3%2==1),3===mod3){var pow=this.m.add(new BN(1)).iushrn(2);return this.pow(a,pow)}for(var q=this.m.subn(1),s=0;!q.isZero()&&0===q.andln(1);)s++,q.iushrn(1);assert(!q.isZero());var one=new BN(1).toRed(this),nOne=one.redNeg(),lpow=this.m.subn(1).iushrn(1),z=this.m.bitLength();for(z=new BN(2*z*z).toRed(this);0!==this.pow(z,lpow).cmp(nOne);)z.redIAdd(nOne);for(var c=this.pow(z,q),r=this.pow(a,q.addn(1).iushrn(1)),t=this.pow(a,q),m=s;0!==t.cmp(one);){for(var tmp=t,i=0;0!==tmp.cmp(one);i++)tmp=tmp.redSqr();assert(i<m);var b=this.pow(c,new BN(1).iushln(m-i-1));r=r.redMul(b),c=b.redSqr(),t=t.redMul(c),m=i}return r},Red.prototype.invm=function(a){var inv=a._invmp(this.m);return 0!==inv.negative?(inv.negative=0,this.imod(inv).redNeg()):this.imod(inv)},Red.prototype.pow=function(a,num){if(num.isZero())return new BN(1).toRed(this);if(0===num.cmpn(1))return a.clone();var wnd=Array(16);wnd[0]=new BN(1).toRed(this),wnd[1]=a;for(var i=2;i<wnd.length;i++)wnd[i]=this.mul(wnd[i-1],a);var res=wnd[0],current=0,currentLen=0,start=num.bitLength()%26;for(0===start&&(start=26),i=num.length-1;i>=0;i--){for(var word=num.words[i],j=start-1;j>=0;j--){var bit=word>>j&1;if(res!==wnd[0]&&(res=this.sqr(res)),0===bit&&0===current){currentLen=0;continue}current<<=1,current|=bit,(4==++currentLen||0===i&&0===j)&&(res=this.mul(res,wnd[current]),currentLen=0,current=0)}start=26}return res},Red.prototype.convertTo=function(num){var r=num.umod(this.m);return r===num?r.clone():r},Red.prototype.convertFrom=function(num){var res=num.clone();return res.red=null,res},BN.mont=function(num){return new Mont(num)},inherits(Mont,Red),Mont.prototype.convertTo=function(num){return this.imod(num.ushln(this.shift))},Mont.prototype.convertFrom=function(num){var r=this.imod(num.mul(this.rinv));return r.red=null,r},Mont.prototype.imul=function(a,b){if(a.isZero()||b.isZero())return a.words[0]=0,a.length=1,a;var t=a.imul(b),c=t.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),u=t.isub(c).iushrn(this.shift),res=u;return u.cmp(this.m)>=0?res=u.isub(this.m):0>u.cmpn(0)&&(res=u.iadd(this.m)),res._forceRed(this)},Mont.prototype.mul=function(a,b){if(a.isZero()||b.isZero())return new BN(0)._forceRed(this);var t=a.mul(b),c=t.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),u=t.isub(c).iushrn(this.shift),res=u;return u.cmp(this.m)>=0?res=u.isub(this.m):0>u.cmpn(0)&&(res=u.iadd(this.m)),res._forceRed(this)},Mont.prototype.invm=function(a){return this.imod(a._invmp(this.m).mul(this.r2))._forceRed(this)}}(module=__webpack_require__.nmd(module),this)},46114:function(__unused_webpack_module,exports,__webpack_require__){"use strict";var Buffer=__webpack_require__(48764).Buffer,__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.isZeroAddress=exports.zeroAddress=exports.importPublic=exports.privateToAddress=exports.privateToPublic=exports.publicToAddress=exports.pubToAddress=exports.isValidPublic=exports.isValidPrivate=exports.generateAddress2=exports.generateAddress=exports.isValidChecksumAddress=exports.toChecksumAddress=exports.isValidAddress=exports.Account=void 0;var assert_1=__importDefault(__webpack_require__(69282)),externals_1=__webpack_require__(50523),secp256k1_1=__webpack_require__(95053),internal_1=__webpack_require__(60571),constants_1=__webpack_require__(16397),bytes_1=__webpack_require__(47107),hash_1=__webpack_require__(91207),helpers_1=__webpack_require__(3323),types_1=__webpack_require__(89260),Account=function(){function Account(nonce,balance,stateRoot,codeHash){void 0===nonce&&(nonce=new externals_1.BN(0)),void 0===balance&&(balance=new externals_1.BN(0)),void 0===stateRoot&&(stateRoot=constants_1.KECCAK256_RLP),void 0===codeHash&&(codeHash=constants_1.KECCAK256_NULL),this.nonce=nonce,this.balance=balance,this.stateRoot=stateRoot,this.codeHash=codeHash,this._validate()}return Account.fromAccountData=function(accountData){var nonce=accountData.nonce,balance=accountData.balance,stateRoot=accountData.stateRoot,codeHash=accountData.codeHash;return new Account(nonce?new externals_1.BN((0,bytes_1.toBuffer)(nonce)):void 0,balance?new externals_1.BN((0,bytes_1.toBuffer)(balance)):void 0,stateRoot?(0,bytes_1.toBuffer)(stateRoot):void 0,codeHash?(0,bytes_1.toBuffer)(codeHash):void 0)},Account.fromRlpSerializedAccount=function(serialized){var values=externals_1.rlp.decode(serialized);if(!Array.isArray(values))throw Error("Invalid serialized account input. Must be array");return this.fromValuesArray(values)},Account.fromValuesArray=function(values){var _a=__read(values,4),nonce=_a[0],balance=_a[1],stateRoot=_a[2],codeHash=_a[3];return new Account(new externals_1.BN(nonce),new externals_1.BN(balance),stateRoot,codeHash)},Account.prototype._validate=function(){if(this.nonce.lt(new externals_1.BN(0)))throw Error("nonce must be greater than zero");if(this.balance.lt(new externals_1.BN(0)))throw Error("balance must be greater than zero");if(32!==this.stateRoot.length)throw Error("stateRoot must have a length of 32");if(32!==this.codeHash.length)throw Error("codeHash must have a length of 32")},Account.prototype.raw=function(){return[(0,types_1.bnToUnpaddedBuffer)(this.nonce),(0,types_1.bnToUnpaddedBuffer)(this.balance),this.stateRoot,this.codeHash]},Account.prototype.serialize=function(){return externals_1.rlp.encode(this.raw())},Account.prototype.isContract=function(){return!this.codeHash.equals(constants_1.KECCAK256_NULL)},Account.prototype.isEmpty=function(){return this.balance.isZero()&&this.nonce.isZero()&&this.codeHash.equals(constants_1.KECCAK256_NULL)},Account}();exports.Account=Account,exports.isValidAddress=function(hexAddress){try{(0,helpers_1.assertIsString)(hexAddress)}catch(e){return!1}return/^0x[0-9a-fA-F]{40}$/.test(hexAddress)},exports.toChecksumAddress=function(hexAddress,eip1191ChainId){(0,helpers_1.assertIsHexString)(hexAddress);var address=(0,internal_1.stripHexPrefix)(hexAddress).toLowerCase(),prefix="";eip1191ChainId&&(prefix=(0,types_1.toType)(eip1191ChainId,types_1.TypeOutput.BN).toString()+"0x");for(var hash=(0,hash_1.keccakFromString)(prefix+address).toString("hex"),ret="0x",i=0;i<address.length;i++)parseInt(hash[i],16)>=8?ret+=address[i].toUpperCase():ret+=address[i];return ret},exports.isValidChecksumAddress=function(hexAddress,eip1191ChainId){return(0,exports.isValidAddress)(hexAddress)&&(0,exports.toChecksumAddress)(hexAddress,eip1191ChainId)===hexAddress},exports.generateAddress=function(from,nonce){(0,helpers_1.assertIsBuffer)(from),(0,helpers_1.assertIsBuffer)(nonce);var nonceBN=new externals_1.BN(nonce);return nonceBN.isZero()?(0,hash_1.rlphash)([from,null]).slice(-20):(0,hash_1.rlphash)([from,Buffer.from(nonceBN.toArray())]).slice(-20)},exports.generateAddress2=function(from,salt,initCode){return(0,helpers_1.assertIsBuffer)(from),(0,helpers_1.assertIsBuffer)(salt),(0,helpers_1.assertIsBuffer)(initCode),(0,assert_1.default)(20===from.length),(0,assert_1.default)(32===salt.length),(0,hash_1.keccak256)(Buffer.concat([Buffer.from("ff","hex"),from,salt,(0,hash_1.keccak256)(initCode)])).slice(-20)},exports.isValidPrivate=function(privateKey){return(0,secp256k1_1.privateKeyVerify)(privateKey)},exports.isValidPublic=function(publicKey,sanitize){return(void 0===sanitize&&(sanitize=!1),(0,helpers_1.assertIsBuffer)(publicKey),64===publicKey.length)?(0,secp256k1_1.publicKeyVerify)(Buffer.concat([Buffer.from([4]),publicKey])):!!sanitize&&(0,secp256k1_1.publicKeyVerify)(publicKey)},exports.pubToAddress=function(pubKey,sanitize){return void 0===sanitize&&(sanitize=!1),(0,helpers_1.assertIsBuffer)(pubKey),sanitize&&64!==pubKey.length&&(pubKey=Buffer.from((0,secp256k1_1.publicKeyConvert)(pubKey,!1).slice(1))),(0,assert_1.default)(64===pubKey.length),(0,hash_1.keccak)(pubKey).slice(-20)},exports.publicToAddress=exports.pubToAddress,exports.privateToPublic=function(privateKey){return(0,helpers_1.assertIsBuffer)(privateKey),Buffer.from((0,secp256k1_1.publicKeyCreate)(privateKey,!1)).slice(1)},exports.privateToAddress=function(privateKey){return(0,exports.publicToAddress)((0,exports.privateToPublic)(privateKey))},exports.importPublic=function(publicKey){return(0,helpers_1.assertIsBuffer)(publicKey),64!==publicKey.length&&(publicKey=Buffer.from((0,secp256k1_1.publicKeyConvert)(publicKey,!1).slice(1))),publicKey},exports.zeroAddress=function(){var addr=(0,bytes_1.zeros)(20);return(0,bytes_1.bufferToHex)(addr)},exports.isZeroAddress=function(hexAddress){try{(0,helpers_1.assertIsString)(hexAddress)}catch(e){return!1}return(0,exports.zeroAddress)()===hexAddress}},75770:function(__unused_webpack_module,exports,__webpack_require__){"use strict";var Buffer=__webpack_require__(48764).Buffer,__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Address=void 0;var assert_1=__importDefault(__webpack_require__(69282)),externals_1=__webpack_require__(50523),bytes_1=__webpack_require__(47107),account_1=__webpack_require__(46114),Address=function(){function Address(buf){(0,assert_1.default)(20===buf.length,"Invalid address length"),this.buf=buf}return Address.zero=function(){return new Address((0,bytes_1.zeros)(20))},Address.fromString=function(str){return(0,assert_1.default)((0,account_1.isValidAddress)(str),"Invalid address"),new Address((0,bytes_1.toBuffer)(str))},Address.fromPublicKey=function(pubKey){(0,assert_1.default)(Buffer.isBuffer(pubKey),"Public key should be Buffer");var buf=(0,account_1.pubToAddress)(pubKey);return new Address(buf)},Address.fromPrivateKey=function(privateKey){(0,assert_1.default)(Buffer.isBuffer(privateKey),"Private key should be Buffer");var buf=(0,account_1.privateToAddress)(privateKey);return new Address(buf)},Address.generate=function(from,nonce){return(0,assert_1.default)(externals_1.BN.isBN(nonce)),new Address((0,account_1.generateAddress)(from.buf,nonce.toArrayLike(Buffer)))},Address.generate2=function(from,salt,initCode){return(0,assert_1.default)(Buffer.isBuffer(salt)),(0,assert_1.default)(Buffer.isBuffer(initCode)),new Address((0,account_1.generateAddress2)(from.buf,salt,initCode))},Address.prototype.equals=function(address){return this.buf.equals(address.buf)},Address.prototype.isZero=function(){return this.equals(Address.zero())},Address.prototype.isPrecompileOrSystemAddress=function(){var addressBN=new externals_1.BN(this.buf),rangeMin=new externals_1.BN(0),rangeMax=new externals_1.BN("ffff","hex");return addressBN.gte(rangeMin)&&addressBN.lte(rangeMax)},Address.prototype.toString=function(){return"0x"+this.buf.toString("hex")},Address.prototype.toBuffer=function(){return Buffer.from(this.buf)},Address}();exports.Address=Address},47107:function(__unused_webpack_module,exports,__webpack_require__){"use strict";var Buffer=__webpack_require__(48764).Buffer,__values=this&&this.__values||function(o){var s="function"==typeof Symbol&&Symbol.iterator,m=s&&o[s],i=0;if(m)return m.call(o);if(o&&"number"==typeof o.length)return{next:function(){return o&&i>=o.length&&(o=void 0),{value:o&&o[i++],done:!o}}};throw TypeError(s?"Object is not iterable.":"Symbol.iterator is not defined.")},__read=this&&this.__read||function(o,n){var m="function"==typeof Symbol&&o[Symbol.iterator];if(!m)return o;var r,e,i=m.call(o),ar=[];try{for(;(void 0===n||n-- >0)&&!(r=i.next()).done;)ar.push(r.value)}catch(error){e={error:error}}finally{try{r&&!r.done&&(m=i.return)&&m.call(i)}finally{if(e)throw e.error}}return ar};Object.defineProperty(exports,"__esModule",{value:!0}),exports.bufArrToArr=exports.arrToBufArr=exports.validateNoLeadingZeroes=exports.baToJSON=exports.toUtf8=exports.addHexPrefix=exports.toUnsigned=exports.fromSigned=exports.bufferToHex=exports.bufferToInt=exports.toBuffer=exports.unpadHexString=exports.unpadArray=exports.unpadBuffer=exports.setLengthRight=exports.setLengthLeft=exports.zeros=exports.intToBuffer=exports.intToHex=void 0;var externals_1=__webpack_require__(50523),internal_1=__webpack_require__(60571),helpers_1=__webpack_require__(3323);exports.intToHex=function(i){if(!Number.isSafeInteger(i)||i<0)throw Error("Received an invalid integer type: ".concat(i));return"0x".concat(i.toString(16))},exports.intToBuffer=function(i){var hex=(0,exports.intToHex)(i);return Buffer.from((0,internal_1.padToEven)(hex.slice(2)),"hex")},exports.zeros=function(bytes){return Buffer.allocUnsafe(bytes).fill(0)};var setLength=function(msg,length,right){var buf=(0,exports.zeros)(length);return right?msg.length<length?(msg.copy(buf),buf):msg.slice(0,length):msg.length<length?(msg.copy(buf,length-msg.length),buf):msg.slice(-length)};exports.setLengthLeft=function(msg,length){return(0,helpers_1.assertIsBuffer)(msg),setLength(msg,length,!1)},exports.setLengthRight=function(msg,length){return(0,helpers_1.assertIsBuffer)(msg),setLength(msg,length,!0)};var stripZeros=function(a){for(var first=a[0];a.length>0&&"0"===first.toString();)first=(a=a.slice(1))[0];return a};exports.unpadBuffer=function(a){return(0,helpers_1.assertIsBuffer)(a),stripZeros(a)},exports.unpadArray=function(a){return(0,helpers_1.assertIsArray)(a),stripZeros(a)},exports.unpadHexString=function(a){return(0,helpers_1.assertIsHexString)(a),stripZeros(a=(0,internal_1.stripHexPrefix)(a))},exports.toBuffer=function(v){if(null==v)return Buffer.allocUnsafe(0);if(Buffer.isBuffer(v)||Array.isArray(v)||v instanceof Uint8Array)return Buffer.from(v);if("string"==typeof v){if(!(0,internal_1.isHexString)(v))throw Error("Cannot convert string to buffer. toBuffer only supports 0x-prefixed hex strings and this string was given: ".concat(v));return Buffer.from((0,internal_1.padToEven)((0,internal_1.stripHexPrefix)(v)),"hex")}if("number"==typeof v)return(0,exports.intToBuffer)(v);if(externals_1.BN.isBN(v)){if(v.isNeg())throw Error("Cannot convert negative BN to buffer. Given: ".concat(v));return v.toArrayLike(Buffer)}if(v.toArray)return Buffer.from(v.toArray());if(v.toBuffer)return Buffer.from(v.toBuffer());throw Error("invalid type")},exports.bufferToInt=function(buf){return new externals_1.BN((0,exports.toBuffer)(buf)).toNumber()},exports.bufferToHex=function(buf){return"0x"+(buf=(0,exports.toBuffer)(buf)).toString("hex")},exports.fromSigned=function(num){return new externals_1.BN(num).fromTwos(256)},exports.toUnsigned=function(num){return Buffer.from(num.toTwos(256).toArray())},exports.addHexPrefix=function(str){return"string"!=typeof str?str:(0,internal_1.isHexPrefixed)(str)?str:"0x"+str},exports.toUtf8=function(hex){if((hex=(0,internal_1.stripHexPrefix)(hex)).length%2!=0)throw Error("Invalid non-even hex string input for toUtf8() provided");return Buffer.from(hex.replace(/^(00)+|(00)+$/g,""),"hex").toString("utf8")},exports.baToJSON=function(ba){if(Buffer.isBuffer(ba))return"0x".concat(ba.toString("hex"));if(ba instanceof Array){for(var array=[],i=0;i<ba.length;i++)array.push((0,exports.baToJSON)(ba[i]));return array}},exports.validateNoLeadingZeroes=function(values){var e_1,_a;try{for(var _b=__values(Object.entries(values)),_c=_b.next();!_c.done;_c=_b.next()){var _d=__read(_c.value,2),k=_d[0],v=_d[1];if(void 0!==v&&v.length>0&&0===v[0])throw Error("".concat(k," cannot have leading zeroes, received: ").concat(v.toString("hex")))}}catch(e_1_1){e_1={error:e_1_1}}finally{try{_c&&!_c.done&&(_a=_b.return)&&_a.call(_b)}finally{if(e_1)throw e_1.error}}},exports.arrToBufArr=function arrToBufArr(arr){return Array.isArray(arr)?arr.map(function(a){return arrToBufArr(a)}):Buffer.from(arr)},exports.bufArrToArr=function bufArrToArr(arr){return Array.isArray(arr)?arr.map(function(a){return bufArrToArr(a)}):Uint8Array.from(null!=arr?arr:[])}},16397:function(__unused_webpack_module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.KECCAK256_RLP=exports.KECCAK256_RLP_S=exports.KECCAK256_RLP_ARRAY=exports.KECCAK256_RLP_ARRAY_S=exports.KECCAK256_NULL=exports.KECCAK256_NULL_S=exports.TWO_POW256=exports.MAX_INTEGER=exports.MAX_UINT64=void 0;var buffer_1=__webpack_require__(48764),externals_1=__webpack_require__(50523);exports.MAX_UINT64=new externals_1.BN("ffffffffffffffff",16),exports.MAX_INTEGER=new externals_1.BN("ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",16),exports.TWO_POW256=new externals_1.BN("10000000000000000000000000000000000000000000000000000000000000000",16),exports.KECCAK256_NULL_S="c5d2460186f7233c927e7db2dcc703c0e500b653ca82273b7bfad8045d85a470",exports.KECCAK256_NULL=buffer_1.Buffer.from(exports.KECCAK256_NULL_S,"hex"),exports.KECCAK256_RLP_ARRAY_S="1dcc4de8dec75d7aab85b567b6ccd41ad312451b948a7413f0a142fd40d49347",exports.KECCAK256_RLP_ARRAY=buffer_1.Buffer.from(exports.KECCAK256_RLP_ARRAY_S,"hex"),exports.KECCAK256_RLP_S="56e81f171bcc55a6ff8345e692c0f86e5b48e01b996cadc001622fb5e363b421",exports.KECCAK256_RLP=buffer_1.Buffer.from(exports.KECCAK256_RLP_S,"hex")},50523:function(__unused_webpack_module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable))&&(desc={enumerable:!0,get:function(){return m[k]}}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__setModuleDefault=this&&this.__setModuleDefault||(Object.create?function(o,v){Object.defineProperty(o,"default",{enumerable:!0,value:v})}:function(o,v){o.default=v}),__importStar=this&&this.__importStar||function(mod){if(mod&&mod.__esModule)return mod;var result={};if(null!=mod)for(var k in mod)"default"!==k&&Object.prototype.hasOwnProperty.call(mod,k)&&__createBinding(result,mod,k);return __setModuleDefault(result,mod),result},__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.rlp=exports.BN=void 0;var bn_js_1=__importDefault(__webpack_require__(14518));exports.BN=bn_js_1.default;var rlp=__importStar(__webpack_require__(51675));exports.rlp=rlp},91207:function(__unused_webpack_module,exports,__webpack_require__){"use strict";var Buffer=__webpack_require__(48764).Buffer;Object.defineProperty(exports,"__esModule",{value:!0}),exports.rlphash=exports.ripemd160FromArray=exports.ripemd160FromString=exports.ripemd160=exports.sha256FromArray=exports.sha256FromString=exports.sha256=exports.keccakFromArray=exports.keccakFromHexString=exports.keccakFromString=exports.keccak256=exports.keccak=void 0;var keccak_1=__webpack_require__(82192),createHash=__webpack_require__(23482),externals_1=__webpack_require__(50523),bytes_1=__webpack_require__(47107),helpers_1=__webpack_require__(3323);exports.keccak=function(a,bits){switch(void 0===bits&&(bits=256),(0,helpers_1.assertIsBuffer)(a),bits){case 224:return(0,keccak_1.keccak224)(a);case 256:return(0,keccak_1.keccak256)(a);case 384:return(0,keccak_1.keccak384)(a);case 512:return(0,keccak_1.keccak512)(a);default:throw Error("Invald algorithm: keccak".concat(bits))}},exports.keccak256=function(a){return(0,exports.keccak)(a)},exports.keccakFromString=function(a,bits){void 0===bits&&(bits=256),(0,helpers_1.assertIsString)(a);var buf=Buffer.from(a,"utf8");return(0,exports.keccak)(buf,bits)},exports.keccakFromHexString=function(a,bits){return void 0===bits&&(bits=256),(0,helpers_1.assertIsHexString)(a),(0,exports.keccak)((0,bytes_1.toBuffer)(a),bits)},exports.keccakFromArray=function(a,bits){return void 0===bits&&(bits=256),(0,helpers_1.assertIsArray)(a),(0,exports.keccak)((0,bytes_1.toBuffer)(a),bits)};var _sha256=function(a){return a=(0,bytes_1.toBuffer)(a),createHash("sha256").update(a).digest()};exports.sha256=function(a){return(0,helpers_1.assertIsBuffer)(a),_sha256(a)},exports.sha256FromString=function(a){return(0,helpers_1.assertIsString)(a),_sha256(a)},exports.sha256FromArray=function(a){return(0,helpers_1.assertIsArray)(a),_sha256(a)};var _ripemd160=function(a,padded){a=(0,bytes_1.toBuffer)(a);var hash=createHash("rmd160").update(a).digest();return!0===padded?(0,bytes_1.setLengthLeft)(hash,32):hash};exports.ripemd160=function(a,padded){return(0,helpers_1.assertIsBuffer)(a),_ripemd160(a,padded)},exports.ripemd160FromString=function(a,padded){return(0,helpers_1.assertIsString)(a),_ripemd160(a,padded)},exports.ripemd160FromArray=function(a,padded){return(0,helpers_1.assertIsArray)(a),_ripemd160(a,padded)},exports.rlphash=function(a){return(0,exports.keccak)(externals_1.rlp.encode(a))}},3323:function(__unused_webpack_module,exports,__webpack_require__){"use strict";var Buffer=__webpack_require__(48764).Buffer;Object.defineProperty(exports,"__esModule",{value:!0}),exports.assertIsString=exports.assertIsArray=exports.assertIsBuffer=exports.assertIsHexString=void 0;var internal_1=__webpack_require__(60571);exports.assertIsHexString=function(input){if(!(0,internal_1.isHexString)(input))throw Error("This method only supports 0x-prefixed hex strings but input was: ".concat(input))},exports.assertIsBuffer=function(input){if(!Buffer.isBuffer(input))throw Error("This method only supports Buffer but input was: ".concat(input))},exports.assertIsArray=function(input){if(!Array.isArray(input))throw Error("This method only supports number arrays but input was: ".concat(input))},exports.assertIsString=function(input){if("string"!=typeof input)throw Error("This method only supports strings but input was: ".concat(input))}},53934:function(__unused_webpack_module,exports,__webpack_require__){"use strict";var __createBinding=this&&this.__createBinding||(Object.create?function(o,m,k,k2){void 0===k2&&(k2=k);var desc=Object.getOwnPropertyDescriptor(m,k);(!desc||("get"in desc?!m.__esModule:desc.writable||desc.configurable))&&(desc={enumerable:!0,get:function(){return m[k]}}),Object.defineProperty(o,k2,desc)}:function(o,m,k,k2){void 0===k2&&(k2=k),o[k2]=m[k]}),__exportStar=this&&this.__exportStar||function(m,exports){for(var p in m)"default"===p||Object.prototype.hasOwnProperty.call(exports,p)||__createBinding(exports,m,p)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.isHexString=exports.getKeys=exports.fromAscii=exports.fromUtf8=exports.toAscii=exports.arrayContainsArray=exports.getBinarySize=exports.padToEven=exports.stripHexPrefix=exports.isHexPrefixed=void 0,__exportStar(__webpack_require__(16397),exports),__exportStar(__webpack_require__(46114),exports),__exportStar(__webpack_require__(75770),exports),__exportStar(__webpack_require__(91207),exports),__exportStar(__webpack_require__(3077),exports),__exportStar(__webpack_require__(47107),exports),__exportStar(__webpack_require__(9211),exports),__exportStar(__webpack_require__(50523),exports),__exportStar(__webpack_require__(89260),exports);var internal_1=__webpack_require__(60571);Object.defineProperty(exports,"isHexPrefixed",{enumerable:!0,get:function(){return internal_1.isHexPrefixed}}),Object.defineProperty(exports,"stripHexPrefix",{enumerable:!0,get:function(){return internal_1.stripHexPrefix}}),Object.defineProperty(exports,"padToEven",{enumerable:!0,get:function(){return internal_1.padToEven}}),Object.defineProperty(exports,"getBinarySize",{enumerable:!0,get:function(){return internal_1.getBinarySize}}),Object.defineProperty(exports,"arrayContainsArray",{enumerable:!0,get:function(){return internal_1.arrayContainsArray}}),Object.defineProperty(exports,"toAscii",{enumerable:!0,get:function(){return internal_1.toAscii}}),Object.defineProperty(exports,"fromUtf8",{enumerable:!0,get:function(){return internal_1.fromUtf8}}),Object.defineProperty(exports,"fromAscii",{enumerable:!0,get:function(){return internal_1.fromAscii}}),Object.defineProperty(exports,"getKeys",{enumerable:!0,get:function(){return internal_1.getKeys}}),Object.defineProperty(exports,"isHexString",{enumerable:!0,get:function(){return internal_1.isHexString}})},60571:function(__unused_webpack_module,exports,__webpack_require__){"use strict";var Buffer=__webpack_require__(48764).Buffer;function isHexPrefixed(str){if("string"!=typeof str)throw Error("[isHexPrefixed] input must be type 'string', received type ".concat(typeof str));return"0"===str[0]&&"x"===str[1]}function padToEven(value){var a=value;if("string"!=typeof a)throw Error("[padToEven] value must be type 'string', received ".concat(typeof a));return a.length%2&&(a="0".concat(a)),a}Object.defineProperty(exports,"__esModule",{value:!0}),exports.isHexString=exports.getKeys=exports.fromAscii=exports.fromUtf8=exports.toAscii=exports.arrayContainsArray=exports.getBinarySize=exports.padToEven=exports.stripHexPrefix=exports.isHexPrefixed=void 0,exports.isHexPrefixed=isHexPrefixed,exports.stripHexPrefix=function(str){if("string"!=typeof str)throw Error("[stripHexPrefix] input must be type 'string', received ".concat(typeof str));return isHexPrefixed(str)?str.slice(2):str},exports.padToEven=padToEven,exports.getBinarySize=function(str){if("string"!=typeof str)throw Error("[getBinarySize] method requires input type 'string', recieved ".concat(typeof str));return Buffer.byteLength(str,"utf8")},exports.arrayContainsArray=function(superset,subset,some){if(!0!==Array.isArray(superset))throw Error("[arrayContainsArray] method requires input 'superset' to be an array, got type '".concat(typeof superset,"'"));if(!0!==Array.isArray(subset))throw Error("[arrayContainsArray] method requires input 'subset' to be an array, got type '".concat(typeof subset,"'"));return subset[some?"some":"every"](function(value){return superset.indexOf(value)>=0})},exports.toAscii=function(hex){var str="",i=0,l=hex.length;for("0x"===hex.substring(0,2)&&(i=2);i<l;i+=2)str+=String.fromCharCode(parseInt(hex.substr(i,2),16));return str},exports.fromUtf8=function(stringValue){var str=Buffer.from(stringValue,"utf8");return"0x".concat(padToEven(str.toString("hex")).replace(/^0+|0+$/g,""))},exports.fromAscii=function(stringValue){for(var hex="",i=0;i<stringValue.length;i++){var n=stringValue.charCodeAt(i).toString(16);hex+=n.length<2?"0".concat(n):n}return"0x".concat(hex)},exports.getKeys=function(params,key,allowEmpty){if(!Array.isArray(params))throw Error("[getKeys] method expects input 'params' to be an array, got ".concat(typeof params));if("string"!=typeof key)throw Error("[getKeys] method expects input 'key' to be type 'string', got ".concat(typeof params));for(var result=[],i=0;i<params.length;i++){var value=params[i][key];if(allowEmpty&&!value)value="";else if("string"!=typeof value)throw Error("invalid abi - expected type 'string', received ".concat(typeof value));result.push(value)}return result},exports.isHexString=function(value,length){return"string"==typeof value&&!!value.match(/^0x[0-9A-Fa-f]*$/)&&(!length||value.length===2+2*length)}},9211:function(__unused_webpack_module,exports,__webpack_require__){"use strict";var Buffer=__webpack_require__(48764).Buffer,__importDefault=this&&this.__importDefault||function(mod){return mod&&mod.__esModule?mod:{default:mod}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.defineProperties=void 0;var assert_1=__importDefault(__webpack_require__(69282)),internal_1=__webpack_require__(60571),externals_1=__webpack_require__(50523),bytes_1=__webpack_require__(47107);exports.defineProperties=function(self1,fields,data){if(self1.raw=[],self1._fields=[],self1.toJSON=function(label){if(void 0===label&&(label=!1),label){var obj_1={};return self1._fields.forEach(function(field){obj_1[field]="0x".concat(self1[field].toString("hex"))}),obj_1}return(0,bytes_1.baToJSON)(self1.raw)},self1.serialize=function(){return externals_1.rlp.encode(self1.raw)},fields.forEach(function(field,i){function getter(){return self1.raw[i]}function setter(v){"00"!==(v=(0,bytes_1.toBuffer)(v)).toString("hex")||field.allowZero||(v=Buffer.allocUnsafe(0)),field.allowLess&&field.length?(v=(0,bytes_1.unpadBuffer)(v),(0,assert_1.default)(field.length>=v.length,"The field ".concat(field.name," must not have more ").concat(field.length," bytes"))):!(field.allowZero&&0===v.length)&&field.length&&(0,assert_1.default)(field.length===v.length,"The field ".concat(field.name," must have byte length of ").concat(field.length)),self1.raw[i]=v}self1._fields.push(field.name),Object.defineProperty(self1,field.name,{enumerable:!0,configurable:!0,get:getter,set:setter}),field.default&&(self1[field.name]=field.default),field.alias&&Object.defineProperty(self1,field.alias,{enumerable:!1,configurable:!0,set:setter,get:getter})}),data){if("string"==typeof data&&(data=Buffer.from((0,internal_1.stripHexPrefix)(data),"hex")),Buffer.isBuffer(data)&&(data=externals_1.rlp.decode(data)),Array.isArray(data)){if(data.length>self1._fields.length)throw Error("wrong number of fields in data");data.forEach(function(d,i){self1[self1._fields[i]]=(0,bytes_1.toBuffer)(d)})}else if("object"==typeof data){var keys_1=Object.keys(data);fields.forEach(function(field){-1!==keys_1.indexOf(field.name)&&(self1[field.name]=data[field.name]),-1!==keys_1.indexOf(field.alias)&&(self1[field.alias]=data[field.alias])})}else throw Error("invalid data")}}},3077:function(__unused_webpack_module,exports,__webpack_require__){"use strict";var Buffer=__webpack_require__(48764).Buffer;Object.defineProperty(exports,"__esModule",{value:!0}),exports.hashPersonalMessage=exports.isValidSignature=exports.fromRpcSig=exports.toCompactSig=exports.toRpcSig=exports.ecrecover=exports.ecsign=void 0;var secp256k1_1=__webpack_require__(95053),externals_1=__webpack_require__(50523),bytes_1=__webpack_require__(47107),hash_1=__webpack_require__(91207),helpers_1=__webpack_require__(3323),types_1=__webpack_require__(89260);function calculateSigRecovery(v,chainId){var vBN=(0,types_1.toType)(v,types_1.TypeOutput.BN);if(vBN.eqn(0)||vBN.eqn(1))return(0,types_1.toType)(v,types_1.TypeOutput.BN);if(!chainId)return vBN.subn(27);var chainIdBN=(0,types_1.toType)(chainId,types_1.TypeOutput.BN);return vBN.sub(chainIdBN.muln(2).addn(35))}function isValidSigRecovery(recovery){var rec=new externals_1.BN(recovery);return rec.eqn(0)||rec.eqn(1)}exports.ecsign=function(msgHash,privateKey,chainId){var _a=(0,secp256k1_1.ecdsaSign)(msgHash,privateKey),signature=_a.signature,recovery=_a.recid,r=Buffer.from(signature.slice(0,32)),s=Buffer.from(signature.slice(32,64));if(!chainId||"number"==typeof chainId){if(chainId&&!Number.isSafeInteger(chainId))throw Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative input type)");return{r:r,s:s,v:chainId?recovery+(2*chainId+35):recovery+27}}return{r:r,s:s,v:(0,types_1.toType)(chainId,types_1.TypeOutput.BN).muln(2).addn(35).addn(recovery).toArrayLike(Buffer)}},exports.ecrecover=function(msgHash,v,r,s,chainId){var signature=Buffer.concat([(0,bytes_1.setLengthLeft)(r,32),(0,bytes_1.setLengthLeft)(s,32)],64),recovery=calculateSigRecovery(v,chainId);if(!isValidSigRecovery(recovery))throw Error("Invalid signature v value");var senderPubKey=(0,secp256k1_1.ecdsaRecover)(signature,recovery.toNumber(),msgHash);return Buffer.from((0,secp256k1_1.publicKeyConvert)(senderPubKey,!1).slice(1))},exports.toRpcSig=function(v,r,s,chainId){if(!isValidSigRecovery(calculateSigRecovery(v,chainId)))throw Error("Invalid signature v value");return(0,bytes_1.bufferToHex)(Buffer.concat([(0,bytes_1.setLengthLeft)(r,32),(0,bytes_1.setLengthLeft)(s,32),(0,bytes_1.toBuffer)(v)]))},exports.toCompactSig=function(v,r,s,chainId){if(!isValidSigRecovery(calculateSigRecovery(v,chainId)))throw Error("Invalid signature v value");var vn=(0,types_1.toType)(v,types_1.TypeOutput.Number),ss=s;return(vn>28&&vn%2==1||1===vn||28===vn)&&(ss=Buffer.from(s),ss[0]|=128),(0,bytes_1.bufferToHex)(Buffer.concat([(0,bytes_1.setLengthLeft)(r,32),(0,bytes_1.setLengthLeft)(ss,32)]))},exports.fromRpcSig=function(sig){var r,s,v,buf=(0,bytes_1.toBuffer)(sig);if(buf.length>=65)r=buf.slice(0,32),s=buf.slice(32,64),v=(0,bytes_1.bufferToInt)(buf.slice(64));else if(64===buf.length)r=buf.slice(0,32),s=buf.slice(32,64),v=(0,bytes_1.bufferToInt)(buf.slice(32,33))>>7,s[0]&=127;else throw Error("Invalid signature length");return v<27&&(v+=27),{v:v,r:r,s:s}},exports.isValidSignature=function(v,r,s,homesteadOrLater,chainId){void 0===homesteadOrLater&&(homesteadOrLater=!0);var SECP256K1_N_DIV_2=new externals_1.BN("7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a0",16),SECP256K1_N=new externals_1.BN("fffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141",16);if(32!==r.length||32!==s.length||!isValidSigRecovery(calculateSigRecovery(v,chainId)))return!1;var rBN=new externals_1.BN(r),sBN=new externals_1.BN(s);return!(rBN.isZero()||rBN.gt(SECP256K1_N)||sBN.isZero()||sBN.gt(SECP256K1_N))&&(!homesteadOrLater||1!==sBN.cmp(SECP256K1_N_DIV_2))},exports.hashPersonalMessage=function(message){(0,helpers_1.assertIsBuffer)(message);var prefix=Buffer.from("\x19Ethereum Signed Message:\n".concat(message.length),"utf-8");return(0,hash_1.keccak)(Buffer.concat([prefix,message]))}},89260:function(__unused_webpack_module,exports,__webpack_require__){"use strict";var TypeOutput,TypeOutput1,Buffer=__webpack_require__(48764).Buffer;Object.defineProperty(exports,"__esModule",{value:!0}),exports.toType=exports.TypeOutput=exports.bnToRlp=exports.bnToUnpaddedBuffer=exports.bnToHex=void 0;var externals_1=__webpack_require__(50523),internal_1=__webpack_require__(60571),bytes_1=__webpack_require__(47107);function bnToUnpaddedBuffer(value){return(0,bytes_1.unpadBuffer)(value.toArrayLike(Buffer))}exports.bnToHex=function(value){return"0x".concat(value.toString(16))},exports.bnToUnpaddedBuffer=bnToUnpaddedBuffer,exports.bnToRlp=function(value){return bnToUnpaddedBuffer(value)},(TypeOutput=TypeOutput1=exports.TypeOutput||(exports.TypeOutput={}))[TypeOutput.Number=0]="Number",TypeOutput[TypeOutput.BN=1]="BN",TypeOutput[TypeOutput.Buffer=2]="Buffer",TypeOutput[TypeOutput.PrefixedHexString=3]="PrefixedHexString",exports.toType=function(input,outputType){if(null===input)return null;if(void 0!==input){if("string"!=typeof input||(0,internal_1.isHexString)(input)){if("number"==typeof input&&!Number.isSafeInteger(input))throw Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative input type)")}else throw Error("A string must be provided with a 0x-prefix, given: ".concat(input));var output=(0,bytes_1.toBuffer)(input);if(outputType===TypeOutput1.Buffer)return output;if(outputType===TypeOutput1.BN)return new externals_1.BN(output);if(outputType!==TypeOutput1.Number)return"0x".concat(output.toString("hex"));var bn=new externals_1.BN(output),max=new externals_1.BN(Number.MAX_SAFE_INTEGER.toString());if(bn.gt(max))throw Error("The provided number is greater than MAX_SAFE_INTEGER (please use an alternative output type)");return bn.toNumber()}}}}]);